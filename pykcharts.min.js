d3.customHive={},d3.customHive.link=function(){function n(n,u){var e,i=t(r,this,n,u),c=t(a,this,n,u);c.a<i.a&&(e=c,c=i,i=e),c.a-i.a>Math.PI&&(i.a+=2*Math.PI);i.a+(c.a-i.a)/3,c.a-(c.a-i.a)/3;return i.r0-i.r1||c.r0-c.r1?"M"+Math.cos(i.a)*i.r0+","+Math.sin(i.a)*i.r0+"L"+Math.cos(i.a)*i.r0+","+Math.sin(i.a)*i.r0:"M"+Math.cos(i.a)*i.r0+","+Math.sin(i.a)*i.r0+"L"+Math.cos(c.a)*c.r1+","+Math.sin(c.a)*c.r1}function t(n,t,r,a){var o=n.call(t,r,a),s=+("function"==typeof u?u.call(t,o,a):u)+c,f=+("function"==typeof e?e.call(t,o,a):e),h=e===i?f:+("function"==typeof i?i.call(t,o,a):i);return{r0:f,r1:h,a:s}}var r=function(n){return n.source},a=function(n){return n.target},u=function(n){return n.angle},e=function(n){return n.radius},i=e,c=-Math.PI/2;return n.source=function(t){return arguments.length?(r=t,n):r},n.target=function(t){return arguments.length?(a=t,n):a},n.angle=function(t){return arguments.length?(u=t,n):u},n.radius=function(t){return arguments.length?(e=i=t,n):e},n.startRadius=function(t){return arguments.length?(e=t,n):e},n.endRadius=function(t){return arguments.length?(i=t,n):i},n};

var PykCharts={};PykCharts.assets="../pykih-charts/assets/",PykCharts.export_menu_status=0,PykCharts["boolean"]=function(t){var e=["0","f","false","n","no","",0,"0.00","0.0",0,0],a=[void 0,null,NaN];return-1!==a.indexOf(t)?!1:(value=t.toLocaleString(),value=value.toLowerCase(),e.indexOf(value)>-1?!1:!0)},PykCharts.getEvent=function(){try{return d3.event||event}catch(t){return event}},PykCharts.Configuration=function(t){var e=this,a=(t.selector,{liveData:function(e){var a=t.real_time_charts_refresh_frequency;return PykCharts["boolean"](a)&&(clearInterval(t.interval),t.interval=setInterval(e.refresh,1e3*a)),this},emptyDiv:function(t){return d3.select(t).append("div").style("clear","both"),this},storeInitialDivHeight:function(){var e=parseFloat(d3.select(t.selector).style("height"));return e?t.original_div_height=parseFloat(d3.select(t.selector).style("height")):t.original_div_height="auto",this},appendUnits:function(e){e=PykCharts.numberFormat(e);var a,r,n;return r=t.units_prefix,n=t.units_suffix,r?(a=r+" "+e,n&&(a+=" "+n)):a=n?e+" "+n:e,a},title:function(a){if(PykCharts["boolean"](t.title_text)&&t.title_size){var r=t.chart_width;a&&(r=a);var n=PykCharts["boolean"](t.export_enable)?.9*r:r;e.titleDiv=d3.select(t.selector).append("div").attr("id","title").style({width:n+"px","text-align":"left","float":"left"}).html("<span style='pointer-events:none;font-size:"+t.title_size+"vw;color:"+t.title_color+";font-weight:"+t.title_weight+";padding-left:1px;font-family:"+t.title_family+"'>"+t.title_text+"</span>")}return this},subtitle:function(a){if(PykCharts["boolean"](t.subtitle_text)&&t.subtitle_size){var r=t.chart_width;a&&(r=a),e.subtitleDiv=d3.select(t.selector).append("div").attr("id","sub-title").style({width:r+"px","text-align":"left"}).html("<span style='pointer-events:none;font-size:"+t.subtitle_size+"vw;color:"+t.subtitle_color+";font-weight:"+t.subtitle_weight+";padding-left:1px;font-family:"+t.subtitle_family+"'>"+t.subtitle_text+"</span>")}return this},createFooter:function(e){var a=t.chart_width;return e&&(a=e),d3.select(t.selector).append("table").attr({id:"footer",width:a+"px"}).style("background",t.bg),this},lastUpdatedAt:function(e){if(PykCharts["boolean"](t.real_time_charts_refresh_frequency)&&PykCharts["boolean"](t.real_time_charts_last_updated_at_enable)){var a=new Date,r=a.getDate()+"/"+(a.getMonth()+1)+"/"+a.getFullYear()+" "+a.getHours()+":"+a.getMinutes()+":"+a.getSeconds();"liveData"===e?document.querySelectorAll(t.selector+" #lastUpdatedAt").innerHTML="<span style='pointer-events:none;'>Last Updated At: </span><span style='pointer-events:none;'>"+r+"</span>":d3.select(t.selector+" #footer").append("tr").attr("class","PykCharts-credits").html("<td colspan=2 style='text-align:right' id='lastUpdatedAt'><span style='pointer-events:none;'>Last Updated At: </span><span style='pointer-events:none;'>"+r+"</span></tr>")}return this},checkChangeInData:function(a,r){var n=Object.keys(r[0]),o=Object.keys(a[0]),i=!1,l=a.length,s=n.length;if(n.length===o.length&&r.length===a.length){for(var _=0;l>_;_++)for(var c=0;s>c;c++)if("object"!=typeof a[_][o[c]]&&"object"!=typeof r[_][n[c]]){if(a[_][o[c]]!==r[_][n[c]]||n[c]!==o[c]){i=!0;break}}else if(!t.k.__proto__._isEqual(a[_][o[c]],r[_][n[c]])||n[c]!==o[c]){i=!0;break}}else i=!0;return e.compare_data=a,[e.compare_data,i]},credits:function(){if(PykCharts["boolean"](t.credit_my_site_name)||PykCharts["boolean"](t.credit_my_site_url)){var e=!0;""===t.credit_my_site_name&&(t.credit_my_site_name=t.credit_my_site_url),""===t.credit_my_site_url&&(e=!1),d3.select(t.selector+" #footer").append("tr").attr({"class":"PykCharts-credits",id:"credit-datasource"}).append("td").style("text-align","left").html("<span style='pointer-events:none;'>Credits: </span><a href='"+t.credit_my_site_url+"' target='_blank' onclick='return "+e+"'>"+t.credit_my_site_name+"</a>")}return this},dataSource:function(){if(PykCharts["boolean"](t.data_source_name)||PykCharts["boolean"](t.data_source_url)){var e=!0;""===t.data_source_name&&(t.data_source_name=t.data_source_url),""===t.data_source_url&&(e=!1);var a="<span style='pointer-events:none;'>Source: </span><a href='"+t.data_source_url+"' target='_blank' onclick='return "+e+"'>"+t.data_source_name+"</a></tr>";d3.selectAll(t.selector+" #footer").length?d3.select(t.selector+" table #credit-datasource").style({background:t.bg,"text-align":"right"}).append("td").html(a):d3.select(t.selector).append("table").attr({id:"footer","class":"PykCharts-credits",width:t.chart_width+"px"}).style({background:t.bg,"text-align":"right"}).append("tr").append("td").html(a)}return this},makeMainDiv:function(e,a){var r=d3.select(e).append("div").attr({id:"chart-container-"+a,"class":"main-div"}).style("width",t.chart_width+"px");return PykCharts["boolean"](t.panels_enable)&&r.style({"float":"left",width:"auto"}),this},tooltip:function(e,a,r,n){if((PykCharts["boolean"](t.tooltip_enable)||"string"===t.axis_x_data_format||"string"===t.axis_y_data_format||PykCharts["boolean"](t.annotation_enable))&&"default"===t.mode){var o;if(void 0!==a){var i=t.selector.substr(1,t.selector.length);o="tooltip-svg-container-"+r+"-pyk-tooltip"+i}else o="pyk-tooltip";PykCharts.Configuration.tooltipp=d3.select("body").append("div").attr({id:o,"class":"pyk-tooltip"})}else PykCharts["boolean"](t.tooltip_enable)&&(PykCharts.Configuration.tooltipp=d3.select("body").append("div").attr({id:"pyk-tooltip","class":"pyk-tooltip"}));return this},dateConversion:function(t){t=new Date(t);var e=t.getTimezoneOffset();return t=new Date(t.getTime()+60*e*1e3)},loading:function(){d3.select(t.selector).style("height",t.chart_height);var e="image"===t.loading_type?"<img src="+t.loading_source+">":t.loading_source;d3.select(t.selector).html("<div id='chart-loader'>"+e+"</div>");var a=parseFloat(d3.select(t.selector).style("height"));return d3.select(t.selector+" #chart-loader").style({visibility:"visible","padding-left":t.chart_width/2+"px","padding-top":a/2+"px"}),this},remove_loading_bar:function(e){var a=document.querySelector(t.selector+" #chart-loader");return a&&a.parentNode.removeChild(a),document.getElementById(e).style.height=t.original_div_height,this},dataFromPykQuery:function(e){PykCharts["boolean"](t.interactive_enable)&&(t.data=e)},totalColors:function(t){var a=parseInt(t,10);return a>2&&10>a?(e.total_colors=a,this):(e.total_colors=9,this)},colorType:function(t){return"color"===t&&(e.legends="no"),this},resize:function(e,a){var r=t.chart_width;PykCharts["boolean"](t.panels_enable)&&a&&(r=a);var n,o=r/t.chart_height,i=isNaN(parseFloat(d3.select(t.selector).style("width")))?0:parseFloat(d3.select(t.selector).style("width")),l=d3.selectAll(t.selector+" #footer"),s=d3.selectAll(t.selector+" .main-div");if((i>r||0===i)&&(i=r),PykCharts["boolean"](e)&&(e.attr({width:i,height:i/o}),d3.selectAll(t.selector+" .main-div").style("width",i+"px")),PykCharts["boolean"](t.title_text)&&PykCharts["boolean"](t.export_enable)&&(n=.9*i,d3.select(t.selector+" #title").style("width",n+"px")),PykCharts["boolean"](t.subtitle_text)&&(n=.9*i,d3.select(t.selector+" #sub-title").style("width",n+"px")),PykCharts["boolean"](t.export_enable)&&(div_size=i,div_float="none",div_left=i-16,PykCharts["boolean"](t.title_text)&&t.title_size&&"default"===t.mode&&(div_size=.1*i,div_float="left",div_left=0),d3.select(t.selector+" #export").style({width:div_size+"px",left:div_left+"px","float":div_float}),d3.select(t.selector+" .dropdown-multipleConatiner-export").style("left",i-80+"px")),l&&l.attr("width",i),s&&!PykCharts["boolean"](t.panels_enable)){var _=document.querySelector(t.selector+" .main-div");_&&(_.style.width=i)}},__proto__:{_downloadDataURI:function(t){function e(t){return"object"!=typeof t||t.nodeType||null!=t&&t===t.window?!1:t.constructor&&!t.constructor.prototype.hasOwnProperty("isPrototypeOf")?!1:!0}if(t){e(t)||(t={data:t}),t.filename||(t.filename="download."+t.data.split(",")[0].split(";")[0].substring(5).split("/")[1]),t.url||(t.url="http://download-data-uri.appspot.com/");var a=(d3.select("body").append("form").attr("id","export-form").attr("method","post").attr("action",t.url).style("display","none").html("<input type='hidden' name='filename' value='"+t.filename+"'/><input type='hidden' name='data' value='"+t.data+"'/>"),document.getElementById("export-form"));a.submit(),a.parentNode.removeChild(a)}},_xmlToJson:function(t,e){var a,r,n,o,i,l,s,_,c,d=[],u=t.firstChild.childElementCount;for(0==e?(l=e,c=u,_=1):1==e&&(l=e,c=2*u+1,_=2);c>l;l+=_){for(a=t.firstChild.childNodes[l],i={},s=0,element_len=a.childElementCount;s<element_len;s++)r=a.children.item(s),n=r.nodeName,o=r.textContent,i[n]=o;d.push(i)}return d},_domainBandwidth:function(e,a,r){if(addFactor=0,"time"===r){var n=e[0],o=e[1],i=[];switch(padding=.1*(o-n),a){case 0:i[0]=n-(padding+addFactor);break;case 1:i[1]=o+(padding+addFactor);break;case 2:i[0]=n-(padding+addFactor),i[1]=o+(padding+addFactor)}return[t.k.dateConversion(i[0]),t.k.dateConversion(i[1])]}switch(padding=.1*(e[1]-e[0]),a){case 0:e[0]-=padding+addFactor;break;case 1:e[1]=parseFloat(e[1],10)+(padding+addFactor);break;case 2:e[0]-=padding+addFactor,e[1]=parseFloat(e[1],10)+(padding+addFactor)}return e},_radiusCalculation:function(e,a){var r;return r="percentageBar"===a?t.chart_height:"spiderweb"===a?d3.min([t.chart_width-t.legendsGroup_width,t.chart_height-t.legendsGroup_height-20]):void 0!==a?t.chart_width:d3.min([t.chart_width,t.chart_height]),r*e/200},_getHighestParentsAttribute:function(t,e){function a(t){return"body"===t.tagName.toLowerCase()?void(r=null):(r=t.style[e],r||(r=d3.select(t).style(e)),void(r||a(t.parentNode)))}var r,n=document.querySelector(t);return a(n),r},_groupBy:function(t,e){for(var a,r,n=[],o={oned:["name"],line:["x","name"],area:["x","name"],bar:["y","group"],column:["x","group"],scatterplot:["x","y","name","group"],pulse:["x","y","name","group"],spiderweb:["x","group"],waterfall:["x","y"],simple2x2:["group"]},i={oned:{dimension:"name",fact:"weight"},line:{dimension:"x",fact:"y",name:"name"},area:{dimension:"x",fact:"y",name:"name"},bar:{dimension:"y",fact:"x",name:"group"},column:{dimension:"x",fact:"y",name:"group"},scatterplot:{dimension:"x",fact:"y",weight:"weight",name:"name",group:"group"},pulse:{dimension:"y",fact:"x",weight:"weight",name:"name",group:"group"},spiderweb:{dimension:"x",fact:"y",name:"name",weight:"weight"},waterfall:{dimension:"y",fact:"x",name:"group"},simple2x2:{dimension:"group",fact:"weight"}},l=o[t],s=[],_=e.length,a=0;_>a;a+=1){var r=e[a];if(0==s.length)s.push([r]);else{for(var c=!1,d=s.length,u=0;d>u;u+=1){var h=s[u],p=!0,g=h[0];l.forEach(function(t){g[t]!==r[t]&&(p=!1)}),p&&(c=h)}c?c.push(r):s.push([r])}}for(a in s)if(s[a].constructor===Array){r={};var m=s[a],f=i[t],x=[],y={},v={};r[f.dimension]=m[0][f.dimension],f.name&&(r[f.name]=m[0][f.name]),f.weight?(r[f.weight]=d3.sum(m,function(e){return e[i[t].weight]}),"spiderweb"===t?r[f.fact]=d3.sum(m,function(e){return e[i[t].fact]}):r[f.fact]=m[0][f.fact]):r[f.fact]=d3.sum(m,function(e){return e[i[t].fact]}),f.group&&(r[f.group]=m[0][f.group]);for(var k in i[t])x.push(i[t][k]);for(var k in m[0]){for(var w=0,a=0;a<x.length;a++)if(k===x[a]){w=1;break}0===w&&(y[k]=m[0][k])}for(var k in r)v[k]=r[k];for(var k in y)v[k]=y[k];n.push(v)}return n},_sortData:function(t,e,a,r,n){if(PykCharts["boolean"](r.data_sort_enable)||n){if(PykCharts["boolean"](r.data_sort_enable))switch(r.data_sort_type){case"numerically":t.sort(function(t,a){return"descending"===r.data_sort_order?a[e]-t[e]:t[e]-a[e]});break;case"alphabetically":t.sort(function(t,n){return t[e]<n[e]?"descending"===r.data_sort_order?1:-1:t[e]>n[e]?"descending"===r.data_sort_order?-1:1:t[a]<n[a]?"descending"===r.data_sort_order?1:-1:t[a]>n[a]?"descending"===r.data_sort_order?-1:1:0});break;case"date":t.sort(function(t,n){return new Date(t[e])<new Date(n[e])?"descending"===r.data_sort_order?1:-1:new Date(t[e])>new Date(n[e])?"descending"===r.data_sort_order?-1:1:t[a]<n[a]?"descending"===r.data_sort_order?1:-1:t[a]>n[a]?"descending"===r.data_sort_order?-1:1:0})}}else t.sort(function(t,e){return t[a]>e[a]?1:t[a]<e[a]?-1:void 0});return t},_unique:function(t,e){for(var a={},r=[],n=0,o=t.length;o>n;n++)e&&(t[n]=t[n][e]),a[t[n]]||(a[t[n]]=!0,r.push(t[n]));return r},_ready:function(t){function e(){document.removeEventListener("DOMContentLoaded",e,!1),window.removeEventListener("load",e,!1)}return document.addEventListener?(document.addEventListener("DOMContentLoaded",e,!1),window.addEventListener("load",e,!1)):document.attachEvent&&document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&document.detachEvent("onreadystatechange",arguments.callee)}),this},_colourBrightness:function(t,e){var a,r,n,o,i=1,l=t;if(l.match(/^rgba/)?(l=l.match(/rgba\(([^)]+)\)/)[1],l=l.split(/ *, */).map(Number),a=l[0],r=l[1],n=l[2],i=l[3]):l.match(/^rgb/)?(l=l.match(/rgb\(([^)]+)\)/)[1],l=l.split(/ *, */).map(Number),a=l[0],r=l[1],n=l[2]):"#"==l[0]&&7==l.length?(a=parseInt(l.slice(1,3),16),r=parseInt(l.slice(3,5),16),n=parseInt(l.slice(5,7),16)):"#"==l[0]&&4==l.length&&(a=parseInt(l[1]+l[1],16),r=parseInt(l[2]+l[2],16),n=parseInt(l[3]+l[3],16)),o=(299*a+587*r+114*n)/1e3,125>o&&i>.5){if(!e)return"dark";d3.selectAll(e).classed({light:!1,dark:!0})}else if(125>o&&.5>=i){if(!e)return"light";d3.selectAll(e).classed({light:!0,dark:!1})}else{if(!e)return"light";d3.selectAll(e).classed({light:!0,dark:!1})}},_isNumber:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},_where:function(t,e){var a=t.length,r=[];if("object"==typeof t)for(var n in t){var o=0,i=0;for(var l in e)t[n].hasOwnProperty(l)&&t[n][l]===e[l]?o+=1:o=0,i+=1;o===i&&r.push(t[n])}else for(var n=0;a>n;n++){var o=0,i=0;for(var l in e)t[n].hasOwnProperty(l)&&t[n][l]===e[l]?o+=1:o=0,i+=1;o===i&&r.push(t[n])}return r},_isEqual:function(t,e){var a=function(t,e,n,o){if(t===e)return 0!==t||1/t===1/e;if(null==t||null==e)return t===e;var i=toString.call(t);if(i!==toString.call(e))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e}if("object"!=typeof t||"object"!=typeof e)return!1;for(var l=n.length;l--;)if(n[l]===t)return o[l]===e;var s=t.constructor,_=e.constructor;if(s!==_&&"constructor"in t&&"constructor"in e&&!(r(s)&&s instanceof s&&r(_)&&_ instanceof _))return!1;n.push(t),o.push(e);var c,d;if("[object Array]"===i){if(c=t.length,d=c===e.length)for(;c--&&(d=a(t[c],e[c],n,o)););}else{var u,h=Object.getOwnPropertyNames(t);if(c=h.length,d=Object.getOwnPropertyNames(e).length===c)for(;c--&&(u=h[c],d=hasOwnProperty.call(e,u)&&a(t[u],e[u],n,o)););}return n.pop(),o.pop(),d},r=function(t){return"function"==typeof t||!1};return a(t,e,[],[])},_offset:function(t){var e,a,r="undefined",n={top:0,left:0},o=t&&t.ownerDocument;return o?(e=o.documentElement,typeof t.getBoundingClientRect!==r&&(n=t.getBoundingClientRect()),a=null!=o&&o===o.window?o:9===o.nodeType&&o.defaultView,{top:n.top+a.pageYOffset-e.clientTop,left:n.left+a.pageXOffset-e.clientLeft}):void 0}},backgroundColor:function(t){function e(n){return r=n,a=d3.select(n).style("background-color"),"transparent"!==a&&"rgba(0, 0, 0, 0)"!==a?t.k.__proto__._colourBrightness(a,d3.selectAll(n)[0]):void 0!==d3.select(n)[0][0].parentNode.tagName&&"body"!==d3.select(n)[0][0].parentNode.tagName.toLowerCase()?e(d3.select(n)[0][0].parentNode):void t.k.__proto__._colourBrightness("rgb(255,255,255)",d3.select(n)[0])}d3.select(t.selector).style({"background-color":t.background_color,position:"relative"});var a,r;return e(t.selector),d3.select(r)[0][0].classList.contains("light")?t.img=PykCharts.assets+"img/download.png":t.img=PykCharts.assets+"img/download-light.png",this},dataSourceFormatIdentification:function(e,a,r){if("object"==typeof e)a.data=e,a[r](a.data);else{var n=e.lastIndexOf("."),o=e.length-n,i=Math.floor(100*Math.random()+1);if(e.constructor==Array)a.data=e,a[r](a.data);else{var l=e.substr(n+1,o);if(-1!=e.indexOf("<root>")){var s,_;window.DOMParser?(parser=new DOMParser,s=parser.parseFromString(e,"text/xml")):(s=new ActiveXObject("Microsoft.XMLDOM"),s.async=!1,s.loadXML(e)),_=t.k.__proto__._xmlToJson(s,0),a[r](_)}else-1!=e.indexOf("{")?(a.data=JSON.parse(e),a[r](a.data)):-1!=e.indexOf(",")?(a.data=d3.csv.parse(e),a[r](a.data)):"json"===l?d3.json(e+"?"+i,a[r]):"csv"===l?d3.csv(e+"?"+i,a[r]):"xml"===l&&d3.xml(e+"?"+i,function(e){var n;n=t.k.__proto__._xmlToJson(e,1),a[r](n)})}}},"export":function(e,a,r,n,o,i){if(PykCharts["boolean"](t.export_enable)){var i=t.chart_width;PykCharts["boolean"](n)&&i&&(i=i);var l="export",s=i,_="none",c=i-16;if(d3.select(t.selector).append("div").style("left",i-80+"px").attr("class","dropdown-multipleConatiner-export"),PykCharts["boolean"](n))for(var d=o.length,u=0;d>u;u++)d3.select(t.selector+" .dropdown-multipleConatiner-export").append("span").attr("id",r+u).on("mouseover",function(){d3.select(this).style("background-color","#E0E0E1")}).on("mouseout",function(){d3.select(this).style("background-color","#fff")}).style({"margin-bottom":"3px",cursor:"pointer"}).html("Panel "+(u+1)+"<br>");else d3.select(t.selector+" .dropdown-multipleConatiner-export").append("span").attr("id","span").on("mouseover",function(){d3.select(this).style("background-color","#E0E0E1")}).on("mouseout",function(){d3.select(this).style("background-color","#fff")}).style({"margin-bottom":"3px",cursor:"pointer"}).html("Export as SVG<br>");PykCharts["boolean"](t.title_text)&&t.title_size&&"default"===t.mode&&(s=.1*i,_="left",c=0);var h=d3.select(e.selector).append("div").attr("id",l).style({width:s+"px",left:c+"px","float":_,"text-align":"right"});setTimeout(function(){h.html("<img title='Export to SVG' src='"+t.img+"' style='left:"+c+"px;margin-bottom:3px;cursor:pointer;'/>")},1e3*t.transition_duration)}return this},exportSVG:function(e,a,r,n,o,i,l){if(PykCharts["boolean"](t.export_enable)){i||(i=0),l||(l=0);var s="export",_=r+"canvas",c=document.createElement("canvas");c.setAttribute("id",_);var d=document.getElementById(_);paper.setup(d);var u=new paper.Project;u._view._viewSize.width=e.chart_width+i,u._view._viewSize.height=e.chart_height+l;var h=r+".svg";if(d3.select(e.selector+" #"+s).on("click",function(){PykCharts.export_menu_status=1,d3.select(t.selector+" .dropdown-multipleConatiner-export").style("visibility","visible")}),PykCharts["boolean"](n))for(var p=o.length,g=0;p>g;g++)d3.selectAll(e.selector+" #"+r+g).on("click",function(){d3.select(t.selector+" .dropdown-multipleConatiner-export").style("visibility","hidden");var n=this.id.substring(this.id.length-1,this.id.length);e.k.processSVG(document.querySelector(t.selector+" #"+a+n),r),u.importSVG(document.querySelector(t.selector+" #"+a+n));var o=u.exportSVG({asString:!0});t.k.__proto__._downloadDataURI({data:"data:image/svg+xml;base64,"+btoa(o),filename:h}),u.clear()});else d3.selectAll(e.selector+" #span").on("click",function(){d3.select(t.selector+" .dropdown-multipleConatiner-export").style("visibility","hidden"),e.k.processSVG(document.querySelector(t.selector+" "+a),r),u.importSVG(document.querySelector(t.selector+" "+a));var n=u.exportSVG({asString:!0});t.k.__proto__._downloadDataURI({data:"data:image/svg+xml;base64,"+btoa(n),filename:h}),u.clear()})}return this},shadeColorConversion:function(e,a){var r,n,o=[],l=150/a;e=d3.rgb(e),n="rgb("+e.r+","+e.g+","+e.b+")",r=t.k.__proto__._colourBrightness(n),"light"===r?inc=-1:inc=1;Math.sqrt(e.r*e.r+e.g*e.g)+Math.sqrt(e.r*e.r+e.b*e.b)+Math.sqrt(e.g*e.g+e.b*e.b);for(i=0;Math.abs(i)<a;i+=inc){var s={r:parseInt(e.r+i*l,10),g:parseInt(e.g+i*l,10),b:parseInt(e.b+i*l,10)},_="rgb("+s.r+","+s.g+","+s.b+")";o.push(_)}return-1===inc&&o.reverse(),o},processSVG:function(t,e){for(var a=t.querySelectorAll("text"),r=a.length,n=0;r>n;n++)if(a[n].hasAttribute("dy")){var o=a[n].getAttribute("dy"),i=o.length;if("em"==o.substring(i-2,i)){var l,s;a[n].hasAttribute("font-size")?(l=a[n].getAttribute("font-size"),s=parseFloat(l)*parseFloat(o)):s=12*parseFloat(o),a[n].setAttribute("dy",s)}}return this},errorHandling:function(e,a,r){console.error("%c[Error - Pykih Charts] ","color: red;font-weight:bold;font-size:14px"," at "+t.selector+'.(Invalid value for attribute "'+e+'")  Visit https://github.com/pykih/PykCharts.js/wiki/Errors#error_'+a)},warningHandling:function(e,a,r){console.warn("%c[Warning - Pykih Charts] ","color: #F8C325;font-weight:bold;font-size:14px"," at "+t.selector+'.(Invalid value for attribute "'+e+'")  Visit https://github.com/pykih/PykCharts.js/wiki/Warnings#warning_'+a)},validator:function(){var e={validatingSelector:function(e){"#"===e.charAt(0)&&(e=e.substring(1,e.length));try{if(!document.getElementById(e))throw t.stop=!0,"selector"}catch(a){t.k.errorHandling(a,"1")}return this},validatingDataType:function(e,a,r,n){try{if(!t.k.__proto__._isNumber(e))throw n?t[n]=r:t[a]=r,a;t[a]=parseFloat(e)}catch(o){t.k.warningHandling(o,"1")}return this},validatingChartMode:function(e,a,r){try{if("default"!==e&&"infographics"!==e)throw t[a]=r,"mode"}catch(n){t.k.warningHandling(n,"2")}return this},validatingAxisDataFormat:function(e,a){if(e)try{if("number"!==e&&"string"!==e&&"time"!==e)throw t.stop=!0,a}catch(r){t.k.errorHandling(r,"9")}return this},validatingColorMode:function(e,a,r,n){if(e)try{if("oneDimensionalCharts"===n){if("color"!==e&&"shade"!==e)throw t[a]=r,"color_mode"}else if("color"!==e&&"saturation"!==e)throw t[a]=r,"color_mode"}catch(o){t.k.warningHandling(o,"3")}return this},validatingYAxisPointerPosition:function(e,a,r){try{if("left"!==e&&"right"!==e)throw t[a]=r,a}catch(n){t.k.warningHandling(n,"7")}return this},validatingXAxisPointerPosition:function(e,a,r){try{if("top"!==e&&"bottom"!==e)throw t[a]=r,a}catch(n){t.k.warningHandling(n,"7")}return this},validatingBorderBetweenChartElementsStyle:function(e,a){try{if("1,3"!==e&&"5,5"!==e&&"0"!==e)throw a}catch(r){t.k.errorHandling(r,"#7")}return this},validatingLegendsPosition:function(e,a,r){try{if("horizontal"!==e&&"vertical"!==e)throw t[a]=r,a}catch(n){t.k.warningHandling(n,"13")}return this},isArray:function(e,a){try{if(e.constructor!==Array)throw a}catch(r){t.stop=!0,t.k.errorHandling(r,"4")}return this},validatingTimeScaleDataType:function(e,a){if(e)try{if("date"!==e&&"year"!==e&&"month"!==e&&"hours"!==e&&"minutes"!==e)throw t.stop=!0,a}catch(r){t.k.errorHandling(r,"5")}return this},validatingTooltipMode:function(e,a,r){if(e)try{if("fixed"!==e&&"moving"!==e)throw t[a]=r,a}catch(n){t.k.warningHandling(n,"14")}return this},validatingFontWeight:function(e,a,r,n){try{if("bold"!==e&&"normal"!==e)throw n?t[n]=r:t[a]=r,a}catch(o){t.k.warningHandling(o,"5")}return this},validatingColor:function(e,a,r,n){if(e)try{var o;if("string"!=typeof e)throw a;if("#"!=e.charAt(0)&&"rgb"!=e.substring(0,3).toLowerCase()&&"transparent"!=e.toLowerCase()){if(o=$c.name2hex(e),"Invalid Color Name"===o)throw a}else if("#"===e.charAt(0)&&(o=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e),!o))throw a}catch(i){n?t[n]=r:t[a]=r,t.k.warningHandling(i,"4")}return this},validatingDataMode:function(e,a,r,n){try{if("absolute"!==e&&"percentage"!==e)throw t[a]=r,a}catch(o){t.k.warningHandling(o,"16")}return this},validatingLegendsMode:function(e,a,r,n){try{if("default"!==e&&"interactive"!==e)throw t[a]=r,a}catch(o){t.k.warningHandling(o,"17")}return this},validatingJSON:function(e){if(!e)try{throw t.stop=!0,"Data is not in the valid JSON format"}catch(a){console.error("%c[Error - Pykih Charts] ","color: red;font-weight:bold;font-size:14px"," at "+t.selector+'.("'+a+'")  Visit www.pykcharts.com/errors#error_2')}return t.stop?!1:!0}};return e}});return a};var configuration=PykCharts.Configuration;configuration.mouseEvent=function(t){var e=this;e.tooltip=configuration.tooltipp;var a={tooltipPosition:function(a){return PykCharts["boolean"](t.tooltip_enable)||PykCharts["boolean"](t.annotation_enable)||"string"===t.axis_x_data_format||"string"===t.axis_y_data_format?(e.tooltip.style({display:"block",top:PykCharts.getEvent().pageY-20+"px",left:PykCharts.getEvent().pageX+30+"px"}),e.tooltip):void 0},tooltipTextShow:function(a,r,n,o,i){var l=t.selector.substr(1,t.selector.length);return PykCharts["boolean"](t.tooltip_enable)||PykCharts["boolean"](t.annotation_enable)||"string"===t.axis_x_data_format||"string"===t.axis_y_data_format?("yes"===r&&"multilineChart"===n?d3.selectAll("#tooltip-svg-container-"+o+"-pyk-tooltip"+l).html(a):e.tooltip.html(a),this):void 0},tooltipHide:function(a,r,n,o){return PykCharts["boolean"](t.tooltip_enable)||PykCharts["boolean"](t.annotation_enable)||"string"===t.axis_x_data_format||"string"===t.axis_y_data_format?"yes"===r&&"multilineChart"===n?d3.selectAll(".pyk-tooltip").style("display","none"):e.tooltip.style("display","none"):void 0},axisHighlightShow:function(e,a,r,n){var o,i,l,s,_,c;if(PykCharts["boolean"](t.axis_onhover_highlight_enable))if(a===t.selector+" .y.axis"&&void 0==n){s=a+" .tick text",l=t.axis_y_pointer_color,_=d3.selectAll(s)[0].length,c=e.length,d3.selectAll(s).style("fill","#bbb").style("font-weight","normal");for(var d=0;_>d;d++)for(var u=0;c>u;u++)d3.selectAll(s)[0][d].__data__===e[u]&&d3.select(d3.selectAll(s)[0][d]).style("fill",l).style("font-weight","bold")}else{a===t.selector+" .x.axis"?(s=a+" .tick text",l=t.axis_x_pointer_color):a===t.selector+" .axis-text"&&"column"===n?(s=a,l=t.axis_x_pointer_color):a===t.selector+" .axis-text"&&"bar"===n?(s=a,l=t.axis_y_pointer_color):a===t.selector+" .y.axis"&&"waterfall"==n?(s=a+" .tick text",l=t.axis_y_pointer_color):a===t.selector+" .y.axis"&&"bar"===n&&(s=a+" .tick text",l=t.axis_x_pointer_color),void 0!==i&&d3.select(d3.selectAll(s)[0][i]).style({fill:l,"font-weight":"normal"}),_=d3.selectAll(s)[0].length;var h=r.length;if("number"===t.axis_x_data_format)for(var o=0;_>o&&d3.selectAll(s)[0][o].__data__!=e;o++);else for(o=0;h>o&&r[o]!==e;o++);i=o,d3.selectAll(s).style("fill","#bbb"),d3.select(d3.selectAll(s)[0][o]).style({fill:l,"font-weight":"bold"})}return this},axisHighlightHide:function(e,a){var r,n,o;return PykCharts["boolean"](t.axis_onhover_highlight_enable)&&(e===t.selector+" .y.axis"?(n=e+" .tick text",r=t.axis_y_pointer_color,o=t.axis_y_pointer_weight):e===t.selector+" .x.axis"?(n=e+" .tick text",r=t.axis_x_pointer_color,o=t.axis_x_pointer_weight):e===t.selector+" .axis-text"&&"column"===a?(n=e,r=t.axis_x_pointer_color,o=t.axis_x_pointer_weight):e===t.selector+" .axis-text"&&"bar"===a&&(n=e,r=t.axis_y_pointer_color,o=t.axis_y_pointer_weight),d3.selectAll(n).style({fill:r,"font-weight":o})),this},highlight:function(t,e,a){var r=d3.select(e);return d3.selectAll(t).attr("fill-opacity",function(t,e){return t.children&&a?0:.5}),r.attr("fill-opacity",1),this},highlightHide:function(t){return d3.selectAll(t).attr("fill-opacity",function(t,e){return d3.select(this).attr("data-fill-opacity")}),this},highlightGroup:function(t,e,a){var r=d3.select(e),n=d3.selectAll(t);return n.selectAll(a).attr("fill-opacity",.5),r.selectAll(a).attr("fill-opacity",1),this},highlightGroupHide:function(t,e){return d3.selectAll(t+" "+e).attr("fill-opacity",function(t,e){return d3.select(this).attr("data-fill-opacity")}),this}};return a},configuration.fillChart=function(t,e,a){var r={selectColor:function(a){return e=new PykCharts.Configuration.Theme({}),"color"===t.color_mode?a.name.toLowerCase()===t.highlight.toLowerCase()?t.highlight_color:t.chart_color.length&&t.chart_color[0]?t.chart_color[0]:e.stylesheet.chart_color:a.color},colorChart:function(a){return a.name===t.highlight?e.stylesheet.highlight_color:e.stylesheet.chart_color},colorPieW:function(e){return e.color?e.color:t.chart_color.length?t.color:t.chart_color[0]},colorPieMS:function(e,a){return"lineChart"!==a&&"areaChart"!==a&&e.name.toLowerCase()===t.highlight.toLowerCase()?t.highlight_color:"saturation"===t.color_mode?t.saturation_color:"color"===t.color_mode?e.color:void 0},colorGroup:function(e){return"saturation"===t.color_mode?t.saturation_color:"color"===t.color_mode?e.color:void 0},colorLegends:function(e){return"saturation"===t.color_mode?t.saturation_color:"color"===t.color_mode&&e?e:"color"===t.color_mode?t.chart_color:t.chart_color[0]}};return r},configuration.border=function(t){var e={width:function(){return t.border_between_chart_elements_thickness+"px"},color:function(){return t.border_between_chart_elements_color},style:function(){return t.border_between_chart_elements_style}};return e},configuration.transition=function(t){var e={duration:function(){return"default"===t.mode&&PykCharts["boolean"](t.transition_duration)?1e3*t.transition_duration:0}};return e},configuration.renderBrush=function(t,e,a,r){function n(t){var e=+("e"==t),a=e?1:-1,n=r/3;return"M"+.5*a+","+n+"A6,6 0 0 "+e+" "+6.5*a+","+(n+6)+"V"+(2*n-6)+"A6,6 0 0 "+e+" "+.5*a+","+2*n+"ZM"+2.5*a+","+(n+8)+"V"+(2*n-8)+"M"+4.5*a+","+(n+8)+"V"+(2*n-8)}function o(){return t.brush_extent=d3.event.target.extent(),min=t.brush_extent[0],max=t.brush_extent[1],t.onBrush(e(min),e(max)),console.log(e(min),e(max)),t.brush_extent}t.make_brush=d3.svg.brush().x(e).on("brushend",o);var i=a.append("g").attr("class","brush").call(t.make_brush);i.selectAll("rect").attr("height",r).attr("fill","blue").attr("fill-opacity",.3),i.selectAll(".resize").append("path").attr("d",n).attr("fill","#4C7190").attr("stroke","#4C7190").attr("stroke-width","1.5px")},configuration.Theme=function(){var t=this;return t.stylesheet={mode:"default",selector:"",interactive_enable:"no",click_enable:"no",chart_height:430,chart_width:600,chart_margin_top:35,chart_margin_right:50,chart_margin_bottom:35,chart_margin_left:50,title_text:"",title_size:2,title_color:"#1D1D1D",title_weight:"bold",title_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",subtitle_size:1,subtitle_color:"black",subtitle_weight:"normal",subtitle_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",highlight:"",highlight_color:"#08306b",background_color:"transparent",chart_color:["#255AEE"],saturation_color:"#255AEE",border_between_chart_elements_thickness:1,border_between_chart_elements_color:"white",border_between_chart_elements_style:"solid",legends_enable:"yes",legends_display:"horizontal",legends_text_size:11,legends_text_color:"#1D1D1D",legends_text_weight:"normal",legends_text_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",label_size:11,label_color:"white",label_weight:"normal",label_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",pointer_overflow_enable:"yes",pointer_thickness:1,pointer_weight:"normal",pointer_size:11,pointer_color:"#1D1D1D",pointer_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",export_enable:"no",color_mode:"color",axis_x_pointer_size:11,axis_x_pointer_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",axis_x_pointer_weight:"normal",axis_x_pointer_color:"#1D1D1D",axis_x_enable:"yes",axis_x_title:"",axis_x_title_size:14,axis_x_title_color:"#1D1D1D",axis_x_title_weight:"bold",axis_x_title_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",axis_x_position:"bottom",axis_x_pointer_position:"bottom",axis_x_line_color:"#1D1D1D",axis_x_no_of_axis_value:5,axis_x_pointer_length:5,axis_x_pointer_padding:6,axis_x_pointer_values:[],axis_x_outer_pointer_length:0,axis_x_time_value_datatype:"",axis_x_time_value_interval:0,axisHighlight_x_data_format:"string",loading_source:"<div class='PykCharts-loading'>loading...</div>",loading_type:"css",tooltip_enable:"yes",tooltip_mode:"moving",credit_my_site_name:"PykCharts",credit_my_site_url:"http://www.pykcharts.com/",chart_onhover_highlight_enable:"yes",units_prefix:!1,units_suffix:!1},t.functionality={real_time_charts_refresh_frequency:0,real_time_charts_last_updated_at_enable:"yes",transition_duration:0},t.oneDimensionalCharts={clubdata_enable:"yes",clubdata_text:"Others",clubdata_maximum_nodes:5,shade_color:"#255AEE",pie_radius_percent:70,donut_radius_percent:70,donut_inner_radius_percent:40,donut_show_total_at_center:"yes",donut_show_total_at_center_size:24,donut_show_total_at_center_color:"#1D1D1D",donut_show_total_at_center_weight:"bold",donut_show_total_at_center_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",
funnel_rect_width:100,funnel_rect_height:100,percent_column_rect_width:20,percent_row_rect_height:10},t.otherCharts={pictograph_show_all_images:"yes",pictograph_total_count_enable:"yes",pictograph_current_count_enable:"yes",pictograph_image_per_line:3,pictograph_image_width:79,pictograph_image_height:66,pictograph_current_count_size:64,pictograph_current_count_color:"#255aee",pictograph_current_count_weight:"normal",pictograph_current_count_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",pictograph_total_count_size:64,pictograph_total_count_color:"grey",pictograph_total_count_weight:"normal",pictograph_total_count_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",pictograph_units_per_image_text_size:24,pictograph_units_per_image_text_color:"grey",pictograph_units_per_image_text_weight:"normal",pictograph_units_per_image_text_family:"'Helvetica Neue',Helvetica,Arial,sans-serif"},t.multiDimensionalCharts={chart_grid_x_enable:"yes",chart_grid_y_enable:"yes",chart_grid_color:"#ddd",axis_onhover_highlight_enable:"yes",axis_y_pointer_size:11,axis_y_pointer_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",axis_y_pointer_weight:"normal",axis_y_pointer_color:"#1D1D1D",axis_y_enable:"yes",axis_y_title:"",axis_y_title_size:14,axis_y_title_color:"#1D1D1D",axis_y_title_weight:"bold",axis_y_title_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",axis_y_position:"left",axis_y_pointer_position:"left",axis_y_line_color:"#1D1D1D",axis_y_no_of_axis_value:5,axis_y_pointer_length:5,axis_y_pointer_padding:6,axis_y_pointer_values:[],axis_y_outer_pointer_length:0,axis_y_time_value_datatype:"",axis_y_time_value_interval:0,axis_y_data_format:"number",variable_circle_size_enable:"yes",crosshair_enable:"yes",zoom_enable:"no",zoom_level:3,spiderweb_outer_radius_percent:100,scatterplot_radius:20,scatterplot_pointer_enable:"no",curvy_lines_enable:"no",annotation_enable:"no",annotation_view_mode:"onload",annotation_background_color:"#C2CBCF",annotation_font_color:"black",legends_mode:"default",expand_group:"yes",data_mode_enable:"no",data_mode_legends_color:"black",data_mode_default:"percentage",connecting_lines_color:"#ddd",connecting_lines_style:"solid",text_between_steps_color:"#aaa",text_between_steps_family:"'Helvetica Neue',Helvetica,Arial,sans-serif",text_between_steps_size:10,text_between_steps_weight:"normal",data_mode_enable:"no",data_mode_legends_color:"black",data_mode_default:"percentage",connecting_lines_color:"#ddd",connecting_lines_style:"solid",data_sort_enable:"yes",data_sort_type:"alphabetically",data_sort_order:"ascending",calculate_total:"yes",axis_y_background_color:"transparent"},t.treeCharts={zoom_enable:"no",nodeRadius:4.5},t.mapsTheme={total_no_of_colors:3,palette_color:"Blue-1",tooltip_position_top:0,tooltip_position_left:0,timeline_duration:1,timeline_margin_top:5,timeline_margin_right:25,timeline_margin_bottom:25,timeline_margin_left:45,label_enable:"no",click_enable:"yes",chart_onhover_effect:"shadow"},t},PykCharts.validation={},PykCharts.oneD={},PykCharts.other={},PykCharts.validation.processInputs=function(t,e,a){function r(t){return t.toLowerCase()}function n(t){return t in e}var o=new PykCharts.Configuration.Theme({}),i=o.stylesheet,l=o.functionality,s=o.oneDimensionalCharts,_=o.multiDimensionalCharts,c=o.mapsTheme;t.title_text=e.title_text,t.subtitle_text=e.subtitle_text,e.credit_my_site_name||e.credit_my_site_url?(t.credit_my_site_name=e.credit_my_site_name?e.credit_my_site_name:"",t.credit_my_site_url=e.credit_my_site_url?e.credit_my_site_url:""):(t.credit_my_site_name=i.credit_my_site_name,t.credit_my_site_url=i.credit_my_site_url),t.data_source_name=e.data_source_name?e.data_source_name:"",t.data_source_url=e.data_source_url?e.data_source_url:"",t.default_color=i.chart_color;var d=[{config_name:"selector",default_value:i,validation_type:"validatingSelector",all_charts:!0},{config_name:"chart_color",default_value:i,validation_type:"isArray",all_charts:!0},{config_name:"axis_x_pointer_values",default_value:i,validation_type:"isArray",maps:!0,multiDimensionalCharts:!0},{config_name:"axis_y_pointer_values",default_value:_,validation_type:"isArray",multiDimensionalCharts:!0},{config_name:"mode",default_value:i,validation_type:"validatingChartMode",condition2:r,oneDimensionalCharts:!0,multiDimensionalCharts:!0,other:!0},{config_name:"chart_width",default_value:i,validation_type:"validatingDataType",all_charts:!0},{config_name:"title_size",default_value:i,validation_type:"validatingDataType",all_charts:!0},{config_name:"subtitle_size",default_value:i,validation_type:"validatingDataType",condition1:n,all_charts:!0},{config_name:"border_between_chart_elements_thickness",default_value:i,validation_type:"validatingDataType",condition1:n,all_charts:!0},{config_name:"label_size",default_value:i,validation_type:"validatingDataType",condition1:n,all_charts:!0},{config_name:"pointer_thickness",default_value:i,validation_type:"validatingDataType",condition1:n,oneDimensionalCharts:!0,multiDimensionalCharts:!0},{config_name:"pointer_size",default_value:i,validation_type:"validatingDataType",condition1:n,oneDimensionalCharts:!0,multiDimensionalCharts:!0},{config_name:"axis_x_title_size",default_value:i,validation_type:"validatingDataType",condition1:n,multiDimensionalCharts:!0},{config_name:"axis_y_title_size",default_value:_,validation_type:"validatingDataType",condition1:n,multiDimensionalCharts:!0},{config_name:"legends_text_size",default_value:i,validation_type:"validatingDataType",condition1:n,maps:!0,multiDimensionalCharts:!0},{config_name:"axis_x_pointer_size",default_value:i,validation_type:"validatingDataType",condition1:n,maps:!0,multiDimensionalCharts:!0},{config_name:"axis_y_pointer_size",default_value:_,validation_type:"validatingDataType",condition1:n,multiDimensionalCharts:!0},{config_name:"axis_x_pointer_length",default_value:i,validation_type:"validatingDataType",condition1:n,maps:!0,multiDimensionalCharts:!0},{config_name:"axis_y_pointer_length",default_value:_,validation_type:"validatingDataType",condition1:n,multiDimensionalCharts:!0},{config_name:"axis_x_outer_pointer_length",default_value:i,validation_type:"validatingDataType",condition1:n,maps:!0,multiDimensionalCharts:!0},{config_name:"axis_y_outer_pointer_length",default_value:_,validation_type:"validatingDataType",condition1:n,multiDimensionalCharts:!0},{config_name:"real_time_charts_refresh_frequency",default_value:l,validation_type:"validatingDataType",all_charts:!0},{config_name:"transition_duration",default_value:l,validation_type:"validatingDataType",oneDimensionalCharts:!0,multiDimensionalCharts:!0,other:!0},{config_name:"clubdata_maximum_nodes",default_value:s,validation_type:"validatingDataType",oneDimensionalCharts:!0},{config_name:"title_weight",default_value:i,validation_type:"validatingFontWeight",condition2:r,all_charts:!0},{config_name:"subtitle_weight",default_value:i,validation_type:"validatingFontWeight",condition2:r,all_charts:!0},{config_name:"pointer_weight",default_value:i,validation_type:"validatingFontWeight",condition2:r,oneDimensionalCharts:!0,multiDimensionalCharts:!0},{config_name:"label_weight",default_value:i,validation_type:"validatingFontWeight",condition2:r,all_charts:!0},{config_name:"background_color",default_value:i,validation_type:"validatingColor",all_charts:!0},{config_name:"shade_color",default_value:s,validation_type:"validatingColor",oneDimensionalCharts:!0},{config_name:"title_color",default_value:i,validation_type:"validatingColor",all_charts:!0},{config_name:"subtitle_color",default_value:i,validation_type:"validatingColor",all_charts:!0},{config_name:"highlight_color",default_value:i,validation_type:"validatingColor",all_charts:!0},{config_name:"label_color",default_value:i,validation_type:"validatingColor",all_charts:!0},{config_name:"pointer_color",default_value:i,validation_type:"validatingColor",oneDimensionalCharts:!0,multiDimensionalCharts:!0},{config_name:"border_between_chart_elements_color",default_value:i,validation_type:"validatingColor",all_charts:!0},{config_name:"axis_x_time_value_datatype",default_value:i,validation_type:"validatingTimeScaleDataType",multiDimensionalCharts:!0},{config_name:"axis_y_time_value_datatype",default_value:_,validation_type:"validatingTimeScaleDataType",multiDimensionalCharts:!0},{config_name:"chart_height",default_value:i,validation_type:"validatingDataType",multiDimensionalCharts:!0,maps:!0},{config_name:"chart_margin_left",default_value:i,validation_type:"validatingDataType",condition1:n,multiDimensionalCharts:!0},{config_name:"chart_margin_right",default_value:i,validation_type:"validatingDataType",condition1:n,multiDimensionalCharts:!0},{config_name:"chart_margin_top",default_value:i,validation_type:"validatingDataType",condition1:n,multiDimensionalCharts:!0},{config_name:"chart_margin_bottom",default_value:i,validation_type:"validatingDataType",condition1:n,multiDimensionalCharts:!0},{config_name:"zoom_level",default_value:_,validation_type:"validatingDataType",multiDimensionalCharts:!0},{config_name:"axis_x_pointer_padding",default_value:i,validation_type:"validatingDataType",multiDimensionalCharts:!0,maps:!0},{config_name:"axis_y_pointer_padding",default_value:_,validation_type:"validatingDataType",multiDimensionalCharts:!0},{config_name:"axis_x_no_of_axis_value",default_value:i,validation_type:"validatingDataType",multiDimensionalCharts:!0},{config_name:"axis_y_no_of_axis_value",default_value:_,validation_type:"validatingDataType",multiDimensionalCharts:!0},{config_name:"axis_x_time_value_interval",default_value:i,validation_type:"validatingDataType",multiDimensionalCharts:!0},{config_name:"axis_y_time_value_interval",default_value:_,validation_type:"validatingDataType",multiDimensionalCharts:!0},{config_name:"legends_text_color",default_value:i,validation_type:"validatingColor",multiDimensionalCharts:!0,maps:!0},{config_name:"axis_x_pointer_color",default_value:i,validation_type:"validatingColor",multiDimensionalCharts:!0,maps:!0},{config_name:"axis_y_pointer_color",default_value:_,validation_type:"validatingColor",multiDimensionalCharts:!0},{config_name:"axis_x_title_color",default_value:i,validation_type:"validatingColor",multiDimensionalCharts:!0},{config_name:"axis_y_title_color",default_value:_,validation_type:"validatingColor",multiDimensionalCharts:!0},{config_name:"axis_x_line_color",default_value:i,validation_type:"validatingColor",multiDimensionalCharts:!0,maps:!0},{config_name:"axis_y_line_color",default_value:_,validation_type:"validatingColor",multiDimensionalCharts:!0},{config_name:"annotation_font_color",default_value:_,validation_type:"validatingColor",multiDimensionalCharts:!0},{config_name:"annotation_background_color",default_value:_,validation_type:"validatingColor",multiDimensionalCharts:!0},{config_name:"chart_grid_color",default_value:_,validation_type:"validatingColor",multiDimensionalCharts:!0},{config_name:"legends_display",default_value:i,validation_type:"validatingLegendsPosition",multiDimensionalCharts:!0,maps:!0},{config_name:"tooltip_mode",default_value:i,validation_type:"validatingTooltipMode",multiDimensionalCharts:!0,maps:!0},{config_name:"legends_text_weight",default_value:i,validation_type:"validatingFontWeight",condition2:r,multiDimensionalCharts:!0,maps:!0},{config_name:"axis_y_pointer_weight",default_value:_,validation_type:"validatingFontWeight",condition2:r,multiDimensionalCharts:!0},{config_name:"axis_x_pointer_weight",default_value:i,validation_type:"validatingFontWeight",condition2:r,multiDimensionalCharts:!0,maps:!0},{config_name:"axis_y_title_weight",default_value:_,validation_type:"validatingFontWeight",condition2:r,multiDimensionalCharts:!0},{config_name:"axis_x_title_weight",default_value:i,validation_type:"validatingFontWeight",condition2:r,multiDimensionalCharts:!0},{config_name:"axis_y_position",default_value:_,validation_type:"validatingYAxisPointerPosition",multiDimensionalCharts:!0},{config_name:"axis_x_position",default_value:i,validation_type:"validatingXAxisPointerPosition",condition2:r,multiDimensionalCharts:!0},{config_name:"axis_y_pointer_position",default_value:_,validation_type:"validatingYAxisPointerPosition",condition2:r,multiDimensionalCharts:!0},{config_name:"axis_x_pointer_position",default_value:i,validation_type:"validatingXAxisPointerPosition",condition2:r,multiDimensionalCharts:!0},{config_name:"color_mode",default_value:i,validation_type:"validatingColorMode",condition2:r,multiDimensionalCharts:!0},{config_name:"border_between_chart_elements_style",default_value:i,condition2:r,all_charts:!0},{config_name:"clubdata_text",default_value:s,oneDimensionalCharts:!0},{config_name:"saturation_color",default_value:i,multiDimensionalCharts:!0,maps:!0},{config_name:"timeline_duration",default_value:c,maps:!0,condition1:n}];t.k=new PykCharts.Configuration(t);for(var u=t.k.validator(),h=0,p=d.length;p>h;h++){var g=d[h];if(g[a]||g.all_charts){var m=g.config_name,f=g.default_value[m],x=g.condition1?g.condition1(m):e[m];if(m in e)var y=g.condition2?g.condition2(e[m]):e[m];t[m]=x?y:f,g.validation_type&&u[g.validation_type](t[m],m,f)}}"maps"===a&&(t.axis_x_pointer_position=e.axis_x_pointer_position?e.axis_x_pointer_position:"top",u.validatingXAxisPointerPosition(t.axis_x_pointer_position,"axis_x_pointer_position","top")),"oneDimensionalCharts"===a?(t.color_mode=e.color_mode?e.color_mode:"shade",u.validatingColorMode(t.color_mode,"color_mode","shade",a)):"maps"===a&&(t.color_mode=e.color_mode?e.color_mode:"saturation",u.validatingColorMode(t.color_mode,"color_mode","saturation",a));for(var v=[{config_name:"interactive_enable",default_value:i,all_charts:!0},{config_name:"click_enable",default_value:i,all_charts:!0},{config_name:"tooltip_enable",default_value:i,all_charts:!0},{config_name:"export_enable",default_value:i,all_charts:!0},{config_name:"real_time_charts_last_updated_at_enable",default_value:l,all_charts:!0},{config_name:"clubdata_enable",default_value:s,oneDimensionalCharts:!0},{config_name:"pointer_overflow_enable",default_value:i,oneDimensionalCharts:!0},{config_name:"chart_onhover_highlight_enable",default_value:i,all_charts:!0},{config_name:"chart_grid_x_enable",default_value:_,multiDimensionalCharts:!0},{config_name:"chart_grid_y_enable",default_value:_,multiDimensionalCharts:!0},{config_name:"axis_x_enable",default_value:i,multiDimensionalCharts:!0,maps:!0},{config_name:"axis_y_enable",default_value:_,multiDimensionalCharts:!0},{config_name:"axis_onhover_highlight_enable",default_value:_,multiDimensionalCharts:!0},{config_name:"zoom_enable",default_value:_,multiDimensionalCharts:!0},{config_name:"annotation_enable",default_value:_,multiDimensionalCharts:!0},{config_name:"legends_enable",default_value:i,multiDimensionalCharts:!0,maps:!0},{config_name:"variable_circle_size_enable",default_value:_,multiDimensionalCharts:!0},{config_name:"title_family",default_value:i,all_charts:!0},{config_name:"subtitle_family",default_value:i,all_charts:!0},{config_name:"pointer_family",default_value:i,oneDimensionalCharts:!0,multiDimensionalCharts:!0},{config_name:"title_family",default_value:i,all_charts:!0},{config_name:"label_family",default_value:i,all_charts:!0},{config_name:"units_suffix",default_value:i,oneDimensionalCharts:!0},{config_name:"units_prefix",default_value:i,oneDimensionalCharts:!0},{config_name:"highlight",default_value:i,all_charts:!0},{config_name:"axis_x_title_family",default_value:i,multiDimensionalCharts:!0},{config_name:"axis_y_title_family",default_value:_,multiDimensionalCharts:!0},{config_name:"legends_text_family",default_value:i,multiDimensionalCharts:!0},{config_name:"axis_x_title",default_value:i,multiDimensionalCharts:!0},{config_name:"axis_y_title",default_value:i,multiDimensionalCharts:!0},{config_name:"map_code",default_value:c,maps:!0},{config_name:"click_enable",default_value:c,maps:!0},{config_name:"annotation_view_mode",default_value:_,multiDimensionalCharts:!0},{config_name:"loading_type",default_value:i,all_charts:!0},{config_name:"loading_source",default_value:i,all_charts:!0}],h=0,k=v.length;k>h;h++){var g=v[h];if(g[a]||g.all_charts){var m=g.config_name,f=g.default_value[m];t[m]=e[m]?e[m]:f}}switch(t.clubdata_always_include_data_points=PykCharts["boolean"](t.clubdata_enable)&&e.clubdata_always_include_data_points?e.clubdata_always_include_data_points:[],u.isArray(t.clubdata_always_include_data_points,"clubdata_always_include_data_points"),t.border_between_chart_elements_style){case"dotted":t.border_between_chart_elements_style="1,3";break;case"dashed":t.border_between_chart_elements_style="5,5";break;default:t.border_between_chart_elements_style="0"}if("oneDimensionalCharts"===a||"maps"===a)t.chart_color[0]&&t.k.validator().validatingColor(t.chart_color[0],"chart_color",i.chart_color);else for(var h=0;h<t.chart_color.length;h++)t.chart_color[h]&&t.k.validator().validatingColor(t.chart_color[h],"chart_color",i.chart_color);return t.k=new PykCharts.Configuration(t),t},PykCharts.oneD.bubble=function(t){var e=this;e.interval="";new PykCharts.Configuration.Theme({});this.execute=function(a){e=new PykCharts.validation.processInputs(e,t,"oneDimensionalCharts"),e.chart_height=t.chart_height?t.chart_height:e.chart_width,e.k.validator().validatingDataType(e.chart_height,"chart_height",e.chart_width),e.k.storeInitialDivHeight(),"default"===e.mode&&e.k.loading(),e.executeData=function(t){var a=e.k.validator().validatingJSON(t),r=e.selector.substring(1,e.selector.length);return e.stop||a===!1?void e.k.remove_loading_bar(r):(e.data=e.k.__proto__._groupBy("oned",t),e.compare_data=e.k.__proto__._groupBy("oned",t),e.k.remove_loading_bar(r),e.clubdata_enable=e.data.length>e.clubdata_maximum_nodes?e.clubdata_enable:"no",void e.render())},PykCharts["boolean"](e.interactive_enable)?(e.k.dataFromPykQuery(a),e.k.dataSourceFormatIdentification(e.data,e,"executeData")):e.k.dataSourceFormatIdentification(t.data,e,"executeData")},this.refresh=function(a){e.executeRefresh=function(t){e.data=e.k.__proto__._groupBy("oned",t),e.clubdata_enable=e.data.length>e.clubdata_maximum_nodes?e.clubdata_enable:"no",e.refresh_data=e.k.__proto__._groupBy("oned",t);var a=e.k.checkChangeInData(e.refresh_data,e.compare_data),r=[];e.compare_data=a[0];var n=a[1];n&&e.k.lastUpdatedAt("liveData"),e.new_data=e.optionalFeatures().clubData(),"shade"===e.color_mode&&(r=e.k.shadeColorConversion(e.shade_color,e.new_data.children.length),r.reverse(),e.new_data.children.forEach(function(t,e){t.color=r[e]})),e.optionalFeatures().createChart().label()},PykCharts["boolean"](e.interactive_enable)?(e.k.dataFromPykQuery(a),e.k.dataSourceFormatIdentification(e.data,e,"executeRefresh")):e.k.dataSourceFormatIdentification(t.data,e,"executeRefresh")},this.render=function(){var t=e.selector.substring(1,e.selector.length),a=t+"_svg",r=[];e.fillChart=new PykCharts.Configuration.fillChart(e),e.transitions=new PykCharts.Configuration.transition(e),"default"===e.mode?(e.k.title().backgroundColor(e)["export"](e,"#"+a,"bubble").emptyDiv(e.selector).subtitle(),e.new_data=e.optionalFeatures().clubData(),"shade"===e.color_mode&&(r=e.k.shadeColorConversion(e.shade_color,e.new_data.children.length),r.reverse(),e.new_data.children.forEach(function(t,e){t.color=r[e]})),e.optionalFeatures().svgContainer(a).createChart().label(),e.k.createFooter().lastUpdatedAt().credits().dataSource().liveData(e).tooltip()):"infographics"===e.mode&&(e.k.backgroundColor(e)["export"](e,"#"+a,"bubble").emptyDiv(e.selector),e.new_data={children:e.data},"shade"===e.color_mode&&(r=e.k.shadeColorConversion(e.shade_color,e.new_data.children.length),r.reverse(),e.new_data.children.forEach(function(t,e){t.color=r[e]})),e.optionalFeatures().svgContainer(a).createChart().label(),e.k.tooltip()),e.k.exportSVG(e,"#"+a,"bubble"),e.mouseEvent=new PykCharts.Configuration.mouseEvent(e);var n=e.k.resize(e.svgContainer);e.k.__proto__._ready(n),window.addEventListener("resize",function(t){return e.k.resize(e.svgContainer)})},this.optionalFeatures=function(){var a={svgContainer:function(t){return e.svgContainer=d3.select(e.selector).append("svg").attr({"class":"svgcontainer PykCharts-oneD",id:t,preserveAspectRatio:"xMinYMin",viewBox:"0 0 "+e.chart_width+" "+e.chart_height,width:e.chart_width,height:e.chart_height}),e.group=e.svgContainer.append("g").attr("id","bubgrp"),this},createChart:function(){var t=d3.layout.pack().sort(function(t,e){return e.weight-t.weight}).size([e.chart_width,e.chart_height]).value(function(t){return t.weight}).padding(20);e.sum=d3.sum(e.new_data.children,function(t){return t.weight});e.new_data.children.length;e.node=t.nodes(e.new_data);var a=e.group.selectAll(".bubble-node").data(e.node);return a.enter().append("g").attr("class","bubble-node").append("circle"),a.attr("class","bubble-node").select("circle").attr({"class":"bubble",id:function(t,e){return"bubble"+e},x:function(t){return t.x},y:function(t){return t.y},r:0,transform:function(t){return"translate("+t.x+","+t.y+")"},fill:function(t){return t.children?e.background_color:e.fillChart.selectColor(t)},"fill-opacity":function(t){return t.children?0:1},"data-fill-opacity":function(){return d3.select(this).attr("fill-opacity")},"data-id":function(t,e){return t.name}}).on({mouseover:function(t){t.children||"default"!==e.mode||(PykCharts["boolean"](e.chart_onhover_highlight_enable)&&e.mouseEvent.highlight(e.selector+" .bubble",this,!0),t.tooltip=t.tooltip||"<table><thead><th colspan='2' class='tooltip-heading'>"+t.name+"</th></thead><tr><td class='tooltip-left-content'>"+e.k.appendUnits(t.weight)+"  <td class='tooltip-right-content'>("+(100*t.weight/e.sum).toFixed(1)+"%)</tr></table>",e.mouseEvent.tooltipPosition(t),e.mouseEvent.tooltipTextShow(t.tooltip))},mouseout:function(t){"default"===e.mode&&(e.mouseEvent.tooltipHide(t),PykCharts["boolean"](e.chart_onhover_highlight_enable)&&e.mouseEvent.highlightHide(e.selector+" .bubble"))},mousemove:function(t){t.children||"default"!==e.mode||e.mouseEvent.tooltipPosition(t)},click:function(t,a){PykCharts["boolean"](e.click_enable)&&e.addEvents(t.name,d3.select(this).attr("data-id"))}}).transition().duration(e.transitions.duration()).attr("r",function(t){return t.r}),a.exit().remove(),this},label:function(){function a(){n.text(function(t){return t.children?" ":t.name}).attr("pointer-events","none").text(function(t){return this.getBBox().width<.85*(2*t.r)&&this.getBBox().height<2*t.r?t.children?" ":t.name:""})}function r(){o.text(function(t){return t.children?" ":e.k.appendUnits(t.weight)}).text(function(t){return this.getBBox().width<2*t.r*.55&&this.getBBox().height<2*t.r*.55?t.children?" ":(100*t.weight/e.sum).toFixed(1)+"%":""})}var n=e.group.selectAll(".name").data(e.node),o=e.group.selectAll(".weight").data(e.node);return n.enter().append("svg:text").attr("class","name"),o.enter().append("svg:text").attr("class","weight"),n.attr("class","name").attr({x:function(t){return t.x},y:function(t){return t.y-5}}),o.attr("class","weight").attr({x:function(t){return t.x},y:function(t){return+t.y+e.label_size}}),n.attr("text-anchor","middle").attr("fill",function(a){if("shade"===e.color_mode&&!a.children&&!t.label_color){var r=e.k.__proto__._colourBrightness(a.color);return"light"===r?"black":"white"}return e.label_color}).style({"font-weight":e.label_weight,"font-size":e.label_size+"px","font-family":e.label_family}).text(""),setTimeout(a,e.transitions.duration()),o.attr({"text-anchor":"middle",fill:function(a){if("shade"===e.color_mode&&!a.children&&!t.label_color){var r=e.k.__proto__._colourBrightness(a.color);return"light"===r?"black":"white"}return e.label_color},"pointer-events":"none"}).style({"font-family":e.label_family,"font-weight":e.label_weight,"font-size":e.label_size+"px"}).text(""),setTimeout(r,e.transitions.duration()),n.exit().remove(),o.exit().remove(),this},clubData:function(){var t,a=e.data.length;if(PykCharts["boolean"](e.clubdata_enable)){var r,n,o=[],i=0,l=[];if(a<=e.clubdata_maximum_nodes)return t={children:e.data};if(0!==e.clubdata_always_include_data_points.length){var s=e.clubdata_always_include_data_points.length;for(n=0;s>n;n++)o[n]=e.clubdata_always_include_data_points[n]}for(n=0;n<o.length;n++)for(r=0;a>r;r++)o[n].toUpperCase()===e.data[r].name.toUpperCase()&&l.push(e.data[r]);for(e.data.sort(function(t,e){return e.weight-t.weight});l.length<e.clubdata_maximum_nodes-1;){for(n=0;n<o.length;n++)e.data[i].name.toUpperCase()===o[n].toUpperCase()&&i++;l.push(e.data[i]),i++}var _=0;for(r=i;a>r;r++){for(n=0;n<l.length&&r<e.data.length;n++)e.data[r].name.toUpperCase()===l[n].name.toUpperCase()&&(_+=0,r++,n=-1);r<e.data.length&&(_+=e.data[r].weight)}for(var c=function(t,e){return e.weight-t.weight};l.length>e.clubdata_maximum_nodes;){l.sort(c);l.pop()}var d={name:e.clubdata_text,weight:_,color:e.clubData_color,tooltip:e.clubData_tooltipText,highlight:!1};l.length<e.clubdata_maximum_nodes&&l.push(d),l.sort(function(t,e){return t.weight-e.weight}),t={children:l},e.map1=t.children.map(function(t){return t.weight})}else e.data.sort(function(t,e){return t.weight-e.weight}),t={children:e.data};return t}};return a}},PykCharts.oneD.funnel=function(t){var e=this;e.interval="";var a=new PykCharts.Configuration.Theme({});this.execute=function(r){e=new PykCharts.validation.processInputs(e,t,"oneDimensionalCharts"),e.chart_height=t.chart_height?t.chart_height:e.chart_width;var n=(t.optional,a.oneDimensionalCharts);e.funnel_rect_width=t.funnel_rect_width?t.funnel_rect_width:n.funnel_rect_width,e.funnel_rect_height=t.funnel_rect_height?t.funnel_rect_height:n.funnel_rect_height,e.k.validator().validatingDataType(e.chart_height,"chart_height",e.chart_width).validatingDataType(e.funnel_rect_width,"funnel_rect_width",n.funnel_rect_width).validatingDataType(e.funnel_rect_height,"funnel_rect_height",n.funnel_rect_height);try{if(e.funnel_rect_width>=e.chart_width)throw"funnel_rect_width"}catch(o){e.funnel_rect_width=n.funnel_rect_width,console.warn("%c[Warning - Pykih Charts] ","color: #F8C325;font-weight:bold;font-size:14px"," at "+e.selector+'.(Invalid value for attribute "funnel_rect_width")  Visit www.pykcharts.com/errors#warning_19')}e.stop||(e.k.storeInitialDivHeight(),"default"===e.mode&&e.k.loading(),e.executeData=function(t){var a=e.k.validator().validatingJSON(t),r=e.selector.substring(1,e.selector.length);return e.stop||a===!1?void e.k.remove_loading_bar(r):(e.data=e.k.__proto__._groupBy("oned",t),e.compare_data=e.k.__proto__._groupBy("oned",t),e.k.remove_loading_bar(r),void e.render())},PykCharts["boolean"](t.interactive_enable)?(e.k.dataFromPykQuery(r),e.k.dataSourceFormatIdentification(e.data,e,"executeData")):e.k.dataSourceFormatIdentification(t.data,e,"executeData"))},this.refresh=function(a){e.executeRefresh=function(t){e.data=e.k.__proto__._groupBy("oned",t),e.refresh_data=e.k.__proto__._groupBy("oned",t);var a=e.k.checkChangeInData(e.refresh_data,e.compare_data);e.compare_data=a[0];var r=a[1];r&&e.k.lastUpdatedAt("liveData"),e.optionalFeatures().createChart().label().ticks()},PykCharts["boolean"](t.interactive_enable)?(e.k.dataFromPykQuery(a),e.k.dataSourceFormatIdentification(e.data,e,"executeRefresh")):e.k.dataSourceFormatIdentification(t.data,e,"executeRefresh")},this.render=function(){var t=this,e=t.selector.substring(1,t.selector.length),a=e+"_svg";t.fillChart=new PykCharts.Configuration.fillChart(t),t.transitions=new PykCharts.Configuration.transition(t),"default"===t.mode&&t.k.title().backgroundColor(t)["export"](t,"#"+a,"funnel").emptyDiv(t.selector).subtitle(),t.k.tooltip(),t.mouseEvent=new PykCharts.Configuration.mouseEvent(t),"infographics"===t.mode&&(t.k.backgroundColor(t)["export"](t,"#"+a,"funnel").emptyDiv(t.selector),t.new_data=t.data),"default"===t.mode&&t.optionalFeatures(),t.optionalFeatures().svgContainer(a).createChart().label().ticks(),"default"===t.mode&&t.k.liveData(t).createFooter().lastUpdatedAt().credits().dataSource();var r=0;setTimeout(function(){t.ticks_text_width.length&&(r=d3.max(t.ticks_text_width,function(t){return t})),t.k.exportSVG(t,"#"+a,"funnel",void 0,void 0,r)},t.transitions.duration());var n=t.k.resize(t.svgContainer);t.k.__proto__._ready(n),window.addEventListener("resize",function(e){return t.k.resize(t.svgContainer)})},this.funnelLayout=function(){var t,e,a,r=this,n={data:function(e){return 0===e.length||(t=e),this},size:function(t){return 2!==t.length||(e=t),this},mouth:function(t){return 2!==t.length||(a=t),this},coordinates:function(){for(var n=e[0],o=e[1],i=a[0],l=a[1],s=(n-i)/2,_=o-l,c=0,d=0,u=0,h=0,p=[],g=s/_,m=(n+i)/2*_,f=i*l,x=m+f,y=f/x*100,v=t.length-1;v>=0;v--){var k=r.percentageValues(t)[v];if(y>=k)u=k/y*l,c=o-u,v===t.length-1?p[v]={values:[{x:(n-i)/2,y:c},{x:(n-i)/2,y:o},{x:(n-i)/2+i,y:o},{x:(n-i)/2+i,y:c}]}:p[v]={values:[{x:(n-i)/2,y:c},p[v+1].values[0],p[v+1].values[3],{x:(n-i)/2+i,y:c}]};else{var w=k/100*x-f,b=2*g,C=2*i,P=2*w;d=(-C+Math.sqrt(Math.pow(C,2)-4*b*-P))/(2*b),c=o-d-l;var D=2*(g*d)+i,S=(n-D)/2;if(0===h)v===t.length-1?p[v]={values:[{x:S,y:c},{x:(n-i)/2,y:_},{x:(n-i)/2,y:o},{x:(n-i)/2+i,y:o},{x:(n-i)/2+i,y:_},{x:D+S,y:c}]}:p[v]={values:[{x:S,y:c},{x:(n-i)/2,y:_},p[v+1].values[0],p[v+1].values[3],{x:(n-i)/2+i,y:_},{x:D+S,y:c}]};else{var A;A=6===p[v+1].values.length?5:3,p[v]={values:[{x:S,y:c},p[v+1].values[0],p[v+1].values[A],{x:D+S,y:c}]}}h=1}}return p}};return n},this.percentageValues=function(t){var e=t.map(function(e){var a=d3.max(t,function(t){return t.weight});return e.weight/a*100});return e.sort(function(t,e){return e-t}),e},this.optionalFeatures=function(){var a={svgContainer:function(a){return e.svgContainer=d3.select(t.selector).append("svg").attr({width:e.chart_width+"px",height:e.chart_height+"px",preserveAspectRatio:"xMinYMin",viewBox:"0 0 "+e.chart_width+" "+e.chart_height,id:a,"class":"svgcontainer PykCharts-oneD"}),e.group=e.svgContainer.append("g").attr("id","funnel"),this},createChart:function(){var a=new PykCharts.Configuration.border(e);e.new_data=e.data.sort(function(t,e){return e.weight-t.weight}),"shade"===e.color_mode&&(shade_array=e.k.shadeColorConversion(e.shade_color,e.new_data.length),e.new_data.forEach(function(t,e){t.color=shade_array[e]})),e.per_values=e.percentageValues(e.new_data),e.funnel=e.funnelLayout().data(e.new_data).size([e.chart_width,e.chart_height]).mouth([e.funnel_rect_width,e.funnel_rect_height]),e.coordinates=e.funnel.coordinates();var r=d3.svg.line().interpolate("linear-closed").x(function(t,e){return t.x}).y(function(t,e){return t.y});e.chart_data=e.group.selectAll(".fun-path").data(e.coordinates);var n=[{x:0,y:0},{x:e.chart_width,y:0},{x:0,y:0},{x:e.chart_width,y:0},{x:0,y:0},{x:e.chart_width,y:0}];return e.chart_data.enter().append("path").attr("class","fun-path"),e.chart_data.attr({"class":"fun-path",d:function(t){return r(n)},fill:function(t,a){return t.color=e.new_data[a].color,e.fillChart.selectColor(e.new_data[a])},"fill-opacity":1,"data-fill-opacity":function(){return d3.select(this).attr("fill-opacity")},stroke:a.color(),"stroke-width":a.width(),"stroke-dasharray":a.style(),"stroke-opacity":1,"data-id":function(t,a){return e.new_data[a].name}}).on({mouseover:function(a,r){"default"===e.mode&&(PykCharts["boolean"](e.chart_onhover_highlight_enable)&&e.mouseEvent.highlight(t.selector+" .fun-path",this),tooltip=e.data[r].tooltip||"<table><tr><th colspan='2' class='tooltip-heading'>"+e.new_data[r].name+"</tr><tr><td class='tooltip-left-content'>"+e.k.appendUnits(e.new_data[r].weight)+"<td class='tooltip-right-content'>("+e.per_values[r].toFixed(1)+"%) </tr></table>",e.mouseEvent.tooltipPosition(a),e.mouseEvent.tooltipTextShow(tooltip))},mouseout:function(a){"default"===e.mode&&(PykCharts["boolean"](e.chart_onhover_highlight_enable)&&e.mouseEvent.highlightHide(t.selector+" .fun-path"),e.mouseEvent.tooltipHide(a))},mousemove:function(t,a){"default"===e.mode&&e.mouseEvent.tooltipPosition(t)},click:function(a,r){PykCharts["boolean"](t.click_enable)&&e.addEvents(e.new_data[r].name,d3.select(this).attr("data-id"))}}).transition().duration(e.transitions.duration()).attr("d",function(t){return r(t.values);
}),e.chart_data.exit().remove(),this},label:function(){function a(){e.chart_text.text(function(t,a){return e.per_values[a].toFixed(1)+"%"}).attr({"text-anchor":"middle","pointer-events":"none",fill:function(a){if("shade"===e.color_mode&&!t.label_color){var r=e.k.__proto__._colourBrightness(a.color);return"light"===r?"black":"white"}return e.label_color}}).style({"font-weight":e.label_weight,"font-size":e.label_size+"px","font-family":e.label_family}).text(function(t,a){return this.getBBox().width<t.values[3].x-t.values[1].x&&this.getBBox().height<t.values[2].y-t.values[0].y?e.per_values[a].toFixed(1)+"%":""})}return e.chart_text=e.group.selectAll("text").data(e.coordinates),e.chart_text.enter().append("text"),e.chart_text.attr({y:function(t,e){return 4===t.values.length?(t.values[0].y-t.values[1].y)/2+t.values[1].y+5:(t.values[0].y-t.values[2].y)/2+t.values[2].y+5},x:function(t,a){return e.chart_width/2}}),e.chart_text.text(""),setTimeout(a,e.transitions.duration()),e.chart_text.exit().remove(),this},ticks:function(){function t(){n.text(function(t,a){return e.data[a].name}).text(function(t,a){return r[a]=this.getBBox().height,e.ticks_text_width.push(this.getBBox().width),this.getBBox().height<t.values[2].y-t.values[0].y?e.data[a].name:""}).style({"font-size":e.pointer_size+"px","text-anchor":"start",fill:e.pointer_color,"pointer-events":"none","font-family":e.pointer_family,"font-weight":e.pointer_weight})}function a(){l.attr("x2",function(t,e){return t.values[2].y-t.values[0].y>r[e]?4===t.values.length?(t.values[3].x+t.values[2].x)/2+12:t.values[4].x+12:4===t.values.length?(t.values[3].x+t.values[2].x)/2:t.values[4].x})}PykCharts["boolean"](e.pointer_overflow_enable)&&e.svgContainer.style("overflow","visible");var r=[];e.ticks_text_width=[];var n=e.group.selectAll(".ticks_label").data(e.coordinates);n.attr("class","ticks_label"),n.enter().append("text").attr({x:0,y:0});var o,i;n.attr("transform",function(t){return 4===t.values.length?(o=(t.values[3].x+t.values[2].x)/2+17,i=(t.values[0].y+t.values[2].y)/2+5):(o=t.values[4].x+17,i=t.values[4].y+5),"translate("+o+","+i+")"}),n.text(""),setTimeout(t,e.transitions.duration()),n.exit().remove();var l=e.group.selectAll(".funnel-ticks").data(e.coordinates);return l.enter().append("line").attr("class","funnel-ticks"),l.attr({x1:function(t,e){return 4===t.values.length?(t.values[3].x+t.values[2].x)/2:t.values[4].x},y1:function(t,e){return 4===t.values.length?(t.values[0].y+t.values[2].y)/2:t.values[4].y},x2:function(t,e){return 4===t.values.length?(t.values[3].x+t.values[2].x)/2:t.values[4].x},y2:function(t,e){return 4===t.values.length?(t.values[0].y+t.values[2].y)/2:t.values[4].y},"stroke-width":e.pointer_thickness+"px",stroke:e.pointer_color}),setTimeout(a,e.transitions.duration()),l.exit().remove(),this}};return a}},PykCharts.oneD.percentageColumn=function(t){var e=this;e.interval="";var a=new PykCharts.Configuration.Theme({});this.execute=function(e){var r=this;r=new PykCharts.validation.processInputs(r,t,"oneDimensionalCharts"),r.chart_height=PykCharts["boolean"](t.chart_height)?t.chart_height:r.chart_width,r.percent_column_rect_width=t.percent_column_rect_width?t.percent_column_rect_width:a.oneDimensionalCharts.percent_column_rect_width,r.k.validator().validatingDataType(r.chart_height,"chart_height",r.chart_width).validatingDataType(r.percent_column_rect_width,"percent_column_rect_width",a.oneDimensionalCharts.percent_column_rect_width),r.stop||(r.k.storeInitialDivHeight(),r.percent_column_rect_width>100&&(r.percent_column_rect_width=100),r.percent_column_rect_width=2*r.k.__proto__._radiusCalculation(r.percent_column_rect_width,"percentageBar"),"default"===r.mode&&r.k.loading(),r.executeData=function(t){var e=r.k.validator().validatingJSON(t),a=r.selector.substring(1,r.selector.length);return r.stop||e===!1?void r.k.remove_loading_bar(a):(r.data=r.k.__proto__._groupBy("oned",t),r.compare_data=r.k.__proto__._groupBy("oned",t),r.k.remove_loading_bar(a),r.clubdata_enable=r.data.length>r.clubdata_maximum_nodes?r.clubdata_enable:"no",void r.render())},PykCharts["boolean"](r.interactive_enable)?(r.k.dataFromPykQuery(e),r.k.dataSourceFormatIdentification(r.data,r,"executeData")):r.k.dataSourceFormatIdentification(t.data,r,"executeData"))},this.refresh=function(a){e.executeRefresh=function(t){e.data=e.k.__proto__._groupBy("oned",t),e.clubdata_enable=e.data.length>e.clubdata_maximum_nodes?e.clubdata_enable:"no",e.refresh_data=e.k.__proto__._groupBy("oned",t);var a=e.k.checkChangeInData(e.refresh_data,e.compare_data);e.compare_data=a[0];var r=a[1];r&&e.k.lastUpdatedAt("liveData"),e.optionalFeatures().clubData(),"shade"===e.color_mode&&(shade_array=e.k.shadeColorConversion(e.shade_color,e.new_data.length),e.new_data.forEach(function(t,e){t.color=shade_array[e]})),e.optionalFeatures().createChart().label().ticks()},PykCharts["boolean"](e.interactive_enable)?(e.k.dataFromPykQuery(a),e.k.dataSourceFormatIdentification(e.data,e,"executeRefresh")):e.k.dataSourceFormatIdentification(t.data,e,"executeRefresh")},this.render=function(){var e=this,a=e.selector.substring(1,e.selector.length),r=a+"_svg";e.fillChart=new PykCharts.Configuration.fillChart(e),e.transitions=new PykCharts.Configuration.transition(e),"default"===e.mode&&e.k.title().backgroundColor(e)["export"](e,"#"+r,"percentageColumn").emptyDiv(e.selector).subtitle(),"infographics"===e.mode&&(e.k.backgroundColor(e)["export"](e,"#"+r,"percentageColumn").emptyDiv(e.selector),e.new_data=e.data),e.k.tooltip(),e.mouseEvent=new PykCharts.Configuration.mouseEvent(e),"default"===e.mode&&(percent_column=e.optionalFeatures().clubData()),"shade"===e.color_mode&&(shade_array=e.k.shadeColorConversion(e.shade_color,e.new_data.length),e.new_data.forEach(function(t,e){t.color=shade_array[e]})),e.optionalFeatures().svgContainer(r).createChart().label().ticks(),"default"===e.mode&&e.k.liveData(e).createFooter().lastUpdatedAt().credits().dataSource();var n=0;setTimeout(function(){e.ticks_text_width.length&&(n=d3.max(e.ticks_text_width,function(t){return t})),e.k.exportSVG(e,"#"+r,"percentageColumn",void 0,void 0,n+15),PykCharts["boolean"](t.chart_width)||(e.chart_width=e.percent_column_rect_width+10+n,e.svgContainer.attr("viewBox","0 0 "+e.chart_width+" "+e.chart_height));var a=e.k.resize(e.svgContainer);e.k.__proto__._ready(a)},e.transitions.duration()),window.addEventListener("resize",function(t){return e.k.resize(e.svgContainer)})},this.optionalFeatures=function(){var a={createChart:function(){var t=new PykCharts.Configuration.border(e),a=e.new_data.map(function(t){return t.weight});a.sum=function(){for(var t=0,e=0;e<this.length;++e)t+=this[e];return t};var r=a.sum();return e.new_data.forEach(function(t,e){this[e].percentValue=100*t.weight/r},e.new_data),e.chart_data=e.group.selectAll(".per-rect").data(e.new_data),e.chart_data.enter().append("rect").attr("class","per-rect"),e.chart_data.attr({x:0,y:function(t,a){if(0===a)return 0;var r=0,n=e.new_data.slice(0,a);return n.forEach(function(t,e){r+=this[e].percentValue},n),r*e.chart_height/100},width:e.percent_column_rect_width,height:0,fill:function(t){return e.fillChart.selectColor(t)},"fill-opacity":1,"data-fill-opacity":function(){return d3.select(this).attr("fill-opacity")},stroke:t.color(),"stroke-width":t.width(),"stroke-dasharray":t.style(),"data-id":function(t,e){return t.name}}).on({mouseover:function(t,a){"default"===e.mode&&(t.tooltip=t.tooltip||"<table class='PykCharts'><tr><th colspan='2' class='tooltip-heading'>"+t.name+"</tr><tr><td class='tooltip-left-content'>"+e.k.appendUnits(t.weight)+"<td class='tooltip-right-content'>("+t.percentValue.toFixed(1)+"%)</tr></table>",PykCharts["boolean"](e.chart_onhover_highlight_enable)&&e.mouseEvent.highlight(e.selector+" .per-rect",this),e.mouseEvent.tooltipPosition(t),e.mouseEvent.tooltipTextShow(t.tooltip))},mouseout:function(t){"default"===e.mode&&(PykCharts["boolean"](e.chart_onhover_highlight_enable)&&e.mouseEvent.highlightHide(e.selector+" .per-rect"),e.mouseEvent.tooltipHide(t))},mousemove:function(t,a){"default"===e.mode&&e.mouseEvent.tooltipPosition(t)},click:function(t,a){PykCharts["boolean"](e.click_enable)&&e.addEvents(t.name,d3.select(this).attr("data-id"))}}).transition().duration(e.transitions.duration()).attr("height",function(t){return t.percentValue*e.chart_height/100}),e.chart_data.exit().remove(),this},svgContainer:function(t){return e.svgContainer=d3.select(e.selector).append("svg").attr({width:e.chart_width,height:e.chart_height,preserveAspectRatio:"xMinYMin",viewBox:"0 0 "+e.chart_width+" "+e.chart_height,id:t,"class":"svgcontainer PykCharts-oneD"}),e.group=e.svgContainer.append("g").attr("id","percentageColumn"),this},label:function(){function a(){e.chart_text.text(function(t){return t.percentValue.toFixed(1)+"%"}).text(function(t){return this.getBBox().width<.92*e.percent_column_rect_width&&this.getBBox().height<t.percentValue*e.chart_height/100?t.percentValue.toFixed(1)+"%":""})}e.chart_text=e.group.selectAll(".per-text").data(e.new_data);var r=0;return e.chart_text.enter().append("text").attr("class","per-text"),e.chart_text.attr({"class":"per-text",x:e.percent_column_rect_width/2,y:function(t,a){return r+=t.percentValue,0===a?(0+r*e.chart_height/100)/2+5:((r-t.percentValue)*e.chart_height/100+r*e.chart_height/100)/2+5}}),r=0,e.chart_text.text("").attr({fill:function(a){if("shade"===e.color_mode&&!t.label_color){var r=e.k.__proto__._colourBrightness(a.color);return"light"===r?"black":"white"}return e.label_color},"text-anchor":"middle","pointer-events":"none"}).style({"font-size":e.label_size+"px","font-weight":e.label_weight,"font-family":e.label_family}),setTimeout(a,e.transitions.duration()),e.chart_text.exit().remove(),this},ticks:function(){function t(){s.text(function(t){return t.name}).text(function(t,a){return i[a]=this.getBBox().height,e.ticks_text_width[a]=this.getBBox().width,this.getBBox().height<t.percentValue*e.chart_height/100?t.name:""}),n=0,l.attr({x1:function(t,a){return e.percent_column_rect_width},y1:function(t,a){return n+=t.percentValue,0===a?(0+n*e.chart_height/100)/2:((n-t.percentValue)*e.chart_height/100+n*e.chart_height/100)/2},x2:function(t,a){return e.percent_column_rect_width},y2:function(t,a){return o+=t.percentValue,0===a?(0+o*e.chart_height/100)/2:((o-t.percentValue)*e.chart_height/100+o*e.chart_height/100)/2},"stroke-width":e.pointer_thickness+"px",stroke:e.pointer_color,x2:function(t,a){return t.percentValue*e.chart_height/100>i[a]?e.percent_column_rect_width+10:e.percent_column_rect_width}})}PykCharts["boolean"](e.pointer_overflow_enable)&&e.svgContainer.style("overflow","visible");var a,r,n=0,o=0,i=[];n=0,e.ticks_text_width=[];var l=e.group.selectAll(".per-ticks").data(e.new_data);l.enter().append("line").attr("class","per-ticks");var s=e.group.selectAll(".ticks_label").data(e.new_data);return s.enter().append("text").attr("class","ticks_label"),s.attr("class","ticks_label").attr("transform",function(t){return n+=t.percentValue,a=e.percent_column_rect_width+15,r=((n-t.percentValue)*e.chart_height/100+n*e.chart_height/100)/2+5,"translate("+a+","+r+")"}),s.text(function(t){return""}).attr({"font-size":e.pointer_size,"text-anchor":"start",fill:e.pointer_color,"font-family":e.pointer_family,"font-weight":e.pointer_weight,"pointer-events":"none"}),setTimeout(t,e.transitions.duration()),s.exit().remove(),l.exit().remove(),this},clubData:function(){if(PykCharts["boolean"](e.clubdata_enable)){var t=[];if(0!==e.clubdata_always_include_data_points.length){var a=e.clubdata_always_include_data_points.length;for(i=0;i<a;i++)t[i]=e.clubdata_always_include_data_points[i]}var r=[];for(i=0;i<t.length;i++)for(j=0;j<e.data.length;j++)t[i].toUpperCase()===e.data[j].name.toUpperCase()&&r.push(e.data[j]);e.data.sort(function(t,e){return e.weight-t.weight});for(var n=0;r.length<e.clubdata_maximum_nodes-1;){for(i=0;i<t.length;i++)e.data[n].name.toUpperCase()===t[i].toUpperCase()&&n++;r.push(e.data[n]),n++}var o=0;for(j=n;j<e.data.length;j++){for(i=0;i<r.length&&j<e.data.length;i++)e.data[j].name.toUpperCase()===r[i].name.toUpperCase()&&(o+=0,j++,i=-1);j<e.data.length&&(o+=e.data[j].weight)}for(var l=function(t,e){return e.weight-t.weight};r.length>e.clubdata_maximum_nodes;){r.sort(l);r.pop()}var s={name:e.clubdata_text,weight:o,tooltip:e.clubdata_tooltip};r.sort(function(t,e){return e.weight-t.weight}),r.length<e.clubdata_maximum_nodes&&r.push(s),e.new_data=r}else e.data.sort(function(t,e){return e.weight-t.weight}),e.new_data=e.data;return this}};return a}},PykCharts.oneD.percentageBar=function(t){var e=this;e.interval="";var a=new PykCharts.Configuration.Theme({});this.execute=function(e){var r=this;r=new PykCharts.validation.processInputs(r,t,"oneDimensionalCharts"),r.percent_row_rect_height=t.percent_row_rect_height?t.percent_row_rect_height:a.oneDimensionalCharts.percent_row_rect_height,r.percent_row_rect_height>100&&(r.percent_row_rect_height=100),r.percent_row_rect_height=2*r.k.__proto__._radiusCalculation(r.percent_row_rect_height),r.chart_height=PykCharts["boolean"](t.chart_height)?t.chart_height:r.percent_row_rect_height+10+r.pointer_size,r.k.validator().validatingDataType(r.chart_height,"chart_height",r.chart_width/2).validatingDataType(r.percent_row_rect_height,"percent_row_rect_height",a.oneDimensionalCharts.percent_row_rect_height),r.stop||(r.k.storeInitialDivHeight(),"default"===r.mode&&r.k.loading(),r.executeData=function(t){var e=r.k.validator().validatingJSON(t),a=r.selector.substring(1,r.selector.length);return r.stop||e===!1?void r.k.remove_loading_bar(a):(r.data=r.k.__proto__._groupBy("oned",t),r.compare_data=r.k.__proto__._groupBy("oned",t),r.k.remove_loading_bar(a),r.clubdata_enable=r.data.length>r.clubdata_maximum_nodes?r.clubdata_enable:"no",void r.render())},PykCharts["boolean"](r.interactive_enable)?(r.k.dataFromPykQuery(e),r.k.dataSourceFormatIdentification(r.data,r,"executeData")):r.k.dataSourceFormatIdentification(t.data,r,"executeData"))},this.refresh=function(a){e.executeRefresh=function(t){e.data=e.k.__proto__._groupBy("oned",t),e.clubdata_enable=e.data.length>e.clubdata_maximum_nodes?e.clubdata_enable:"no",e.refresh_data=e.k.__proto__._groupBy("oned",t);var a=e.k.checkChangeInData(e.refresh_data,e.compare_data);e.compare_data=a[0];var r=a[1];r&&e.k.lastUpdatedAt("liveData"),e.optionalFeatures().clubData(),"shade"===e.color_mode&&(shade_array=e.k.shadeColorConversion(e.shade_color,e.new_data.length),e.new_data.forEach(function(t,e){t.color=shade_array[e]})),e.optionalFeatures().createChart().label().ticks()},PykCharts["boolean"](e.interactive_enable)?(e.k.dataFromPykQuery(a),e.k.dataSourceFormatIdentification(e.data,e,"executeRefresh")):e.k.dataSourceFormatIdentification(t.data,e,"executeRefresh")},this.render=function(){var t=this,e=t.selector.substring(1,t.selector.length),a=e+"_svg";t.fillChart=new PykCharts.Configuration.fillChart(t),t.transitions=new PykCharts.Configuration.transition(t),"default"===t.mode&&t.k.title().backgroundColor(t)["export"](t,"#"+a,"percentageBar").emptyDiv(t.selector).subtitle(),"infographics"===t.mode&&(t.k.backgroundColor(t)["export"](t,"#"+a,"percentageBar").emptyDiv(t.selector),t.new_data=t.data,"shade"===t.color_mode&&(shade_array=t.k.shadeColorConversion(t.shade_color,t.new_data.length),t.new_data.forEach(function(t,e){t.color=shade_array[e]}))),t.k.tooltip(),t.mouseEvent=new PykCharts.Configuration.mouseEvent(t),"default"===t.mode&&(percent_bar=t.optionalFeatures().clubData(),"shade"===t.color_mode&&(shade_array=t.k.shadeColorConversion(t.shade_color,t.new_data.length),t.new_data.forEach(function(t,e){t.color=shade_array[e]}))),t.optionalFeatures().svgContainer(a).createChart().label().ticks(),"default"===t.mode&&t.k.liveData(t).createFooter().lastUpdatedAt().credits().dataSource();var r=0;setTimeout(function(){t.ticks_text_height&&(r=t.ticks_text_height+10),t.k.exportSVG(t,"#"+a,"percentageBar",void 0,void 0,0,r)},t.transitions.duration());var n=t.k.resize(t.svgContainer);t.k.__proto__._ready(n),window.addEventListener("resize",function(e){return t.k.resize(t.svgContainer)})},this.optionalFeatures=function(){var a={createChart:function(){var t=new PykCharts.Configuration.border(e),a=e.new_data.map(function(t){return t.weight});a.sum=function(){for(var t=0,e=0;e<this.length;++e)t+=this[e];return t};var r=a.sum();return e.new_data.forEach(function(t,e){this[e].percentValue=100*t.weight/r},e.new_data),e.chart_data=e.group.selectAll(".per-rect").data(e.new_data),e.chart_data.enter().append("rect").attr("class","per-rect"),e.chart_data.attr({x:0,x:function(t,a){if(0===a)return 0;var r=0,n=e.new_data.slice(0,a);return n.forEach(function(t,e){r+=this[e].percentValue},n),r*e.chart_width/100},width:0,height:function(t){return e.percent_row_rect_height},fill:function(t){return e.fillChart.selectColor(t)},"fill-opacity":1,"data-fill-opacity":function(){return d3.select(this).attr("fill-opacity")},stroke:t.color(),"stroke-width":t.width(),"stroke-dasharray":t.style(),"data-id":function(t,e){return t.name}}).on({mouseover:function(t,a){"default"===e.mode&&(t.tooltip=t.tooltip||"<table class='PykCharts'><tr><th colspan='2' class='tooltip-heading'>"+t.name+"</tr><tr><td class='tooltip-left-content'>"+e.k.appendUnits(t.weight)+"<td class='tooltip-right-content'>("+t.percentValue.toFixed(1)+"%)</tr></table>",PykCharts["boolean"](e.chart_onhover_highlight_enable)&&e.mouseEvent.highlight(e.selector+" .per-rect",this),e.mouseEvent.tooltipPosition(t),e.mouseEvent.tooltipTextShow(t.tooltip))},mouseout:function(t){"default"===e.mode&&(PykCharts["boolean"](e.chart_onhover_highlight_enable)&&e.mouseEvent.highlightHide(e.selector+" .per-rect"),e.mouseEvent.tooltipHide(t))},mousemove:function(t,a){"default"===e.mode&&e.mouseEvent.tooltipPosition(t)},click:function(t,a){PykCharts["boolean"](e.click_enable)&&e.addEvents(t.name,d3.select(this).attr("data-id"))}}).transition().duration(e.transitions.duration()).attr("width",function(t){return t.percentValue*e.chart_width/100}),e.chart_data.exit().remove(),this},svgContainer:function(t){return e.svgContainer=d3.select(e.selector).append("svg").attr({width:e.chart_width,height:e.chart_height,preserveAspectRatio:"xMinYMin",viewBox:"0 0 "+e.chart_width+" "+e.chart_height,id:t,"class":"svgcontainer PykCharts-oneD"}),e.group=e.svgContainer.append("g").attr("id","percentageBar"),this},label:function(){function a(){e.chart_text.text(function(t){return t.percentValue.toFixed(1)+"%"}).text(function(t){return this.getBBox().width<.92*(t.percentValue*e.chart_width/100)&&this.getBBox().height<e.percent_row_rect_height?t.percentValue.toFixed(1)+"%":""})}e.chart_text=e.group.selectAll(".per-text").data(e.new_data);var r=0;return e.chart_text.enter().append("text").attr("class","per-text"),e.chart_text.attr({"class":"per-text",y:e.percent_row_rect_height/2+5,x:function(t,a){return r+=t.percentValue,0===a?(0+r*e.chart_width/100)/2:((r-t.percentValue)*e.chart_width/100+r*e.chart_width/100)/2}}),r=0,e.chart_text.text("").attr({fill:function(a){if("shade"===e.color_mode&&!t.label_color){var r=e.k.__proto__._colourBrightness(a.color);return"light"===r?"black":"white"}return e.label_color},"text-anchor":"middle","pointer-events":"none"}).style({"font-size":e.label_size+"px","font-weight":e.label_weight,"font-family":e.label_family}),setTimeout(a,e.transitions.duration()),e.chart_text.exit().remove(),this},ticks:function(){function t(){s.text(function(t){return t.name}).text(function(t,a){return i[a]=this.getBBox().width,e.ticks_text_height=this.getBBox().height,this.getBBox().width<t.percentValue*e.chart_width/100?t.name:""}),n=0,l.attr({y1:function(t,a){return e.percent_row_rect_height},x1:function(t,a){return n+=t.percentValue,0===a?(0+n*e.chart_width/100)/2:((n-t.percentValue)*e.chart_width/100+n*e.chart_width/100)/2},y2:function(t,a){return e.percent_row_rect_height},x2:function(t,a){return o+=t.percentValue,0===a?(0+o*e.chart_width/100)/2:((o-t.percentValue)*e.chart_width/100+o*e.chart_width/100)/2},"stroke-width":e.pointer_thickness+"px",stroke:e.pointer_color,y2:function(t,a){return t.percentValue*e.chart_width/100>i[a]?e.percent_row_rect_height+10:e.percent_row_rect_height}}).style("margin-top","10px")}PykCharts["boolean"](e.pointer_overflow_enable)&&e.svgContainer.style("overflow","visible");var a,r,n=0,o=0,i=[];e.ticks_text_height,n=0;var l=e.group.selectAll(".per-ticks").data(e.new_data);l.enter().append("line").attr("class","per-ticks");var s=e.group.selectAll(".ticks_label").data(e.new_data);return s.enter().append("text").attr("class","ticks_label"),s.attr("class","ticks_label").attr("transform",function(t){return n+=t.percentValue,r=e.percent_row_rect_height+e.pointer_size+10,a=((n-t.percentValue)*e.chart_width/100+n*e.chart_width/100)/2,"translate("+a+","+r+")"}),s.text(function(t){return""}).attr({"font-size":e.pointer_size,"text-anchor":"middle",fill:e.pointer_color,"font-family":e.pointer_family,"font-weight":e.pointer_weight,"pointer-events":"none"}),setTimeout(t,e.transitions.duration()),s.exit().remove(),l.exit().remove(),this},clubData:function(){if(PykCharts["boolean"](e.clubdata_enable)){var t=[];if(0!==e.clubdata_always_include_data_points.length){var a=e.clubdata_always_include_data_points.length;for(i=0;i<a;i++)t[i]=e.clubdata_always_include_data_points[i]}var r=[];for(i=0;i<t.length;i++)for(j=0;j<e.data.length;j++)t[i].toUpperCase()===e.data[j].name.toUpperCase()&&r.push(e.data[j]);e.data.sort(function(t,e){return e.weight-t.weight});for(var n=0;r.length<e.clubdata_maximum_nodes-1;){for(i=0;i<t.length;i++)e.data[n].name.toUpperCase()===t[i].toUpperCase()&&n++;r.push(e.data[n]),n++}var o=0;for(j=n;j<e.data.length;j++){for(i=0;i<r.length&&j<e.data.length;i++)e.data[j].name.toUpperCase()===r[i].name.toUpperCase()&&(o+=0,j++,i=-1);j<e.data.length&&(o+=e.data[j].weight)}for(var l=function(t,e){return e.weight-t.weight};r.length>e.clubdata_maximum_nodes;){r.sort(l);r.pop()}var s={name:e.clubdata_text,weight:o,tooltip:e.clubdata_tooltip};r.sort(function(t,e){return e.weight-t.weight}),r.length<e.clubdata_maximum_nodes&&r.push(s),e.new_data=r}else e.data.sort(function(t,e){return e.weight-t.weight}),e.new_data=e.data;return this}};return a}},PykCharts.oneD.pie=function(t){var e=this;e.interval="";var a=new PykCharts.Configuration.Theme({});this.execute=function(r){e=new PykCharts.validation.processInputs(e,t,"oneDimensionalCharts"),t.chart_height?(e.chart_height=t.chart_height,e.calculation=void 0):(e.chart_height=e.chart_width,e.calculation="pie"),e.pie_radius_percent=t.pie_radius_percent?t.pie_radius_percent:a.oneDimensionalCharts.pie_radius_percent,e.k.validator().validatingDataType(e.chart_height,"chart_height",e.chart_width).validatingDataType(e.pie_radius_percent,"pie_radius_percent",a.oneDimensionalCharts.pie_radius_percent),e.stop||(e.k.storeInitialDivHeight(),e.innerRadiusPercent=0,e.height_translate=e.chart_height/2,e.pie_radius_percent>100&&(e.pie_radius_percent=100),"default"===e.mode&&e.k.loading(),e.executeData=function(a){var r=e.k.validator().validatingJSON(a),n=e.selector.substring(1,e.selector.length);if(e.stop||r===!1)return void e.k.remove_loading_bar(n);e.data=e.k.__proto__._groupBy("oned",a),e.compare_data=e.k.__proto__._groupBy("oned",a),e.k.remove_loading_bar(n);var o=new PykCharts.oneD.pieFunctions(t,e,"pie");e.clubdata_enable=e.data.length>e.clubdata_maximum_nodes?e.clubdata_enable:"no",o.render()},PykCharts["boolean"](e.interactive_enable)?(e.k.dataFromPykQuery(r),e.k.dataSourceFormatIdentification(e.data,e,"executeData")):e.k.dataSourceFormatIdentification(t.data,e,"executeData"))}},PykCharts.oneD.donut=function(t){var e=this;e.interval="";var a=new PykCharts.Configuration.Theme({});this.execute=function(r){if(e=new PykCharts.validation.processInputs(e,t,"oneDimensionalCharts"),t.chart_height?(e.chart_height=t.chart_height,e.calculation=void 0):(e.chart_height=e.chart_width,e.calculation="pie"),e.pie_radius_percent=t.donut_radius_percent?t.donut_radius_percent:a.oneDimensionalCharts.donut_radius_percent,e.innerRadiusPercent=t.donut_inner_radius_percent?t.donut_inner_radius_percent:a.oneDimensionalCharts.donut_inner_radius_percent,e.k.validator().validatingDataType(e.chart_height,"chart_height",e.chart_width).validatingDataType(e.pie_radius_percent,"donut_radius_percent",a.oneDimensionalCharts.donut_radius_percent).validatingDataType(e.innerRadiusPercent,"donut_inner_radius_percent",a.oneDimensionalCharts.donut_inner_radius_percent),!e.stop){e.k.storeInitialDivHeight(),e.pie_radius_percent>100&&(e.pie_radius_percent=100),e.innerRadiusPercent>100&&(e.innerRadiusPercent=100);try{if(e.innerRadiusPercent>=e.pie_radius_percent)throw e.innerRadiusPercent=a.oneDimensionalCharts.donut_inner_radius_percent,"donut_inner_radius_percent"}catch(n){e.k.warningHandling(n,"6")}e.stop||("default"===e.mode&&e.k.loading(),e.height_translate=e.chart_height/2,e.show_total_at_center=t.donut_show_total_at_center?t.donut_show_total_at_center.toLowerCase():a.oneDimensionalCharts.donut_show_total_at_center,e.show_total_at_center_size="donut_show_total_at_center_size"in t?t.donut_show_total_at_center_size:a.oneDimensionalCharts.donut_show_total_at_center_size,e.show_total_at_center_color=t.donut_show_total_at_center_color?t.donut_show_total_at_center_color:a.oneDimensionalCharts.donut_show_total_at_center_color,e.show_total_at_center_weight=t.donut_show_total_at_center_weight?t.donut_show_total_at_center_weight:a.oneDimensionalCharts.donut_show_total_at_center_weight,e.show_total_at_center_family=t.donut_show_total_at_center_family?t.donut_show_total_at_center_family:a.oneDimensionalCharts.donut_show_total_at_center_family,e.executeData=function(a){var r=e.k.validator().validatingJSON(a),n=e.selector.substring(1,e.selector.length);if(e.stop||r===!1)return void e.k.remove_loading_bar(n);e.data=e.k.__proto__._groupBy("oned",a),e.compare_data=e.k.__proto__._groupBy("oned",a),e.k.remove_loading_bar(n);var o=new PykCharts.oneD.pieFunctions(t,e,"donut");e.clubdata_enable=e.data.length>e.clubdata_maximum_nodes?e.clubdata_enable:"no",o.render()},PykCharts["boolean"](e.interactive_enable)?(e.k.dataFromPykQuery(r),e.k.dataSourceFormatIdentification(e.data,e,"executeData")):e.k.dataSourceFormatIdentification(t.data,e,"executeData"))}}},PykCharts.oneD.electionPie=function(t){var e=this;e.interval="";var a=new PykCharts.Configuration.Theme({});this.execute=function(r){if(e=new PykCharts.validation.processInputs(e,t,"oneDimensionalCharts"),t.chart_height||void 0===t.chart_height)try{if(void 0===t.chart_height)t.chart_height="";else if(isNaN(t.chart_height))throw t.chart_height="","chart_height"}catch(n){e.k.warningHandling(n)}PykCharts["boolean"](t.chart_height)?(e.chart_height=t.chart_height,e.calculation=void 0,e.height_translate=e.chart_height/2):(e.chart_height=e.chart_width/2,e.calculation="pie",e.height_translate=e.chart_height),e.pie_radius_percent=t.pie_radius_percent?t.pie_radius_percent:a.oneDimensionalCharts.pie_radius_percent;try{if(isNaN(e.pie_radius_percent))throw e.pie_radius_percent=a.oneDimensionalCharts.pie_radius_percent,"pie_radius_percent"}catch(n){e.k.warningHandling(n,"1")}e.stop||(e.k.storeInitialDivHeight(),e.pie_radius_percent>100&&(e.pie_radius_percent=100),"default"===e.mode&&e.k.loading(),e.innerRadiusPercent=0,e.executeData=function(a){var r=e.k.validator().validatingJSON(a),n=e.selector.substring(1,e.selector.length);if(e.stop||r===!1)return void e.k.remove_loading_bar(n);e.data=e.k.__proto__._groupBy("oned",a),e.compare_data=e.k.__proto__._groupBy("oned",a),e.k.remove_loading_bar(n);var o=new PykCharts.oneD.pieFunctions(t,e,"election pie");e.clubdata_enable=e.data.length>e.clubdata_maximum_nodes?e.clubdata_enable:"no",o.render()},PykCharts["boolean"](e.interactive_enable)?(e.k.dataFromPykQuery(r),e.k.dataSourceFormatIdentification(e.data,e,"executeData")):e.k.dataSourceFormatIdentification(t.data,e,"executeData"))}},PykCharts.oneD.electionDonut=function(t){var e=this;e.interval="";var a=new PykCharts.Configuration.Theme({});this.execute=function(r){if(e=new PykCharts.validation.processInputs(e,t,"oneDimensionalCharts"),t.chart_height||void 0===t.chart_height)try{if(void 0===t.chart_height)t.chart_height="";else if(isNaN(t.chart_height))throw t.chart_height="","chart_height"}catch(n){e.k.warningHandling(n)}if(PykCharts["boolean"](t.chart_height)?(e.chart_height=t.chart_height,e.calculation=void 0,e.height_translate=e.chart_height/2):(e.chart_height=e.chart_width/2,e.calculation="pie",e.height_translate=e.chart_height),e.pie_radius_percent=t.donut_radius_percent?t.donut_radius_percent:a.oneDimensionalCharts.donut_radius_percent,e.innerRadiusPercent=t.donut_inner_radius_percent&&t.donut_inner_radius_percent?t.donut_inner_radius_percent:a.oneDimensionalCharts.donut_inner_radius_percent,e.k.validator().validatingDataType(e.pie_radius_percent,"donut_radius_percent",a.oneDimensionalCharts.donut_radius_percent).validatingDataType(e.innerRadiusPercent,"donut_inner_radius_percent",a.oneDimensionalCharts.donut_inner_radius_percent),!e.stop){e.k.storeInitialDivHeight(),e.pie_radius_percent>100&&(e.pie_radius_percent=100),e.innerRadiusPercent>100&&(e.innerRadiusPercent=100);try{if(e.innerRadiusPercent>=e.pie_radius_percent)throw e.innerRadiusPercent=a.oneDimensionalCharts.donut_inner_radius_percent,"donut_inner_radius_percent"}catch(n){e.k.warningHandling(n,"6")}e.stop||("default"===e.mode&&e.k.loading(),e.show_total_at_center=t.donut_show_total_at_center?t.donut_show_total_at_center.toLowerCase():a.oneDimensionalCharts.donut_show_total_at_center,e.show_total_at_center_size="donut_show_total_at_center_size"in t?t.donut_show_total_at_center_size:a.oneDimensionalCharts.donut_show_total_at_center_size,e.show_total_at_center_color=t.donut_show_total_at_center_color?t.donut_show_total_at_center_color:a.oneDimensionalCharts.donut_show_total_at_center_color,e.show_total_at_center_weight=t.donut_show_total_at_center_weight?t.donut_show_total_at_center_weight:a.oneDimensionalCharts.donut_show_total_at_center_weight,e.show_total_at_center_family=t.donut_show_total_at_center_family?t.donut_show_total_at_center_family:a.oneDimensionalCharts.donut_show_total_at_center_family,e.executeData=function(a){var r=e.k.validator().validatingJSON(a),n=e.selector.substring(1,e.selector.length);if(e.stop||r===!1)return void e.k.remove_loading_bar(n);e.data=e.k.__proto__._groupBy("oned",a),e.compare_data=e.k.__proto__._groupBy("oned",a),e.k.remove_loading_bar(n);var o=new PykCharts.oneD.pieFunctions(t,e,"election donut");e.clubdata_enable=e.data.length>e.clubdata_maximum_nodes?e.clubdata_enable:"no",o.render()},PykCharts["boolean"](e.interactive_enable)?(e.k.dataFromPykQuery(r),e.k.dataSourceFormatIdentification(e.data,e,"executeData")):e.k.dataSourceFormatIdentification(t.data,e,"executeData"))}}},PykCharts.oneD.pieFunctions=function(t,e,a){var r=e;r.refresh=function(e){r.executeRefresh=function(t){r.data=r.k.__proto__._groupBy("oned",t),r.clubdata_enable=r.data.length>r.clubdata_maximum_nodes?r.clubdata_enable:"no",r.refresh_data=r.k.__proto__._groupBy("oned",t);var e=r.k.checkChangeInData(r.refresh_data,r.compare_data),a=[];r.compare_data=e[0];var n=e[1];n&&r.k.lastUpdatedAt("liveData"),r.new_data=r.optionalFeatures().clubData(),r.optionalFeatures().createChart(a).label().ticks().centerLabel()},PykCharts["boolean"](r.interactive_enable)?(r.k.dataFromPykQuery(e),r.k.dataSourceFormatIdentification(r.data,r,"executeRefresh")):r.k.dataSourceFormatIdentification(t.data,r,"executeRefresh")},this.render=function(){r.count=1;var t=r.selector.substring(1,r.selector.length),e=t+"_svg",n=[];r.fillChart=new PykCharts.Configuration.fillChart(r),r.transitions=new PykCharts.Configuration.transition(r),"default"===r.mode.toLowerCase()?(r.k.title().backgroundColor(r)["export"](r,"#"+e,a).emptyDiv(r.selector).subtitle(),r.optionalFeatures().svgContainer(e),r.new_data=r.optionalFeatures().clubData(),r.k.createFooter().lastUpdatedAt().credits().dataSource().tooltip(),r.optionalFeatures().set_start_end_angle().createChart(n).label().ticks().centerLabel(),
r.k.liveData(r)):"infographics"===r.mode.toLowerCase()&&(r.new_data=r.data,r.k.backgroundColor(r)["export"](r,"#"+e,a).emptyDiv(r.selector),r.optionalFeatures().svgContainer(e).set_start_end_angle().createChart(n).label().ticks().centerLabel(),r.k.tooltip()),r.mouseEvent=new PykCharts.Configuration.mouseEvent(r);var o=0,i=0;setTimeout(function(){r.ticks_text_width.length&&(o=d3.max(r.ticks_text_width,function(t){return t}),i=r.ticks_text_height),r.k.exportSVG(r,"#"+e,a,void 0,void 0,o+20,i+20)},r.transitions.duration());var l=r.k.resize(r.svgContainer);r.k.__proto__._ready(l),window.addEventListener("resize",function(t){return r.k.resize(r.svgContainer)})},r.optionalFeatures=function(){var e={svgContainer:function(t){return r.svgContainer=d3.select(r.selector).append("svg").attr({width:r.chart_width,height:function(){return r.chart_height},preserveAspectRatio:"xMinYMin",viewBox:"0 0 "+r.chart_width+" "+r.chart_height,id:t,"class":"svgcontainer PykCharts-oneD"}),r.group=r.svgContainer.append("g").attr({transform:"translate("+r.chart_width/2+","+r.height_translate+")",id:"pieGroup"}),this},createChart:function(){document.querySelector(r.selector+" #pieGroup").innerHTML=null;var t=new PykCharts.Configuration.border(r);if("shade"===r.color_mode&&(shade_array=r.k.shadeColorConversion(r.shade_color,r.new_data.length),r.new_data.forEach(function(t,e){t.color=shade_array[e]})),"pie"===a.toLowerCase()||"donut"===a.toLowerCase()){r.new_data.sort(function(t,e){return t.weight-e.weight});var e=r.new_data.pop();if(r.new_data.unshift(e),PykCharts["boolean"](r.clubdata_enable)&&"default"===r.mode){for(var n,o,i=0;i<r.new_data.length;i++)if(r.new_data[i].name===r.clubdata_text){n=i,o=r.new_data[i];break}if(n){if(r.new_data.splice(n,1),0===i){var e=r.new_data.pop();r.new_data.splice(0,0,e)}r.new_data.splice(1,0,o)}}}else if(("election pie"==a.toLowerCase()||"election donut"==a.toLowerCase())&&(r.new_data.sort(function(t,e){return e.weight-t.weight}),PykCharts["boolean"](r.clubdata_enable)&&"default"===r.mode)){for(var n,o,i=0;i<r.new_data.length;i++)if(r.new_data[i].name===r.clubdata_text){n=i,o=r.new_data[i];break}n&&(r.new_data.splice(n,1),r.new_data.push(o))}r.sum=0;for(var i=0,l=r.new_data.length;l>i;i++)r.sum+=r.new_data[i].weight;return r.inner_radius=r.k.__proto__._radiusCalculation(r.innerRadiusPercent,r.calculation),r.outer_radius=r.k.__proto__._radiusCalculation(r.pie_radius_percent,r.calculation),r.arc=d3.svg.arc().innerRadius(r.inner_radius).outerRadius(r.outer_radius),r.pie=d3.layout.pie().value(function(t){return t.weight}).sort(null).startAngle(r.start_angle).endAngle(r.end_angle),r.chart_data=r.group.selectAll("path").data(r.pie(r.new_data)),r.chart_data.enter().append("path"),r.chart_data.attr("class","pie"),r.chart_data.attr({fill:function(t,e){return r.fillChart.selectColor(t.data)},"fill-opacity":1,"data-fill-opacity":function(){return d3.select(this).attr("fill-opacity")},stroke:t.color(),"stroke-width":t.width(),"stroke-dasharray":t.style(),"data-id":function(t){return t.data.name}}).on({mouseover:function(t){"default"===r.mode&&(t.data.tooltip=t.data.tooltip||"<table class='PykCharts'><tr><th colspan='2' class='tooltip-heading'>"+t.data.name+"</tr><tr><td class='tooltip-left-content'>"+r.k.appendUnits(t.data.weight)+"<td class='tooltip-right-content'>("+(100*t.data.weight/r.sum).toFixed(1)+"%) </tr></table>",PykCharts["boolean"](r.chart_onhover_highlight_enable)&&r.mouseEvent.highlight(r.selector+" .pie",this),r.mouseEvent.tooltipPosition(t),r.mouseEvent.tooltipTextShow(t.data.tooltip))},mouseout:function(t){"default"===r.mode&&(PykCharts["boolean"](r.chart_onhover_highlight_enable)&&r.mouseEvent.highlightHide(r.selector+" .pie"),r.mouseEvent.tooltipHide(t))},mousemove:function(t){"default"===r.mode&&r.mouseEvent.tooltipPosition(t)},click:function(t){PykCharts["boolean"](r.click_enable)&&r.addEvents(t.data.name,d3.select(this).attr("data-id"))}}),r.chart_data.transition().delay(function(t,e){return r.transition_duration&&"default"===r.mode?e*r.transition_duration*1e3/r.new_data.length:0}).duration(r.transitions.duration()/r.new_data.length).attrTween("d",function(t){var e=d3.interpolate(t.startAngle,t.endAngle);return function(a){return t.endAngle=e(a),r.arc(t)}}),r.chart_data.exit().remove(),this},label:function(){function e(){r.chart_text.style({"font-weight":r.label_weight,"font-size":r.label_size+"px","font-family":r.label_family}).text(function(t){return(100*t.data.weight/r.sum).toFixed(1)+"%"}).attr({"text-anchor":"middle","pointer-events":"none",dy:5,fill:function(e){if("shade"===r.color_mode&&!t.label_color){var a=r.k.__proto__._colourBrightness(e.data.color);return"light"===a?"black":"white"}return r.label_color}}).text(function(t,e){return"pie"===a.toLowerCase()||"election pie"===a.toLowerCase()?this.getBBox().width<(t.endAngle-t.startAngle)*(r.outer_radius/2)?(100*t.data.weight/r.sum).toFixed(1)+"%":"":this.getBBox().width<Math.abs(t.endAngle-t.startAngle)*r.outer_radius*.9&&this.getBBox().height<.75*(r.outer_radius-r.inner_radius)?(100*t.data.weight/r.sum).toFixed(1)+"%":""}),r.chart_text.exit().remove()}return r.chart_text=r.group.selectAll("text").data(r.pie(r.new_data)),r.chart_text.enter().append("text").attr({"class":"pie-label",transform:function(t){return"translate("+r.arc.centroid(t)+")"}}),r.chart_text.attr("transform",function(t){return"translate("+r.arc.centroid(t)+")"}),r.chart_text.text(""),setTimeout(e,r.transitions.duration()),this},clubData:function(){if(PykCharts["boolean"](r.clubdata_enable)){var t=[];if(0!==r.clubdata_always_include_data_points.length){var e=r.clubdata_always_include_data_points.length;for(i=0;i<e;i++)t[i]=r.clubdata_always_include_data_points[i]}var a=[];for(i=0;i<t.length;i++)for(j=0;j<r.data.length;j++)t[i].toUpperCase()===r.data[j].name.toUpperCase()&&a.push(r.data[j]);r.data.sort(function(t,e){return e.weight-t.weight});for(var n=0;a.length<r.clubdata_maximum_nodes-1;){for(i=0;i<t.length;i++)r.data[n].name.toUpperCase()===t[i].toUpperCase()&&n++;a.push(r.data[n]),n++}var o=0;for(j=n;j<r.data.length;j++){for(i=0;i<a.length&&j<r.data.length;i++)r.data[j].name.toUpperCase()===a[i].name.toUpperCase()&&(o+=0,j++,i=-1);j<r.data.length&&(o+=r.data[j].weight)}for(var l=function(t,e){return e.weight-t.weight};a.length>r.clubdata_maximum_nodes;){a.sort(l);a.pop()}var s={name:r.clubdata_text,weight:o,tooltip:r.clubdata_tooltip};a.sort(function(t,e){return e.weight-t.weight}),a.length<r.clubdata_maximum_nodes&&a.push(s),r.new_data=a}else r.data.sort(function(t,e){return e.weight-t.weight}),r.new_data=r.data;return r.new_data},ticks:function(){function t(){n.text(function(t){return t.data.name}).text(function(t,e){return r.ticks_text_width[e]=this.getBBox().width,r.ticks_text_height=this.getBBox().height,t.data.name}).attr({"text-anchor":function(t){var e=(t.endAngle-t.startAngle)/2+t.startAngle;return e>0&&2>e?"start":e>=1.5&&3.5>e?"middle":e>=3.5&&6>e?"end":e>=6?"middle":"election pie"===a||"election donut"===a&&-1>e?"end":0>e?"middle":void 0},dy:5,"pointer-events":"none"}).style({fill:r.pointer_color,"font-size":r.pointer_size+"px","font-weight":r.pointer_weight,"font-family":r.pointer_family}),n.exit().remove()}function e(){l.attr({x2:function(t,e){return 1*(r.outer_radius/1+12)*Math.cos((t.startAngle+t.endAngle)/2)},y2:function(t,e){return 1*(r.outer_radius/1+12)*Math.sin((t.startAngle+t.endAngle)/2)},transform:"rotate(-90)","stroke-width":r.pointer_thickness+"px",stroke:r.pointer_color}),l.exit().remove()}PykCharts["boolean"](r.pointer_overflow_enable)&&r.svgContainer.style("overflow","visible");r.ticks_text_width=[];var n=r.group.selectAll(".ticks_label").data(r.pie(r.new_data));n.attr("class","ticks_label"),n.enter().append("text").attr({x:0,y:0});var o,i;n.attr("transform",function(t){return t.endAngle-t.startAngle<.2?(o=1*(r.outer_radius+30)*Math.cos((t.startAngle+t.endAngle-Math.PI)/2),i=1*(r.outer_radius/1+20)*Math.sin((t.startAngle+t.endAngle-Math.PI)/2)):(o=1*(r.outer_radius+22)*Math.cos((t.startAngle+t.endAngle-Math.PI)/2),i=1*(r.outer_radius/1+24)*Math.sin((t.startAngle+t.endAngle-Math.PI)/2)),"translate("+o+","+i+")"}),n.text(""),setTimeout(t,r.transitions.duration());var l=r.group.selectAll("line").data(r.pie(r.new_data));return l.enter().append("line").attr("class","ticks"),l.attr({x1:function(t,e){return 1*r.outer_radius*Math.cos((t.startAngle+t.endAngle)/2)},y1:function(t,e){return 1*r.outer_radius*Math.sin((t.endAngle+t.startAngle)/2)},x2:function(t,e){return 1*r.outer_radius*Math.cos((t.startAngle+t.endAngle)/2)},y2:function(t,e){return 1*r.outer_radius*Math.sin((t.endAngle+t.startAngle)/2)}}),setTimeout(e,r.transitions.duration()),this},centerLabel:function(){function t(){n.text(function(t){return r.k.appendUnits(r.sum)}).text(function(t){return e=this.getBBox().height,r.k.appendUnits(r.sum)}).attr({"pointer-events":"none","text-anchor":"middle",y:function(){return"donut"===a?e/2:-.25*r.inner_radius},fill:r.show_total_at_center_color}).style({"font-family":r.show_total_at_center_family,"font-weight":r.show_total_at_center_weight,"font-size":r.show_total_at_center_size+"px"})}if(PykCharts["boolean"](r.show_total_at_center)&&("donut"===a||"election donut"===a)){var e,n=r.group.selectAll(r.selector+" .centerLabel").data([r.sum]);n.enter().append("text"),n.attr("class","centerLabel").text(""),setTimeout(t,r.transitions.duration()),n.exit().remove()}return this},set_start_end_angle:function(){return r.startAngle,r.endAngle,"pie"===a||"donut"===a?(r.start_angle=0*(Math.PI/180),r.end_angle=360*(Math.PI/180)):("election pie"===a||"election donut"===a)&&(r.start_angle=-90*(Math.PI/180),r.end_angle=90*(Math.PI/180)),this}};return e}},PykCharts.oneD.pyramid=function(t){var e=this;e.interval="";new PykCharts.Configuration.Theme({});this.execute=function(a){e=new PykCharts.validation.processInputs(e,t,"oneDimensionalCharts"),e.chart_height=t.chart_height?t.chart_height:e.chart_width,e.k.validator().validatingDataType(e.chart_height,"chart_height",e.chart_width),e.stop||(e.k.storeInitialDivHeight(),"default"===e.mode&&e.k.loading(),e.executeData=function(t){var a=e.k.validator().validatingJSON(t),r=e.selector.substring(1,e.selector.length);return e.stop||a===!1?void e.k.remove_loading_bar(r):(e.data=e.k.__proto__._groupBy("oned",t),e.data_length=e.data.length,e.compare_data=e.k.__proto__._groupBy("oned",t),e.k.remove_loading_bar(r),e.clubdata_enable=e.data_length>e.clubdata_maximum_nodes?e.clubdata_enable:"no",void e.render())},PykCharts["boolean"](e.interactive_enable)?(e.k.dataFromPykQuery(a),e.k.dataSourceFormatIdentification(e.data,e,"executeData")):e.k.dataSourceFormatIdentification(t.data,e,"executeData"))},this.refresh=function(a){e.executeRefresh=function(t){e.data=e.k.__proto__._groupBy("oned",t),e.data_length=e.data.length,e.clubdata_enable=e.data_length>e.clubdata_maximum_nodes?e.clubdata_enable:"no",e.refresh_data=e.k.__proto__._groupBy("oned",t);var a=e.k.checkChangeInData(e.refresh_data,e.compare_data);e.compare_data=a[0];var r=a[1];r&&e.k.lastUpdatedAt("liveData"),e.new_data=e.optionalFeatures().clubData(),"shade"===e.color_mode&&(shade_array=e.k.shadeColorConversion(e.shade_color,e.new_data.length),shade_array.reverse(),e.new_data.forEach(function(t,e){t.color=shade_array[e]})),e.optionalFeatures().createChart().label().ticks()},PykCharts["boolean"](e.interactive_enable)?(e.k.dataFromPykQuery(a),e.k.dataSourceFormatIdentification(e.data,e,"executeRefresh")):e.k.dataSourceFormatIdentification(t.data,e,"executeRefresh")},this.render=function(){var t=e.selector.substring(1,e.selector.length),a=t+"_svg";e.fillChart=new PykCharts.Configuration.fillChart(e),e.transitions=new PykCharts.Configuration.transition(e),"default"===e.mode?(e.k.title().backgroundColor(e)["export"](e,"#"+a,"pyramid").emptyDiv(e.selector).subtitle(),e.new_data=e.optionalFeatures().clubData(),"shade"===e.color_mode&&(shade_array=e.k.shadeColorConversion(e.shade_color,e.new_data.length),shade_array.reverse(),e.new_data.forEach(function(t,e){t.color=shade_array[e]})),e.optionalFeatures().svgContainer(a).createChart().label().ticks(),e.k.createFooter().lastUpdatedAt().credits().dataSource().tooltip().liveData(e),e.mouseEvent=new PykCharts.Configuration.mouseEvent(e)):"infographics"===e.mode&&(e.new_data=e.data,"shade"===e.color_mode&&(shade_array=e.k.shadeColorConversion(e.shade_color,e.new_data.length),shade_array.reverse(),e.new_data.forEach(function(t,e){t.color=shade_array[e]})),e.k.backgroundColor(e)["export"](e,"#"+a,"pyramid").emptyDiv(e.selector),e.optionalFeatures().svgContainer(a).createChart().label().ticks(),e.k.tooltip(),e.mouseEvent=new PykCharts.Configuration.mouseEvent(e));var r=0;setTimeout(function(){e.ticks_text_width.length&&(r=d3.max(e.ticks_text_width,function(t){return t})),e.k.exportSVG(e,"#"+a,"pyramid",void 0,void 0,r)},e.transitions.duration());var n=e.k.resize(e.svgContainer);e.k.__proto__._ready(n),window.addEventListener("resize",function(t){return e.k.resize(e.svgContainer)})},this.percentageValues=function(t){e.sum=d3.sum(t,function(t){return t.weight});var a=t.map(function(t){return t.weight/e.sum*100});return a.sort(function(t,e){return e-t}),a},this.pyramidLayout=function(){var t,a,r={data:function(e){return 0!==e.length&&(t=e),this},size:function(t){return 2===t.length&&(a=t),this},coordinates:function(r){function n(t){return d3.sum(s,function(e,a){return a>=t?e:void 0})}for(var o=a[0],i=a[1],l=o/2/i,s=e.percentageValues(t),_=[],c=o*i/2,d=0,u=t.length;u>d;d++){var h=n(d),p=h/100*c,g=Math.sqrt(p/l),m=2*l*g,f=(o-m)/2;0===d?_[d]={values:[{x:o/2,y:0},{x:f,y:g},{x:m+f,y:g}]}:_[d]={values:[_[d-1].values[1],{x:f,y:g},{x:m+f,y:g},_[d-1].values[2]]}}return _}};return r},this.optionalFeatures=function(){var a={svgContainer:function(t){return e.svgContainer=d3.select(e.selector).append("svg").attr({width:e.chart_width,height:e.chart_height,preserveAspectRatio:"xMinYMin",viewBox:"0 0 "+e.chart_width+" "+e.chart_height,id:t,"class":"svgcontainer PykCharts-oneD"}),e.group=e.svgContainer.append("g").attr("id","pyrgrp"),this},createChart:function(){var t=new PykCharts.Configuration.border(e);e.pyramid=e.pyramidLayout().data(e.new_data).size([e.chart_width,e.chart_height]),e.coordinates=e.pyramid.coordinates(),e.coordinates[0].values[1]=e.coordinates[e.coordinates.length-1].values[1],e.coordinates[0].values[2]=e.coordinates[e.coordinates.length-1].values[2];for(var a=e.new_data.length-1,r=(e.new_data.length-1,[]),n=0,o=e.new_data.length;o>n;n++)0==n?r[n]=e.new_data[n].tooltip||"<table class='PykCharts'><tr><th colspan='2'  class='tooltip-heading'>"+e.new_data[n].name+"</tr><tr><td class='tooltip-left-content'>"+e.k.appendUnits(e.new_data[n].weight)+"<td class='tooltip-right-content'>("+(100*e.new_data[n].weight/e.sum).toFixed(1)+"%) </tr></table>":(r[n]=e.new_data[a].tooltip||"<table class='PykCharts'><tr><th colspan='2'  class='tooltip-heading'>"+e.new_data[a].name+"</tr><tr><td class='tooltip-left-content'>"+e.k.appendUnits(e.new_data[a].weight)+"<td class='tooltip-right-content'>("+(100*e.new_data[a].weight/e.sum).toFixed(1)+"%) </tr></table>",a--);var i,l=d3.svg.line().interpolate("linear-closed").x(function(t,e){return t.x}).y(function(t,e){return t.y}),s=[{x:0,y:e.chart_height},{x:e.chart_width,y:e.chart_height},{x:0,y:e.chart_height},{x:e.chart_width,y:e.chart_height},{x:0,y:e.chart_height},{x:e.chart_width,y:e.chart_height}],a=e.new_data.length;return e.chart_data=e.group.selectAll(".pyr-path").data(e.coordinates),e.chart_data.enter().append("path"),e.chart_data.attr({"class":"pyr-path",d:function(t){return l(s)},stroke:t.color(),"stroke-width":t.width(),"stroke-dasharray":t.style(),fill:function(t,r){return 0===r?(i=e.new_data[r],t.color=e.new_data[r].color):(a--,i=e.new_data[a],t.color=e.new_data[a].color),e.fillChart.selectColor(i)},"fill-opacity":1,"data-fill-opacity":function(){return d3.select(this).attr("fill-opacity")},"data-id":function(t,a){return e.new_data[a].name}}).on({mouseover:function(t,a){"default"===e.mode&&(PykCharts["boolean"](e.chart_onhover_highlight_enable)&&e.mouseEvent.highlight(e.selector+" .pyr-path",this),e.mouseEvent.tooltipPosition(t),e.mouseEvent.tooltipTextShow(r[a]))},mouseout:function(t){"default"===e.mode&&(PykCharts["boolean"](e.chart_onhover_highlight_enable)&&e.mouseEvent.highlightHide(e.selector+" .pyr-path"),e.mouseEvent.tooltipHide(t))},mousemove:function(t,a){"default"===e.mode&&e.mouseEvent.tooltipPosition(t)},click:function(t,a){PykCharts["boolean"](e.click_enable)&&e.addEvents(e.new_data[a].name,d3.select(this).attr("data-id"))}}).transition().duration(e.transitions.duration()).attr("d",function(t){return l(t.values)}),e.chart_data.exit().remove(),this},label:function(){function a(){e.chart_text.text(function(t,a){return 0===a?(100*e.new_data[a].weight/e.sum).toFixed(1)+"%":(r--,(100*e.new_data[r].weight/e.sum).toFixed(1)+"%")}).text(function(t,a){return this.getBBox().width<t.values[2].x-t.values[1].x&&this.getBBox().height<Math.abs(t.values[1].y-t.values[0].y)?0===a?(100*e.new_data[a].weight/e.sum).toFixed(1)+"%":(n--,(100*e.new_data[n].weight/e.sum).toFixed(1)+"%"):""})}var r=e.new_data.length,n=e.new_data.length;return e.chart_text=e.group.selectAll("text").data(e.coordinates),e.chart_text.enter().append("text"),e.chart_text.attr({"text-anchor":"middle","pointer-events":"none",fill:function(a){if("shade"===e.color_mode&&!t.label_color){var r=e.k.__proto__._colourBrightness(a.color);return"light"===r?"black":"white"}return e.label_color},y:function(t,a){return 4===t.values.length?(t.values[0].y-t.values[1].y)/2+t.values[1].y+5:(t.values[0].y+e.coordinates[e.coordinates.length-1].values[1].y)/2+10},x:function(t,a){return e.chart_width/2}}).text("").style({"font-weight":e.label_weight,"font-size":e.label_size+"px","font-family":e.label_family}),setTimeout(a,e.transitions.duration()),e.chart_text.exit().remove(),this},ticks:function(){function t(){r.text(function(t,a){return 0===a?e.new_data[a].name:(s--,e.new_data[s].name)}).text(function(t,a){return 0===a?(i[a]=this.getBBox().height,e.ticks_text_width[a]=this.getBBox().width,this.getBBox().height<t.values[1].y-t.values[0].y?e.new_data[a].name:""):(i[a]=this.getBBox().height,this.getBBox().height<t.values[0].y-t.values[1].y?(l--,e.new_data[l].name):"")}).style({fill:e.pointer_color,"font-size":e.pointer_size+"px","font-family":e.pointer_family,"font-weight":e.pointer_weight}).attr("text-anchor","start")}function a(){_.attr("x2",function(t,a){return Math.abs(t.values[0].y-t.values[1].y)>i[a]?3===t.values.length?(t.values[0].x+e.coordinates[e.coordinates.length-1].values[2].x)/2+12:(t.values[2].x+t.values[3].x)/2+12:3===t.values.length?(t.values[0].x+e.coordinates[e.coordinates.length-1].values[2].x)/2:(t.values[2].x+t.values[3].x)/2})}PykCharts["boolean"](e.pointer_overflow_enable)&&e.svgContainer.style("overflow","visible");var r=e.group.selectAll(".ticks_label").data(e.coordinates);r.enter().append("text").attr({x:0,y:0,"class":"ticks_label"});var n,o,i=[];e.ticks_text_width=[];var l=e.new_data.length,s=e.new_data.length;r.attr("transform",function(t){return n=3===t.values.length?(t.values[0].x+e.coordinates[e.coordinates.length-1].values[2].x)/2+17:(t.values[2].x+t.values[3].x)/2+17,o=4===t.values.length?(t.values[0].y-t.values[1].y)/2+t.values[1].y+2:(t.values[0].y+e.coordinates[e.coordinates.length-1].values[1].y)/2,"translate("+n+","+(o+5)+")"}),r.text(""),setTimeout(t,e.transitions.duration()),r.exit().remove();var _=e.group.selectAll(".pyr-ticks").data(e.coordinates);return _.enter().append("line").attr("class","pyr-ticks"),_.attr({x1:function(t,a){return 3===t.values.length?(t.values[0].x+e.coordinates[e.coordinates.length-1].values[2].x)/2:(t.values[2].x+t.values[3].x)/2},y1:function(t,a){return 4===t.values.length?(t.values[0].y-t.values[1].y)/2+t.values[1].y+2:(t.values[0].y+e.coordinates[e.coordinates.length-1].values[1].y)/2},x2:function(t,a){return 3===t.values.length?(t.values[0].x+e.coordinates[e.coordinates.length-1].values[2].x)/2:(t.values[2].x+t.values[3].x)/2},y2:function(t,a){return 4===t.values.length?(t.values[0].y-t.values[1].y)/2+t.values[1].y+2:(t.values[0].y+e.coordinates[e.coordinates.length-1].values[1].y)/2},"stroke-width":e.pointer_thickness+"px",stroke:e.pointer_color}),setTimeout(a,e.transitions.duration()),_.exit().remove(),this},clubData:function(){if(PykCharts["boolean"](e.clubdata_enable)){var t=[];if(0!==e.clubdata_always_include_data_points.length){var a=e.clubdata_always_include_data_points.length;for(i=0;i<a;i++)t[i]=e.clubdata_always_include_data_points[i]}var r=[];for(i=0;i<t.length;i++)for(j=0;j<e.data.length;j++)t[i].toUpperCase()===e.data[j].name.toUpperCase()&&r.push(e.data[j]);e.data.sort(function(t,e){return e.weight-t.weight});for(var n=0;r.length<e.clubdata_maximum_nodes-1;){for(i=0;i<t.length;i++)e.data[n].name.toUpperCase()===t[i].toUpperCase()&&n++;r.push(e.data[n]),n++}var o=0;for(j=n;j<e.data.length;j++){for(i=0;i<r.length&&j<e.data.length;i++)e.data[j].name.toUpperCase()===r[i].name.toUpperCase()&&(o+=0,j++,i=-1);j<e.data.length&&(o+=e.data[j].weight)}for(var l=function(t,e){return e.weight-t.weight};r.length>e.clubdata_maximum_nodes;){r.sort(l);r.pop()}var s={name:e.clubdata_text,weight:o,tooltip:e.clubdata_tooltip};r.sort(function(t,e){return t.weight-e.weight}),r.length<e.clubdata_maximum_nodes&&r.push(s),e.new_data=r}else e.data.sort(function(t,e){return t.weight-e.weight}),e.new_data=e.data;return e.new_data}};return a}},PykCharts.oneD.treemap=function(t){var e=this;e.interval="";new PykCharts.Configuration.Theme({});this.execute=function(a){e=new PykCharts.validation.processInputs(e,t,"oneDimensionalCharts"),optional=t.optional,e.chart_height=t.chart_height?t.chart_height:e.chart_width,e.k.validator().validatingDataType(e.chart_height,"chart_height",e.chart_width),e.stop||(e.k.storeInitialDivHeight(),"default"===e.mode&&e.k.loading(),e.executeData=function(t){var a=e.k.validator().validatingJSON(t),r=e.selector.substring(1,e.selector.length);return e.stop||a===!1?void e.k.remove_loading_bar(r):(e.data=e.k.__proto__._groupBy("oned",t),e.compare_data=e.k.__proto__._groupBy("oned",t),e.k.remove_loading_bar(r),e.clubdata_enable=e.data.length>e.clubdata_maximum_nodes?e.clubdata_enable:"no",void e.render())},PykCharts["boolean"](e.interactive_enable)?(e.k.dataFromPykQuery(a),e.k.dataSourceFormatIdentification(e.data,e,"executeData")):e.k.dataSourceFormatIdentification(t.data,e,"executeData"))},this.refresh=function(a){e.executeRefresh=function(t){e.data=e.k.__proto__._groupBy("oned",t),e.clubdata_enable=e.data.length>e.clubdata_maximum_nodes?e.clubdata_enable:"no",e.refresh_data=e.k.__proto__._groupBy("oned",t);var a=e.k.checkChangeInData(e.refresh_data,e.compare_data);e.compare_data=a[0];var r=a[1];r&&e.k.lastUpdatedAt("liveData"),e.optionalFeatures().clubData(),"shade"===e.color_mode&&(shade_array=e.k.shadeColorConversion(e.shade_color,e.new_data.children.length),e.new_data.children.forEach(function(t,e){t.color=shade_array[e]})),e.optionalFeatures().createChart().label()},PykCharts["boolean"](e.interactive_enable)?(e.k.dataFromPykQuery(a),e.k.dataSourceFormatIdentification(e.data,e,"executeRefresh")):e.k.dataSourceFormatIdentification(t.data,e,"executeRefresh")},this.render=function(){var t=e.selector.substring(1,e.selector.length),a=t+"_svg";e.fillChart=new PykCharts.Configuration.fillChart(e),e.transitions=new PykCharts.Configuration.transition(e),"default"===e.mode&&e.k.title().backgroundColor(e)["export"](e,"#"+a,"treemap").emptyDiv(e.selector).subtitle(),e.k.tooltip(),e.mouseEvent=new PykCharts.Configuration.mouseEvent(e),"infographics"===e.mode&&(e.k.backgroundColor(e)["export"](e,"#"+a,"treemap").emptyDiv(e.selector),e.new_data={children:e.data}),"default"===e.mode&&e.optionalFeatures().clubData(),"shade"===e.color_mode&&(shade_array=e.k.shadeColorConversion(e.shade_color,e.new_data.children.length),e.new_data.children.forEach(function(t,e){t.color=shade_array[e]})),e.optionalFeatures().svgContainer(a).createChart().label(),"default"===e.mode&&e.k.liveData(e).createFooter().lastUpdatedAt().credits().dataSource(),e.k.exportSVG(e,"#"+a,"treemap");var r=e.k.resize(e.svgContainer);e.k.__proto__._ready(r),window.addEventListener("resize",function(t){return e.k.resize(e.svgContainer)})},this.optionalFeatures=function(){var a={svgContainer:function(t){return e.svgContainer=d3.select(e.selector).append("svg:svg").attr({width:e.chart_width,height:e.chart_height,preserveAspectRatio:"xMinYMin",viewBox:"0 0 "+e.chart_width+" "+e.chart_height,id:t,"class":"svgcontainer PykCharts-oneD"}),e.group=e.svgContainer.append("g").attr("id","treemap"),this},createChart:function(){e.treemap=d3.layout.treemap().sort(function(t,e){return t.weight-e.weight}).size([e.chart_width,e.chart_height]).value(function(t){return t.weight}).sticky(!1),e.sum=d3.sum(e.new_data.children,function(t){return t.weight});var t;return e.node=e.treemap.nodes(e.new_data),t=e.new_data.children.length,e.chart_data=e.group.selectAll(".cell").data(e.node),e.chart_data.enter().append("svg:g").attr("class","cell").append("svg:rect").attr("class","treemap-rect"),e.chart_data.attr("class","cell").select("rect").attr({"class":"treemap-rect",id:function(t,e){return"rect"+e},x:function(t){return t.x},y:function(t){return t.y},width:function(t){return t.dx-1},height:0,fill:function(t){return t.children?"white":e.fillChart.selectColor(t)},"fill-opacity":1,"data-fill-opacity":function(){return d3.select(this).attr("fill-opacity")},"data-id":function(t,e){return t.name}}).on({mouseover:function(t){t.children||"default"!==e.mode||(t.tooltip=t.tooltip||"<table class='PykCharts'><tr><th colspan='2' class='tooltip-heading'>"+t.name+"</tr><tr><td class='tooltip-left-content'>"+e.k.appendUnits(t.weight)+"<td class='tooltip-right-content'>("+(100*t.weight/e.sum).toFixed(1)+"%)</tr></table>",PykCharts["boolean"](e.chart_onhover_highlight_enable)&&e.mouseEvent.highlight(e.selector+" .treemap-rect",this),e.mouseEvent.tooltipPosition(t),e.mouseEvent.tooltipTextShow(t.tooltip))},mouseout:function(t){"default"===e.mode&&(e.mouseEvent.tooltipHide(t),PykCharts["boolean"](e.chart_onhover_highlight_enable)&&e.mouseEvent.highlightHide(e.selector+" .treemap-rect"))},mousemove:function(t){t.children||"default"!==e.mode||e.mouseEvent.tooltipPosition(t)},click:function(t,a){PykCharts["boolean"](e.click_enable)&&e.addEvents(t.name,d3.select(this).attr("data-id"))}}).transition().duration(e.transitions.duration()).attr("height",function(t){return t.dy-1}),e.chart_data.exit().remove(),this},label:function(){function a(){e.chart_text.text(function(t){return t.children?" ":t.name}).attr("pointer-events","none").text(function(t){return this.getBBox().width<t.dx&&this.getBBox().height<t.dy-15?t.children?" ":t.name:""})}function r(){e.chart_text1.text(function(t){return t.children?" ":e.k.appendUnits(t.weight)}).text(function(t){return this.getBBox().width<t.dx&&this.getBBox().height<t.dy-15?t.children?" ":(100*t.weight/e.sum).toFixed(1)+"%":""})}return e.chart_text=e.group.selectAll(".name").data(e.node),e.chart_text1=e.group.selectAll(".weight").data(e.node),e.chart_text.enter().append("svg:text").attr("class","name"),e.chart_text1.enter().append("svg:text").attr("class","weight"),e.chart_text.attr({"class":"name",x:function(t){return t.x+t.dx/2},y:function(t){return t.y+t.dy/2}}),e.chart_text1.attr({"class":"weight",x:function(t){return t.x+t.dx/2},y:function(t){return t.y+t.dy/2+e.label_size}}),e.chart_text.attr({"text-anchor":"middle",fill:function(a){if("shade"===e.color_mode&&!a.children&&!t.label_color){var r=e.k.__proto__._colourBrightness(a.color);return"light"===r?"black":"white"}return e.label_color}}).style({"font-weight":e.label_weight,"font-size":e.label_size+"px","font-family":e.label_family}).text(""),setTimeout(a,e.transitions.duration()),e.chart_text1.attr({"text-anchor":"middle",fill:function(a){if("shade"===e.color_mode&&!a.children&&!t.label_color){var r=e.k.__proto__._colourBrightness(a.color);return"light"===r?"black":"white"}return e.label_color},"pointer-events":"none"}).style({"font-weight":e.label_weight,"font-size":e.label_size+"px","font-family":e.label_family}).text(""),setTimeout(r,e.transitions.duration()),e.chart_text.exit().remove(),e.chart_text1.exit().remove(),this},clubData:function(){if(PykCharts["boolean"](e.clubdata_enable)){var t=[],a=0,r=0;if(e.data.length<=e.clubdata_maximum_nodes)return e.new_data={children:e.data},this;if(0!==e.clubdata_always_include_data_points.length){var n=e.clubdata_always_include_data_points.length;for(i=0;i<n;i++)t[i]=e.clubdata_always_include_data_points[i]}var o=[];for(i=0;i<t.length;i++)for(j=0;j<e.data.length;j++)t[i].toUpperCase()===e.data[j].name.toUpperCase()&&o.push(e.data[j]);for(e.data.sort(function(t,e){return e.weight-t.weight});o.length<e.clubdata_maximum_nodes-1;){for(i=0;i<t.length;i++)e.data[r].name.toUpperCase()===t[i].toUpperCase()&&r++;o.push(e.data[r]),r++}for(j=r;j<e.data.length;j++){for(i=0;i<o.length&&j<e.data.length;i++)e.data[j].name.toUpperCase()===o[i].name.toUpperCase()&&(a+=0,j++,i=-1);j<e.data.length&&(a+=e.data[j].weight)}for(var l=function(t,e){return e.weight-t.weight};o.length>e.clubdata_maximum_nodes;){o.sort(l);o.pop()}var s={name:e.clubdata_text,weight:a,color:e.clubData_color,tooltip:e.clubData_tooltip};o.length<e.clubdata_maximum_nodes&&o.push(s),e.new_data={children:o}}else e.new_data={children:e.data};return this}};return a}},PykCharts.other.pictograph=function(t){var e=this;e.interval="";var a=new PykCharts.Configuration.Theme({});this.execute=function(){e=new PykCharts.validation.processInputs(e,t,"other");var r=(t.optional,a.otherCharts);e.pictograph_show_all_images=t.pictograph_show_all_images?t.pictograph_show_all_images.toLowerCase():r.pictograph_show_all_images,e.pictograph_total_count_enable=t.pictograph_total_count_enable?t.pictograph_total_count_enable.toLowerCase():r.pictograph_total_count_enable,e.pictograph_current_count_enable=t.pictograph_current_count_enable?t.pictograph_current_count_enable.toLowerCase():r.pictograph_current_count_enable,e.pictograph_image_per_line=t.pictograph_image_per_line?t.pictograph_image_per_line:r.pictograph_image_per_line,e.pictograph_current_count_size=t.pictograph_current_count_size?t.pictograph_current_count_size:r.pictograph_current_count_size,e.pictograph_current_count_color=t.pictograph_current_count_color?t.pictograph_current_count_color:r.pictograph_current_count_color,e.pictograph_current_count_weight=t.pictograph_current_count_weight?t.pictograph_current_count_weight.toLowerCase():r.pictograph_current_count_weight,e.pictograph_current_count_family=t.pictograph_current_count_family?t.pictograph_current_count_family.toLowerCase():r.pictograph_current_count_family,e.pictograph_total_count_size=t.pictograph_total_count_size?t.pictograph_total_count_size:r.pictograph_total_count_size,e.pictograph_total_count_color=t.pictograph_total_count_color?t.pictograph_total_count_color:r.pictograph_total_count_color,e.pictograph_total_count_weight=t.pictograph_total_count_weight?t.pictograph_total_count_weight.toLowerCase():r.pictograph_total_count_weight,e.pictograph_total_count_family=t.pictograph_total_count_family?t.pictograph_total_count_family.toLowerCase():r.pictograph_total_count_family,e.pictograph_image_width=t.pictograph_image_width?t.pictograph_image_width:r.pictograph_image_width,e.pictograph_image_height=t.pictograph_image_height?t.pictograph_image_height:r.pictograph_image_height,e.pictograph_units_per_image=t.pictograph_units_per_image?t.pictograph_units_per_image:"",e.pictograph_units_per_image_text_family=t.pictograph_units_per_image_text_family?t.pictograph_units_per_image_text_family.toLowerCase():r.pictograph_units_per_image_text_family,e.pictograph_units_per_image_text_size=t.pictograph_units_per_image_text_size?t.pictograph_units_per_image_text_size:r.pictograph_units_per_image_text_size,e.pictograph_units_per_image_text_color=t.pictograph_units_per_image_text_color?t.pictograph_units_per_image_text_color:r.pictograph_units_per_image_text_color,
e.pictograph_units_per_image_text_weight=t.pictograph_units_per_image_text_weight?t.pictograph_units_per_image_text_weight.toLowerCase():r.pictograph_units_per_image_text_weight,e.chart_height=t.chart_height?t.chart_height:e.chart_width,e.k.validator().validatingDataType(e.chart_height,"chart_height",e.chart_width).validatingDataType(e.pictograph_units_per_image_text_size,"pictograph_units_per_image_text_size",r.pictograph_units_per_image_text_size).validatingDataType(e.pictograph_current_count_size,"pictograph_current_count_size",r.pictograph_current_count_size).validatingDataType(e.pictograph_total_count_size,"pictograph_total_count_size",r.pictograph_total_count_size).validatingDataType(e.pictograph_image_width,"pictograph_image_width",r.pictograph_image_width).validatingDataType(e.pictograph_image_height,"pictograph_image_height",r.pictograph_image_height).validatingDataType(e.pictograph_image_per_line,"pictograph_image_per_line",r.pictograph_image_per_line).validatingFontWeight(e.pictograph_current_count_weight,"pictograph_current_count_weight",r.pictograph_current_count_weight).validatingFontWeight(e.pictograph_total_count_weight,"pictograph_total_count_weight",r.pictograph_total_count_weight).validatingFontWeight(e.pictograph_units_per_image_text_weight,"pictograph_units_per_image_text_weight",r.pictograph_units_per_image_text_weight).validatingColor(e.pictograph_current_count_color,"pictograph_current_count_color",r.pictograph_current_count_color).validatingColor(e.pictograph_total_count_color,"pictograph_total_count_color",r.pictograph_total_count_color).validatingColor(e.pictograph_units_per_image_text_color,"pictograph_units_per_image_text_color",r.pictograph_units_per_image_text_color),e.stop||(e.k.storeInitialDivHeight(),"default"===e.mode&&e.k.loading(),e.executeData=function(t){var a=e.k.validator().validatingJSON(t),r=e.selector.substring(1,e.selector.length);return e.stop||a===!1?void e.k.remove_loading_bar(r):(e.data=t.sort(function(t,e){return e.weight-t.weight}),e.old_weight=0,e.compare_data=e.data,e.k.remove_loading_bar(r),void e.render())},e.k.dataSourceFormatIdentification(t.data,e,"executeData"))},this.refresh=function(){e.executeRefresh=function(t){e.old_data=e.data,e.old_weight=e.weight;var a=e.k.validator().validatingJSON(t);if(!e.stop&&a!==!1){e.data=t.sort(function(t,e){return e.weight-t.weight}),e.refresh_data=e.data;var r=e.k.checkChangeInData(e.refresh_data,e.compare_data);e.compare_data=r[0];var n=r[1];n&&e.k.lastUpdatedAt("liveData"),e.optionalFeatures().labelText().enableLabel().createChart()}},e.k.dataSourceFormatIdentification(t.data,e,"executeRefresh")},this.render=function(){var t=e.selector.substring(1,e.selector.length),a=t+"_svg";e.transitions=new PykCharts.Configuration.transition(e),"default"===e.mode?e.k.title().backgroundColor(e)["export"](e,"#"+a,"pictograph").emptyDiv().subtitle().liveData(e):e.k.backgroundColor(e)["export"](e,"#"+a,"pictograph").emptyDiv(),e.optionalFeatures().svgContainer(a).labelText().enableLabel(),PykCharts["boolean"](e.pictograph_units_per_image)&&e.optionalFeatures().appendUnits(),e.optionalFeatures().createChart(),"default"===e.mode&&e.k.createFooter().lastUpdatedAt().credits().dataSource(),e.k.exportSVG(e,"#"+a,"pictograph");var r=e.k.resize(e.svgContainer);e.k.__proto__._ready(r),window.addEventListener("resize",function(t){return e.k.resize(e.svgContainer)})},this.optionalFeatures=function(){var t={svgContainer:function(t){return e.svgContainer=d3.select(e.selector).append("svg").attr({width:e.chart_width,id:t,"class":"svgcontainer",preserveAspectRatio:"xMinYMin",viewBox:"0 0 "+e.chart_width+" "+e.chart_height}),e.group=e.svgContainer.append("g").attr("id","pictograph_image_group"),e.group1=e.svgContainer.append("g").attr("transform","translate(0,0)"),PykCharts["boolean"](e.pictograph_units_per_image)&&(e.group2=e.svgContainer.append("g").attr("id","units-per-image")),this},createChart:function(){var t=0,a=0;e.optionalFeatures().showTotal();var r=0;e.textWidth||(e.textWidth=0),e.totalTxtWeight||(e.totalTxtWeight=0);var n=e.textWidth+e.totalTxtWeight+25;e.total_unit_width>n&&(n=e.total_unit_width+10),e.group.attr("transform","translate("+n+",0)");for(var o=1;o<=e.weight;o++){o<=e.data[1].weight?(!e.old_data||e.old_data&&o>e.old_data[1].weight)&&(e.group.append("image").attr({"xlink:href":e.data[1].image,id:"current_image"+o,x:a*(e.pictograph_image_width+1),y:t*(e.pictograph_image_height+10),width:0,height:e.pictograph_image_height+"px"}).transition().duration(e.transitions.duration()).attr("width",e.pictograph_image_width+"px"),setTimeout(function(){var t=d3.selectAll("#total_image"+o);t&&t.remove()},e.transitions.duration())):(o>e.old_weight&&e.weight>e.old_weight||e.old_data&&o<=e.old_data[1].weight)&&e.group.append("image").attr({"xlink:href":e.data[0].image,id:"total_image"+o,x:a*(e.pictograph_image_width+1),y:t*(e.pictograph_image_height+10),width:0,height:e.pictograph_image_height+"px"}).transition().duration(e.transitions.duration()).attr("width",e.pictograph_image_width+"px"),r++,a++,r>=e.pictograph_image_per_line&&(t++,a=0,r=0);var i=e.group.node().getBBox().height;o===+e.weight&&0!=i?(e.chart_height=i,e.svgContainer.attr({height:i,viewBox:"0 0 "+e.chart_width+" "+i})):e.svgContainer.attr({height:i,viewBox:"0 0 "+e.chart_width+" "+e.chart_height})}return setTimeout(function(){if(e.old_data&&e.old_data[1].weight>e.data[1].weight)for(var t=e.old_data[1].weight;t>e.data[1].weight;t--){var a=d3.selectAll("#current_image"+t);a&&a.remove()}if(e.old_data&&e.old_data[0].weight>e.data[0].weight)for(var t=e.old_data[0].weight;t>e.data[0].weight;t--){var r=d3.selectAll("#total_image"+t);r&&r.remove()}},e.transitions.duration()),e.pictograph_image_width*e.pictograph_image_per_line+n>e.chart_width&&console.warn("%c[Warning - Pykih Charts] ","color: #F8C325;font-weight:bold;font-size:14px","Your Lable text size and image width exceeds the chart conatiner width"),this},showTotal:function(){return PykCharts["boolean"](e.pictograph_show_all_images)?e.weight=e.data[0].weight:e.weight=e.data[1].weight,this},enableLabel:function(){if(PykCharts["boolean"](e.pictograph_total_count_enable)){var t=d3.selectAll(e.selector+" .PykCharts-current-text");t.length>0&&t.remove(),e.textWidth||(e.textWidth=0);e.data[0].weight/e.pictograph_image_per_line;e.group1.append("text").attr({"class":"PykCharts-current-text","font-family":e.pictograph_total_count_family,"font-size":e.pictograph_total_count_size,"font-weight":e.pictograph_total_count_weight,fill:e.pictograph_total_count_color}).text("/"+e.data[0].weight).text(function(){return e.textHeight=this.getBBox().height,e.totalTxtWeight=this.getBBox().width,"/"+e.data[0].weight}).attr({x:e.textWidth+5,y:function(){return e.textHeight-10}})}return this},labelText:function(){if(PykCharts["boolean"](e.pictograph_current_count_enable)){var t=d3.selectAll(e.selector+" .PykCharts-total-text");t.length>0&&t.remove();e.data[0].weight/e.pictograph_image_per_line;e.group1.append("text").attr({x:0,"class":"PykCharts-total-text","font-family":e.pictograph_current_count_family,"font-size":e.pictograph_current_count_size,"font-weight":e.pictograph_current_count_weight,fill:e.pictograph_current_count_color}).text(e.data[1].weight).text(function(){return e.textHeight=this.getBBox().height,e.textWidth=this.getBBox().width,e.data[1].weight}).attr("y",function(){return e.textHeight-10})}return this},appendUnits:function(){e.textHeight||(e.textHeight=0);var t,a,r,n;return e.group2.attr("transform","translate(0,"+(e.textHeight+15)+")"),e.group2.append("text").attr({x:0,"class":"PykCharts-unit-text","font-family":e.pictograph_units_per_image_text_family,"font-size":e.pictograph_units_per_image_text_size,"font-weight":e.pictograph_units_per_image_text_weight,fill:e.pictograph_units_per_image_text_color}).text(function(){return"1 "}).text(function(){return n=this.getBBox().height,t=this.getBBox().width,"1 "}).attr({dy:0,y:n-5}),e.group2.append("image").attr({"xlink:href":e.data[1].image,id:"unit-image",x:t+2+"px",y:0,height:n+"px",width:n+"px"}),a=d3.select(e.selector+" #unit-image").attr("width"),e.group2.append("text").attr({x:function(){return parseFloat(a)+t+4},"class":"PykCharts-unit-text","font-family":e.pictograph_units_per_image_text_family,"font-size":e.pictograph_units_per_image_text_size,"font-weight":e.pictograph_units_per_image_text_weight,fill:e.pictograph_units_per_image_text_color}).text(function(){return"= "+e.pictograph_units_per_image}).text(function(){return r=this.getBBox().width,"= "+e.pictograph_units_per_image}).attr("y",function(){return n-5}),e.total_unit_width=t+parseFloat(a)+r+4,this}};return t}},PykCharts.multiD={};var theme=new PykCharts.Configuration.Theme({});PykCharts.multiD.configuration=function(t){var e=(new PykCharts.Configuration.fillChart(t),{opacity:function(e,a,r){if(PykCharts["boolean"](t.variable_circle_size_enable))return.8;var n=d3.scale.linear().domain(d3.extent(r,function(t){return t.weight})).range([.3,1]);return n(e?e:Math.min.apply(null,a))},legendsPosition:function(t,e,a,r,n){var o,i=0,l=0;if("vertical"===t.legends_display){t.legendsGroup.attr("height",30*a.length+20),t.legendsGroup_height=0,text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y",rect_parameter1value=13,rect_parameter2value=13,c=function(t,e){return 36},d=function(t,e){return 20};var s=function(t,e){return 24*e+12},_=function(t,e){return 24*e+23}}else if("horizontal"===t.legends_display){t.legendsGroup_height=50,temp_i=i,final_rect_x=0,final_text_x=0,legend_text_widths=[],sum_text_widths=0,temp_text=temp_rect=0,text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y";var c=function(t,e){return legend_text_widths[e]=this.getBBox().width,legend_start_x=16,final_text_x=0===e?legend_start_x:legend_start_x+temp_text,temp_text=temp_text+legend_text_widths[e]+30,final_text_x};_=30,rect_parameter1value=13,rect_parameter2value=13;var d=function(t,e){return final_rect_x=0===e?0:temp_rect,temp_rect=temp_rect+legend_text_widths[e]+30,final_rect_x};s=18}if("scatter"===e)if("yes"===t.panels_enable){var u=[];u.push(t.map_group_data[0][n]),o=t.legendsGroup.selectAll("rect").data(u),t.legends_text=t.legendsGroup.selectAll(".legends_text").data(u)}else o=t.legendsGroup.selectAll("rect").data(t.map_group_data[0]),t.legends_text=t.legendsGroup.selectAll(".legends_text").data(t.map_group_data[0]);else o=t.legendsGroup.selectAll(".legends-rect").data(a),t.legends_text=t.legendsGroup.selectAll(".legends_text").data(a);t.legends_text.enter().append("text"),t.legends_text.attr("class","legends_text").attr("pointer-events","none").text(function(t){switch(e){case"groupColumn":case"groupBar":return t;case"spiderWeb":case"scatter":return t.group;case"stackedArea":return t.name}}).attr("fill",t.legends_text_color).attr("font-family",t.legends_text_family).style("font-size",t.legends_text_size+"px").attr("font-weight",t.legends_text_weight).attr(text_parameter1,c).attr(text_parameter2,_),o.enter().append("rect"),o.attr("class","legends-rect").attr(rect_parameter1,rect_parameter1value).attr(rect_parameter2,rect_parameter2value).attr(rect_parameter3,d).attr(rect_parameter4,s).attr("fill",function(a,n){switch(e){case"groupColumn":case"groupBar":return"color"===t.color_mode?r[n]:t.saturation_color;case"spiderWeb":case"scatter":return t.fillChart.colorPieW(a);case"stackedArea":return t.fillColor.colorPieMS(a,t.type)}}).attr("fill-opacity",function(a,r){switch(e){case"groupColumn":case"groupBar":if("saturation"===t.color_mode)return(r+1)/t.no_of_groups;break;case"spiderWeb":return.6;case"scatter":return 1;case"stackedArea":if("saturation"===t.color_mode)return(r+1)/t.new_data.length}});var l,h=t.legendsGroup.node().getBBox().width;t.legendsGroup_width="vertical"===t.legends_display?h+20:0,l="scatter"===e?"vertical"===t.legends_display?t.w-t.legendsGroup_width:PykCharts["boolean"](t.panels_enable)?t.chart_margin_left:t.chart_width-h-20:"vertical"===t.legends_display?t.chart_width-t.legendsGroup_width:t.chart_width-h-20,h<t.chart_width&&t.legendsGroup.attr("transform","translate("+l+",10)"),t.legendsGroup.style("visibility","visible"),t.legends_text.exit().remove(),o.exit().remove()},mapGroup:function(e,a){for(var r=[],n={},o=[],i=[],l={},s=[],_=0,c=!0,d=!0,u=0;u<e.length;u++)o[u]=e[u].group;i=t.k.__proto__._unique(o);for(var u=0;u<i.length;u++)l[i[u]]=[];for(var h in l)for(var p=0;p<e.length;p++)h===e[p].group&&l[h].push(e[p]);for(var h in l)for(var u=0;u<l[h].length;u++)s.push(l[h][u]);if(e=s,e.forEach(function(e){e.group?c=!0:(c=!1,t.chart_color?(c=!1,e.color=t.chart_color[0]):e.color?(d=!1,e.color=e.color):(d=!1,e.color=t.default_color[0]))}),u=0,c){e.forEach(function(a){!n[a.group]&&a.color?(n[a.group]=a,0!==t.chart_color.length&&PykCharts["boolean"](t.chart_color[_])?a.color=t.chart_color[_]:a.color?a.color=a.color:a.color=t.default_color,u<e.length-2&&a.group!==e[u+1].group&&_++,r.push(a)):u<e.length-2&&a.group!==e[u+1].group&&_++,u++}),_=0,u=0,e.forEach(function(a){n[a.group]?u<e.length-2&&a.group!==e[u+1].group&&_++:(n[a.group]=a,0!==t.chart_color.length&&PykCharts["boolean"](t.chart_color[_])?a.color=t.chart_color[_]:a.color=t.default_color,u<e.length-2&&a.group!==e[u+1].group&&_++,r.push(a)),u++});var g=[];_=0,r.forEach(function(t){g.push(t)});for(var m=g.length,f=e.length,u=0;m>u;u++)for(var p=0;f>p;p++)e[p].group===g[u].group&&(e[p].color=g[u].color);return[g,c]}return[e,c]}});return e},PykCharts.multiD.bubbleSizeCalculation=function(t,e,a){var r=function(r){if(r&&PykCharts["boolean"](t.variable_circle_size_enable)){var n=d3.scale.linear().domain(d3.extent(e,function(t){return t.weight})).range(a);return n(r)}return t.bubbleRadius};return r},PykCharts.multiD.sortDataByGroup=function(t){return t.sort(function(t,e){return t.group<e.group?-1:t.group>e.group?1:void 0}),t},PykCharts.annotation=function(t){t.k.annotation=function(e,a,r,n){var o=t.legendsGroup_height?t.legendsGroup_height:0;if("onclick"===t.annotation_view_mode){var i=d3.select(e).selectAll(".PykCharts-annotation-circle").data(a),l=d3.select(e).selectAll(".PykCharts-annotation-text").data(a);i.enter().append("circle").attr("class","PykCharts-annotation-circle"),i.attr("r",0),setTimeout(function(){i.attr("cx",function(e,a){return parseInt(r(e.x))+t.extra_left_margin+t.chart_margin_left}).attr("cy",function(e,a){return parseInt(n(e.y))-15+t.chart_margin_top+o}).attr("r","7").style("cursor","pointer").on("click",function(e,a){d3.selectAll(".pyk-tooltip").style("display","none"),t.mouseEvent.tooltipPosition(e),t.mouseEvent.tooltipTextShow(e.annotation)}).on("mouseover",function(e){t.mouseEvent.tooltipHide(e,t.panels_enable,"multilineChart")}).attr("fill",t.annotation_background_color)},t.transitions.duration()),i.exit().remove()}else if("onload"===t.annotation_view_mode){var s=[],_=[],c=d3.select(e).selectAll(".annotation-rect").data(a);c.enter().append("rect").attr("class","annotation-rect");var l=d3.select(e).selectAll(".annotation-text").data(a);l.enter().append("text").attr("class","annotation-text"),l.text(function(t){return""}),c.attr("width",0).attr("height",0),setTimeout(function(){l.attr("x",function(e){return parseInt(r(e.x)-5)+t.extra_left_margin+t.chart_margin_left}).attr("y",function(e){return parseInt(n(e.y)-18+t.chart_margin_top+o)}).attr("text-anchor","middle").style("font-size","12px").text(function(t){return t.annotation}).text(function(t,e){return s[e]=this.getBBox().width+20,_[e]=this.getBBox().height+10,t.annotation}).attr("fill",t.annotation_font_color).style("pointer-events","none"),c.attr("x",function(e,a){return parseInt(r(e.x)-5)+t.extra_left_margin+t.chart_margin_left-s[a]/2}).attr("y",function(e,a){return parseInt(n(e.y)-10+t.chart_margin_top)+o-_[a]}).attr("width",function(t,e){return s[e]}).attr("height",function(t,e){return _[e]}).attr("fill",t.annotation_background_color).style("pointer-events","none")},t.transitions.duration()),l.exit().remove(),c.exit().remove()}return this}},PykCharts.crossHair=function(t){t.k.crossHair=function(e,a,r,n,o){if(PykCharts["boolean"](t.crosshair_enable)&&"default"===t.mode)for(PykCharts.Configuration.cross_hair_v=e.append("line").attr({"class":"line-cursor",id:"cross-hair-v"}),PykCharts.Configuration.cross_hair_h=e.append("line").attr({"class":"line-cursor",id:"cross-hair-h"}).style("display","none"),j=0;j<a;j++)PykCharts.Configuration.focus_circle=e.append("g").attr({"class":"focus",id:"f_circle"+j}).style("display","none"),PykCharts.Configuration.focus_circle.append("circle").attr({fill:function(t){return n.colorPieMS(r[j],o)},id:"focus-circle"+j,r:"6"});return this}},PykCharts.grid=function(t){t.k.yGrid=function(e,a,r,n){t.chart_width,t.chart_height;if(PykCharts["boolean"](t.chart_grid_y_enable)){var o=PykCharts.Configuration.makeYGrid(t,r,n);a.selectAll(t.selector+" g.y.grid-line").style("stroke",function(){return t.chart_grid_color}).call(o)}return this},t.k.xGrid=function(e,a,r,n){t.chart_width,t.chart_height;if(PykCharts["boolean"](t.chart_grid_x_enable)){var o=PykCharts.Configuration.makeXGrid(t,r,n);a.selectAll(t.selector+" g.x.grid-line").style("stroke",function(){return t.chart_grid_color}).call(o)}return this}},PykCharts.Configuration.makeXGrid=function(t,e,a){a||(a=0);var r=d3.svg.axis().scale(e).orient("bottom").ticks(t.axis_x_no_of_axis_value).tickFormat("").tickSize(t.chart_height-t.chart_margin_top-t.chart_margin_bottom-a).outerTickSize(0);return d3.selectAll(t.selector+" .x.axis .tick text").attr("font-size",t.axis_x_pointer_size+"px").style({"font-weight":t.axis_x_pointer_weight,"font-family":t.axis_x_pointer_family}),r},configuration.makeYGrid=function(t,e,a){var r;a||(a=0),r=PykCharts["boolean"](t.panels_enable)?t.w-t.chart_margin_left-t.chart_margin_right-a:t.chart_width-t.chart_margin_left-t.chart_margin_right-a;var n=d3.svg.axis().scale(e).orient("left").ticks(t.axis_y_no_of_axis_value).tickSize(-r).tickFormat("").outerTickSize(0);return d3.selectAll(t.selector+" .y.axis .tick text").attr("font-size",t.axis_y_pointer_size+"px").style({"font-weight":t.axis_y_pointer_weight,"font-family":t.axis_y_pointer_family}),n},PykCharts.scaleFunction=function(t){var e=t.k.__proto__._isNumber;t.k.scaleIdentification=function(t,e,a,r){var n;switch(t){case"ordinal":return n=d3.scale.ordinal().domain(e).rangeRoundBands(a,r);case"linear":return n=d3.scale.linear().domain(e).range(a);case"time":return n=d3.time.scale().domain(e).range(a)}},t.k.ordinalXAxisTickFormat=function(e,a){for(var r,n,o=d3.selectAll(t.selector+" g.x.axis .tick text")[0],i=o.length,l=0,s=2*a,_=0;i>_;_++)l=o[_].getBBox().width>l?o[_].getBBox().width:l;s>=l+10?n=1:s>=.75*l&&l>s?n=2:s>=.65*l&&.75*l>s?n=3:s>=.55*l&&.65*l>s?n=4:s>=.35*l&&.55*l>s?n=5:(20>=s||.35*l>s)&&(n=0);for(var _=0;i>_;_++)r=o[_].__data__,0===n?(r="",d3.selectAll(t.selector+" .x.axis .tick").remove()):s>=o[_].getBBox().width+10&&1===n||(s>=.75*o[_].getBBox().width&&s<o[_].getBBox().width&&2===n?r=r.substr(0,5)+"..":s>=.65*o[_].getBBox().width&&s<.75*o[_].getBBox().width&&3===n?r=r.substr(0,4)+"..":4===n?r=r.substr(0,3):5===n&&(r=r.substr(0,2))),d3.select(o[_]).text(r);return xaxistooltip=d3.selectAll(t.selector+" g.x.axis .tick text").data(e),"default"===t.mode&&xaxistooltip.on("mouseover",function(e){t.mouseEvent.tooltipPosition(e),t.mouseEvent.tooltipTextShow(e)}).on("mousemove",function(e){t.mouseEvent.tooltipPosition(e),t.mouseEvent.tooltipTextShow(e)}).on("mouseout",function(e){t.mouseEvent.tooltipHide(e)}),this},t.k.ordinalYAxisTickFormat=function(e){var a,r=d3.selectAll(t.selector+" g.y.axis .tick text")[0],n=r.length;for(i=0;i<n;i++)a=r[i].textContent,r[i].getBBox().width>.9*t.chart_margin_left&&(a=a.substr(0,3)+".."),d3.select(r[i]).text(a);return yaxistooltip=d3.selectAll(t.selector+" g.y.axis .tick text").data(e),"default"===t.mode&&yaxistooltip.on("mouseover",function(e){t.mouseEvent.tooltipPosition(e),t.mouseEvent.tooltipTextShow(e)}).on("mousemove",function(e){t.mouseEvent.tooltipPosition(e),t.mouseEvent.tooltipTextShow(e)}).on("mouseout",function(e){t.mouseEvent.tooltipHide(e)}),this},t.k.xAxis=function(e,a,r,n,o,i,l,s,_){if(PykCharts["boolean"](t.axis_x_enable)){t.chart_width,t.chart_height;void 0===l&&(l=0),d3.selectAll(t.selector+" .x.axis").attr("fill",function(){return _&&void 0!=_.axis_x_pointer_color&&""!=_.axis_x_pointer_color?_.axis_x_pointer_color:t.axis_x_pointer_color}),"bottom"===t.axis_x_position&&a.attr("transform","translate(0,"+(t.chart_height-t.chart_margin_top-t.chart_margin_bottom-l)+")");var c=PykCharts.Configuration.makeXAxis(t,r);i&&i.length&&c.tickValues(i),a.style("stroke",function(){return t.axis_x_line_color}).call(c),"string"===t.axis_x_data_format&&"no"===t.panels_enable&&t.k.ordinalXAxisTickFormat(o,n),d3.selectAll(t.selector+" .x.axis .tick text").attr("font-size",t.axis_x_pointer_size).style({"font-weight":t.axis_x_pointer_weight,"font-family":t.axis_x_pointer_family}),s&&"string"!==t.axis_x_data_format&&d3.selectAll(t.selector+" .x.axis .domain").remove()}return this},t.k.yAxis=function(e,a,r,n,o,i,l,s,_){if(PykCharts["boolean"](t.axis_y_enable)){i||(i=0);var c=(t.chart_width,t.chart_height,PykCharts["boolean"](t.panels_enable)?t.w:t.chart_width);"right"===t.axis_y_position&&a.attr("transform","translate("+(c-t.chart_margin_left-t.chart_margin_right-i)+",0)"),d3.selectAll(t.selector+" .y.axis").attr("fill",function(){return _&&void 0!=_.axis_y_pointer_color&&""!=_.axis_y_pointer_color?_.axis_y_pointer_color:t.axis_y_pointer_color});var d=PykCharts.Configuration.makeYAxis(t,r,s);o&&o.length&&d.tickValues(o);new PykCharts.Configuration.mouseEvent(t);a.style("stroke",function(){return t.axis_y_line_color}).call(d),"string"===t.axis_y_data_format&&"no"===t.panels_enable&&t.k.ordinalYAxisTickFormat(n),d3.selectAll(t.selector+" .y.axis .tick text").attr("font-size",t.axis_y_pointer_size).style({"font-weight":t.axis_y_pointer_weight,"font-family":t.axis_y_pointer_family}),l&&"string"!==t.axis_y_data_format&&d3.selectAll(t.selector+" .y.axis .domain").remove()}return this},t.k.xAxisTitle=function(e,a,r){if(t.axis_x_title){var n,o=PykCharts["boolean"](t.panels_enable)?t.w:t.chart_width;a||(a=0),r||(r=0),PykCharts["boolean"](t.axis_x_enable)||e.attr("transform","translate(0,"+(t.chart_height-t.chart_margin_top-t.chart_margin_bottom-a)+")"),"bottom"===t.axis_x_position?n=t.chart_margin_bottom:"top"===t.axis_x_position&&(n=-t.chart_margin_top+t.axis_x_title_size),e.append("text").attr({"class":"x-axis-title",x:(o-t.chart_margin_left-t.chart_margin_right-r)/2,y:n}).style({"text-anchor":"middle",fill:t.axis_x_title_color,"font-weight":t.axis_x_title_weight,"font-size":t.axis_x_title_size}).text(t.axis_x_title)}return this},t.k.yAxisTitle=function(e){if(t.axis_y_title){var a,r;PykCharts["boolean"](t.panels_enable)?t.w:t.chart_width;"left"===t.axis_y_position?(a=-(t.chart_margin_left-t.axis_y_title_size),r=0):"right"===t.axis_y_position&&(a=t.chart_margin_right-t.axis_y_title_size,r="0.71em"),e.append("text").attr({"class":"y-axis-title",x:-((t.chart_height-t.chart_margin_bottom-t.chart_margin_top)/2),transform:"rotate(-90)",y:a,dy:r}).style({fill:t.axis_y_title_color,"font-weight":t.axis_y_title_weight,"font-family":t.axis_y_title_family,"font-size":t.axis_y_title_size,"text-anchor":"middle"}).text(t.axis_y_title)}return this},t.k.isOrdinal=function(e,a,r,n,o){return".x.axis"===a&&PykCharts["boolean"](t.axis_x_enable)?(e.select(a).call(PykCharts.Configuration.makeXAxis(t,r)),"string"===t.axis_x_data_format&&"no"===t.panels_enable&&t.k.ordinalXAxisTickFormat(n,o)):".x.grid"===a?e.select(a).call(PykCharts.Configuration.makeXGrid(t,r)):".y.axis"===a&&PykCharts["boolean"](t.axis_y_enable)?(e.select(a).call(PykCharts.Configuration.makeYAxis(t,r)),"string"===t.axis_y_data_format&&"no"===t.panels_enable&&t.k.ordinalyAxisTickFormat(n)):".y.grid"===a&&e.select(a).call(PykCharts.Configuration.makeYGrid(t,r)),this},t.k.xAxisDataFormatIdentification=function(t){return e(t[0].x)||!isNaN(t[0].x)?"number":isNaN(new Date(t[0].x).getTime())?"string":"time"},t.k.yAxisDataFormatIdentification=function(t){return e(t[0].y)||!isNaN(t[0].y)?"number":isNaN(new Date(t[0].y).getTime())?"string":"time"},t.k.processXAxisTickValues=function(){var a=[],r=[],n=t.axis_x_pointer_values.length;if(n)for(var o=0;n>o;o++)"number"===t.axis_x_data_format?!e(t.axis_x_pointer_values[o])&&isNaN(t.axis_x_pointer_values[o])||""==t.axis_x_pointer_values[o]||a.push(parseFloat(t.axis_x_pointer_values[o])):"time"===t.axis_x_data_format&&(isNaN(new Date(t.axis_x_pointer_values[o]).getTime())||a.push(t.axis_x_pointer_values[o]));if(a.length){var i=a.length;if("time"===t.axis_x_data_format)for(var o=0;i>o;o++)r.push(t.k.dateConversion(a[o]));else r=a}return r},t.k.processYAxisTickValues=function(){var a=t.axis_y_pointer_values.length,r=[];if(a)for(var n=0;a>n;n++)"number"===t.axis_y_data_format&&(!e(t.axis_y_pointer_values[n])&&isNaN(t.axis_y_pointer_values[n])||""==t.axis_y_pointer_values[n]||r.push(t.axis_y_pointer_values[n]));return r}};var configuration=PykCharts.Configuration;configuration.makeXAxis=function(t,e){var r=(PykCharts.Configuration(t),d3.svg.axis().scale(e).tickSize(t.axis_x_pointer_length).outerTickSize(t.axis_x_outer_pointer_length).tickFormat(function(e,a){return"yes"===t.panels_enable&&"string"===t.axis_x_data_format?e.substr(0,2):e}).tickPadding(t.axis_x_pointer_padding).orient(t.axis_x_pointer_position));if(d3.selectAll(t.selector+" .x.axis .tick text").attr("font-size",t.axis_x_pointer_size+"px").style({"font-weight":t.axis_x_pointer_weight,"font-family":t.axis_x_pointer_family}),"time"===t.axis_x_data_format&&PykCharts["boolean"](t.axis_x_time_value_datatype)){switch(t.axis_x_time_value_datatype){case"month":a=d3.time.month,b="%b";break;case"date":a=d3.time.day,b="%d";break;case"year":a=d3.time.year,b="%Y";break;case"hours":a=d3.time.hour,b="%H";break;case"minutes":a=d3.time.minute,b="%M"}r.ticks(a,t.axis_x_time_value_interval).tickFormat(d3.time.format(b))}else"number"===t.axis_x_data_format&&r.ticks(t.axis_x_no_of_axis_value);return r},configuration.makeYAxis=function(t,e,a){var r=(PykCharts.Configuration(t),d3.svg.axis().scale(e).orient(t.axis_y_pointer_position).tickSize(t.axis_y_pointer_length).outerTickSize(t.axis_y_outer_pointer_length).tickPadding(t.axis_y_pointer_padding).tickFormat(function(t,e){return a?a(t):t}));return d3.selectAll(t.selector+" .y.axis .tick text").attr("font-size",t.axis_y_pointer_size+"px").style({"font-weight":t.axis_y_pointer_weight,"font-family":t.axis_y_pointer_family}),"number"===t.axis_y_data_format&&r.ticks(t.axis_y_no_of_axis_value),r},PykCharts.crossHairMovement=function(t){var e=this,a=PykCharts.Configuration.mouseEvent(t);return e.tooltip=configuration.tooltipp,e.cross_hair_v=configuration.cross_hair_v,e.cross_hair_h=configuration.cross_hair_h,e.focus_circle=configuration.focus_circle,e.pt_circle=configuration.pt_circle,e.start_pt_circle=configuration.start_pt_circle,a.crossHairPosition=function(e,a,r,n,o,l,s,_,c,d,u){if((PykCharts["boolean"](t.crosshair_enable)||PykCharts["boolean"](t.tooltip_enable)||PykCharts["boolean"](t.axis_onhover_highlight_enable))&&"default"===t.mode){var h=t.k.__proto__._offset,p=document.querySelector(t.selector+" #"+n[0][0][0].parentNode.parentNode.id),g=0,m=0;PykCharts["boolean"](c)?(g=1,height_percentge=1):(g=parseFloat(d3.select(p).style("width"))/t.chart_width,m=parseFloat(d3.select(p).style("height"))/t.chart_height);var f=t.legendsGroup_height?t.legendsGroup_height:0,x=(t.chart_margin_left+o)*g+h(p).left,y=h(p).top,v=e.length,k=t.chart_margin_left,w=(t.chart_margin_right,t.chart_margin_top),b=t.chart_margin_bottom,C=(t.chart_width,t.chart_height),P=parseInt(PykCharts.getEvent().target.id.substr(PykCharts.getEvent().target.id.length-1,1)),D=PykCharts.getEvent().pageX-x,S=PykCharts.getEvent().pageY-y-w,A=[];if("string"===t.axis_x_data_format)A=a.range();else for(temp=a.range(),pad=(temp[1]-temp[0])/(e[0].data.length-1),len=e[0].data.length,strt=0,i=0;i<len;i++)A[i]=strt,strt+=pad;var F,E,z,B,G,I,T,H,L=r.range(),M=(L.length,[]),q=[],N=A.length;for(F=0;N>F;F++){if(F+1>=N)return!1;if(I===A[F]&&T===A[F+1]&&H===L[0])return!1;if(D>=g*A[F]&&D<=g*A[F+1]&&S<L[0]+f){switch(T=g*A[F],I=g*A[F+1],H=L[0],z=T-D,B=D-I,z>=B?(E=e[0].data[F].x,M.push(e[0].data[F].y),tooltipText=e[0].data[F].tooltip||e[0].data[F].y):(E=e[0].data[F+1].x,M.push(e[0].data[F+1].y),tooltipText=e[0].data[F+1].tooltip||e[0].data[F+1].y),G=a(E)+o+k,q=r(tooltipText)+w,s){case"multi_series_line":var j=[];d3.selectAll(t.selector+" #pyk-tooltip").classed({"pyk-tooltip":!1,"pyk-multiline-tooltip":!0,"pyk-tooltip-table":!0});var R=e[0].data.length,V="";M=[];for(var O=0;v>O;O++)for(var U=0;R>U;U++)"time"===t.axis_x_data_format?cond=Date.parse(E)===Date.parse(e[O].data[U].x):cond=e[O].data[U].x===E,cond&&(M.push(e[O].data[U].y),j.push(r(e[O].data[U].y)+w),V+="<tr><td>"+e[O].name+"</td><td><b>"+(e[O].data[U].tooltip||e[O].data[U].y)+"</b></td></tr>");G+=6,tooltipText="<table><thead><th colspan='2'>"+E+"</th></thead><tbody>"+V+"</tbody></table>",PykCharts["boolean"](t.tooltip_enable)&&(this.tooltipPosition(tooltipText,G,S,60,-15,P,g,m,s),this.tooltipTextShow(tooltipText)),t.crosshair_enable?this.crossHairShowMultipleline(G,w,G,C-b,G,j,e):null;break;case"panels_of_line":G+=5;for(var R=e[0].data.length,W=C,Y=0,Q=0,O=0;v>O;O++)for(var J=h(document.querySelector(t.selector)),X=h(document.querySelector(t.selector+" #"+d+"-"+O)),$=X.left-J.left,U=(X.top-J.top,0);R>U;U++)"time"===t.axis_x_data_format?cond=Date.parse(E)===Date.parse(e[O].data[U].x):cond=e[O].data[U].x===E,cond&&(M.push(e[O].data[U].y),tooltipText=e[O].data[U].tooltip||e[O].data[U].y,O%u==0&&0!=O&&(++Y,Q=W*Y),q=r(e[O].data[U].y)+w,this.tooltipPosition(tooltipText,G+$-15-30,q+Q,-15,-15,O,g,m,s),this.tooltipTextShow(tooltipText,s,O),t.crosshair_enable?this.crossHairShowPanelOfLine(G,w,G,C-b,G,q,O,d):null);break;case"lineChart":case"areaChart":PykCharts["boolean"](t.tooltip_enable)&&("fixed"===t.tooltip_mode.toLowerCase()?this.tooltipPosition(tooltipText,-t.chart_margin_left,q,-14,23,P,g,m,s):"moving"===t.tooltip_mode.toLowerCase()&&this.tooltipPosition(tooltipText,G-t.chart_margin_left+10,q-5,0,-45,P,g,m,s),this.tooltipTextShow(tooltipText)),t.crosshair_enable?this.crossHairShowLineArea(G,w,G,C-b,G,q):null;break;case"stackedAreaChart":var j=[];d3.selectAll(t.selector+" #pyk-tooltip").classed({"pyk-tooltip":!1,"pyk-multiline-tooltip":!0,"pyk-tooltip-table":!0});var R=e[0].data.length,V="";M=[];for(var O=0;v>O;O++)for(var U=0;R>U;U++)"time"===t.axis_x_data_format?cond=Date.parse(E)===Date.parse(e[O].data[U].x):cond=e[O].data[U].x===E,cond&&(M.push(e[O].data[U].y),j.push(r(e[O].data[U].y+e[O].data[U].y0)+w+t.legendsGroup_height),V+="<tr><td>"+e[O].name+"</td><td><b>"+(e[O].data[U].tooltip||e[O].data[U].y)+"</b></td></tr>");G+=6,tooltipText="<table><thead><th colspan='2'>"+E+"</th></thead><tbody>"+V+"</tbody></table>",PykCharts["boolean"](t.tooltip_enable)&&(P=1,this.tooltipPosition(tooltipText,G,S,60,70,P,g,m),this.tooltipTextShow(tooltipText)),t.crosshair_enable?this.crossHairShowStackedArea(G,w+f,G,C-b,G,j,e):null}PykCharts["boolean"](c)||(this.axisHighlightShow(M,t.selector+" .y.axis",l),this.axisHighlightShow(E,t.selector+" .x.axis",l))}}}},a.crossHairShowLineArea=function(a,r,n,o,i,l){return PykCharts["boolean"](t.crosshair_enable)&&(d3.selectAll(t.selector+" .line-cursor").style("display","block"),d3.select(t.selector+" #cross-hair-v").attr({x1:a,y1:r,x2:n,y2:o}),d3.select(t.selector+" #cross-hair-h").attr({x1:t.chart_margin_left,y1:l,x2:t.chart_width-t.chart_margin_right,y2:l}),e.focus_circle.style("display","block").attr("transform","translate("+i+","+l+")")),this},a.crossHairShowMultipleline=function(a,r,n,o,i,l,s){if(PykCharts["boolean"](t.crosshair_enable)){e.cross_hair_v.style("display","block"),d3.select(t.selector+" #cross-hair-v").attr({x1:a-5,y1:r,x2:n-5,y2:o});for(var _=0;_<s.length;_++)d3.select(t.selector+" #f_circle"+_).style("display","block").attr("transform","translate("+(i-3)+","+l[_]+")");
}return this},a.crossHairShowPanelOfLine=function(e,a,r,n,o,i,l,s){return PykCharts["boolean"](t.crosshair_enable)&&(d3.selectAll(t.selector+" .line-cursor").style("display","block"),d3.selectAll(t.selector+" #cross-hair-v").attr({x1:e-5,y1:a,x2:r-5,y2:n}),d3.select(t.selector+" #"+s+"-"+l+" #cross-hair-h").attr({x1:t.chart_margin_left,y1:i,x2:t.w-t.chart_margin_right,y2:i}),d3.select(t.selector+" #"+s+"-"+l+" .focus").style("display","block").attr("transform","translate("+(o-5)+","+i+")")),this},a.crossHairShowStackedArea=function(e,a,r,n,o,i,l){if(PykCharts["boolean"](t.crosshair_enable)){d3.selectAll(t.selector+" .line-cursor").style("display","block"),d3.selectAll(t.selector+" #cross-hair-v").attr({x1:e-5,y1:a,x2:r-5,y2:n});for(var s=0;s<l.length;s++)d3.select(t.selector+" #f_circle"+s).style("display","block").attr("transform","translate("+(o-3)+","+i[s]+")")}return this},a.crossHairHide=function(a){return PykCharts["boolean"](t.crosshair_enable)&&(e.cross_hair_v.style("display","none"),"lineChart"===a||"areaChart"===a?(e.cross_hair_h.style("display","none"),e.focus_circle.style("display","none")):("multilineChart"===a||"stackedAreaChart"===a)&&(d3.selectAll(t.selector+" .line-cursor").style("display","none"),d3.selectAll(t.selector+" .focus").style("display","none"))),this},a.tooltipPosition=function(a,r,n,o,i,l,s,_,c){if(PykCharts["boolean"](t.tooltip_enable)||PykCharts["boolean"](t.annotation_enable)||"string"===t.axis_x_data_format||"string"===t.axis_y_data_format){if(void 0!==r){var d=t.k.__proto__._offset,u=t.selector.substr(1,t.selector.length),h=document.getElementById(u),p=(document.querySelector("#tooltip-svg-container-"+l+"-pyk-tooltip"+u)?parseFloat(d3.select("#tooltip-svg-container-"+l+"-pyk-tooltip"+u).style("width")):0,document.querySelector("#tooltip-svg-container-"+l+"-pyk-tooltip"+u)?parseFloat(d3.select("#tooltip-svg-container-"+l+"-pyk-tooltip"+u).style("height")):0),g=d3.select("#tooltip-svg-container-"+l+"-pyk-tooltip"+u),m=d(h).left,f=d(h).top;if("lineChart"===c||"areaChart"===c)var x=n*_;else var x=n-p/2*_;g.style({display:"block",top:x+f+"px",left:(r+t.chart_margin_left)*s+m+"px"})}else e.tooltip.style({display:"block",top:PykCharts.getEvent().pageY-20+"px",left:PykCharts.getEvent().pageX+30+"px"});return e.tooltip}},a.tooltipTextShow=function(a,r,n){var o=t.selector.substr(1,t.selector.length);return PykCharts["boolean"](t.tooltip_enable)||PykCharts["boolean"](t.annotation_enable)||"string"===t.axis_x_data_format||"string"===t.axis_y_data_format?("panels_of_line"===r?d3.selectAll("#tooltip-svg-container-"+n+"-pyk-tooltip"+o).html(a):e.tooltip.html(a),this):void 0},a.tooltipHide=function(a,r,n){return PykCharts["boolean"](t.tooltip_enable)||PykCharts["boolean"](t.annotation_enable)||"string"===t.axis_x_data_format||"string"===t.axis_y_data_format?"yes"===r&&"multilineChart"===n?d3.selectAll(".pyk-tooltip").style("display","none"):e.tooltip.style("display","none"):void 0},a},PykCharts.multiD.line=function(t){var e=this;e.interval="";var a=new PykCharts.Configuration.Theme({});this.execute=function(r){if(e=new PykCharts.validation.processInputs(e,t,"multiDimensionalCharts"),PykCharts.crossHair(e),PykCharts.annotation(e),PykCharts.scaleFunction(e),PykCharts.grid(e),!e.stop){e.k.storeInitialDivHeight(),"default"===e.mode&&e.k.loading();var n=a.multiDimensionalCharts,o=a.stylesheet;t.optional;e.pointer_overflow_enable=t.pointer_overflow_enable?t.pointer_overflow_enable.toLowerCase():o.pointer_overflow_enable,e.crosshair_enable=t.crosshair_enable?t.crosshair_enable.toLowerCase():n.crosshair_enable,e.curvy_lines_enable=t.curvy_lines_enable?t.curvy_lines_enable.toLowerCase():n.curvy_lines_enable,e.interpolate=PykCharts["boolean"](e.curvy_lines_enable)?"cardinal":"linear",e.panels_enable="no",e.executeData=function(a){var r=e.k.validator().validatingJSON(a);e.selector.substring(1,e.selector.length);e.stop||r===!1||(e.data=e.k.__proto__._groupBy("line",a),e.axis_y_data_format="number",e.axis_x_data_format=e.k.xAxisDataFormatIdentification(e.data),"time"===e.axis_x_data_format&&""===e.axis_x_time_value_datatype&&console.warn("%c[Warning - Pykih Charts] ","color: #F8C325;font-weight:bold;font-size:14px"," at "+e.selector+'.("You seem to have passed Date data so please pass the value for axis_x_time_value_datatype")  Visit www.pykcharts.com/errors#warning_15'),"string"===e.axis_x_data_format?e.data_sort_enable="no":(e.data_sort_enable="yes",e.data_sort_type="time"===e.axis_x_data_format?"date":"numerically",e.data_sort_order="ascending"),PykCharts.multiD.lineFunctions(t,e,"line"))},PykCharts["boolean"](e.interactive_enable)?(e.k.dataFromPykQuery(r),e.k.dataSourceFormatIdentification(e.data,e,"executeData")):e.k.dataSourceFormatIdentification(t.data,e,"executeData")}}},PykCharts.multiD.multiSeriesLine=function(t){var e=this;e.interval="";var a=new PykCharts.Configuration.Theme({});this.execute=function(r){if(e=new PykCharts.validation.processInputs(e,t,"multiDimensionalCharts"),PykCharts.crossHair(e),PykCharts.annotation(e),PykCharts.scaleFunction(e),PykCharts.grid(e),!e.stop){e.k.storeInitialDivHeight(),"default"===e.mode&&e.k.loading();var n=a.multiDimensionalCharts,o=a.stylesheet;t.optional;e.pointer_overflow_enable=t.pointer_overflow_enable?t.pointer_overflow_enable.toLowerCase():o.pointer_overflow_enable,e.crosshair_enable=t.crosshair_enable?t.crosshair_enable.toLowerCase():n.crosshair_enable,e.curvy_lines_enable=t.curvy_lines_enable?t.curvy_lines_enable.toLowerCase():n.curvy_lines_enable,e.interpolate=PykCharts["boolean"](e.curvy_lines_enable)?"cardinal":"linear",e.panels_enable="no",e.executeData=function(a){var r=e.k.validator().validatingJSON(a),n=e.selector.substring(1,e.selector.length);return e.stop||r===!1?void e.k.remove_loading_bar(n):(e.data=e.k.__proto__._groupBy("line",a),e.axis_y_data_format="number",e.axis_x_data_format=e.k.xAxisDataFormatIdentification(e.data),"time"===e.axis_x_data_format&&""===e.axis_x_time_value_datatype&&console.warn("%c[Warning - Pykih Charts] ","color: #F8C325;font-weight:bold;font-size:14px"," at "+e.selector+'.("You seem to have passed Date data so please pass the value for axis_x_time_value_datatype")  Visit www.pykcharts.com/errors#warning_15'),"string"===e.axis_x_data_format?e.data_sort_enable="no":(e.data_sort_enable="yes",e.data_sort_type="time"===e.axis_x_data_format?"date":"numerically",e.data_sort_order="ascending"),void PykCharts.multiD.lineFunctions(t,e,"multi_series_line"))},PykCharts["boolean"](e.interactive_enable)?(e.k.dataFromPykQuery(r),e.k.dataSourceFormatIdentification(e.data,e,"executeData")):e.k.dataSourceFormatIdentification(t.data,e,"executeData")}}},PykCharts.multiD.panelsOfLine=function(t){var e=this;e.interval="";var a=new PykCharts.Configuration.Theme({});this.execute=function(r){if(e=new PykCharts.validation.processInputs(e,t,"multiDimensionalCharts"),PykCharts.crossHair(e),PykCharts.annotation(e),PykCharts.scaleFunction(e),PykCharts.grid(e),!e.stop){e.k.storeInitialDivHeight(),"default"===e.mode&&e.k.loading();var n=a.multiDimensionalCharts,o=a.stylesheet;t.optional;e.pointer_overflow_enable=t.pointer_overflow_enable?t.pointer_overflow_enable.toLowerCase():o.pointer_overflow_enable,e.crosshair_enable=t.crosshair_enable?t.crosshair_enable.toLowerCase():n.crosshair_enable,e.curvy_lines_enable=t.curvy_lines_enable?t.curvy_lines_enable.toLowerCase():n.curvy_lines_enable,e.interpolate=PykCharts["boolean"](e.curvy_lines_enable)?"cardinal":"linear",e.panels_enable="yes",e.executeData=function(a){var r=e.k.validator().validatingJSON(a),n=e.selector.substring(1,e.selector.length);return e.stop||r===!1?void e.k.remove_loading_bar(n):(e.data=e.k.__proto__._groupBy("line",a),e.axis_y_data_format="number",e.axis_x_data_format=e.k.xAxisDataFormatIdentification(e.data),"time"===e.axis_x_data_format&&""===e.axis_x_time_value_datatype&&console.warn("%c[Warning - Pykih Charts] ","color: #F8C325;font-weight:bold;font-size:14px"," at "+e.selector+'.("You seem to have passed Date data so please pass the value for axis_x_time_value_datatype")  Visit www.pykcharts.com/errors#warning_15'),"string"===e.axis_x_data_format?e.data_sort_enable="no":(e.data_sort_enable="yes",e.data_sort_type="time"===e.axis_x_data_format?"date":"numerically",e.data_sort_order="ascending"),void PykCharts.multiD.lineFunctions(t,e,"panels_of_line"))},PykCharts["boolean"](e.interactive_enable)?(e.k.dataFromPykQuery(r),e.k.dataSourceFormatIdentification(e.data,e,"executeData")):e.k.dataSourceFormatIdentification(t.data,e,"executeData")}}},PykCharts.multiD.lineFunctions=function(t,e,a){var r=e,o=r.selector.substring(1,r.selector.length);r.compare_data=r.data,r.data_length=r.data.length,r.k.remove_loading_bar(o),r.dataTransformation=function(){for(r.group_arr=[],r.new_data=[],r.ticks=[],r.x_arr=[],j=0;j<r.data_length;j++)r.group_arr[j]=r.data[j].name;r.uniq_group_arr=r.k.__proto__._unique(r.group_arr),r.uniq_color_arr=[];for(var t=r.uniq_group_arr.length,e=0;e<r.data_length;e++)r.x_arr[e]=r.data[e].x;var a=r.k.__proto__._unique(r.x_arr);for(e=0;t>e;e++)if(r.chart_color[e])r.uniq_color_arr[e]=r.chart_color[e];else{for(l=0;l<r.data_length;l++)if(r.uniq_group_arr[e]===r.data[l].name&&r.data[l].color){r.uniq_color_arr[e]=r.data[l].color;break}PykCharts["boolean"](r.uniq_color_arr[e])||(r.uniq_color_arr[e]=r.default_color[0])}for(r.flag=0,e=0;t>e;e++)for(r.new_data[e]={name:r.uniq_group_arr[e],data:[],color:r.uniq_color_arr[e]},l=0;l<r.data_length;l++)r.uniq_group_arr[e]===r.data[l].name&&r.new_data[e].data.push({x:r.data[l].x,y:r.data[l].y,tooltip:r.data[l].tooltip,annotation:r.data[l].annotation||""});r.new_data_length=r.new_data.length;for(var n=a.length,o=0;o<r.new_data_length;o++){for(var i=r.k.__proto__._unique(r.x_arr),s=r.new_data[o].data.length,_=0;s>_;_++)for(var e=0;n>e;e++)if(r.new_data[o].data[_].x==i[e]){i[e]=void 0;break}for(var c=0;n>c;c++)if(void 0!=i[c]){var d={x:i[c],y:0,tooltip:0,annotation:""};r.new_data[o].data.splice(c,0,d)}}for(var e=0;e<r.new_data_length;e++)r.new_data[e].data=r.k.__proto__._sortData(r.new_data[e].data,"x","name",r)},r.calculatePanelInRow=function(){var t,e=parseInt(r.k._getHighestParentsAttribute(r.selector,"width"));t=e?e:d3.select("body").style("width"),r.no_of_containers_in_row=Math.floor(parseInt(t)/r.chart_width),r.no_of_containers_in_row>r.new_data.length&&(r.no_of_containers_in_row=r.new_data.length),t<r.chart_width&&(r.no_of_containers_in_row=1)},r.render=function(){var e=r.selector.substring(1,r.selector.length);if(r.container_id=e+"_svg",r.dataLineGroup=[],r.clicked,r.multid=new PykCharts.multiD.configuration(r),r.fillColor=new PykCharts.Configuration.fillChart(r,null,t),r.transitions=new PykCharts.Configuration.transition(r),PykCharts["boolean"](r.panels_enable)&&(r.calculatePanelInRow(),r.new_width=r.no_of_containers_in_row*r.chart_width),"default"===r.mode){if(r.k.title(r.new_width),PykCharts["boolean"](r.panels_enable)){if(r.w=r.chart_width,r.chart_height=r.chart_height,r.chart_margin_left=r.chart_margin_left,r.chart_margin_right=r.chart_margin_right,r.k.backgroundColor(r)["export"](r,r.container_id+"-","lineChart",r.panels_enable,r.new_data,r.new_width).emptyDiv(r.selector).subtitle(r.new_width),d3.select(r.selector).append("div").attr("id","panels_of_line_main_div"),r.k.liveData(r),r.optionalFeature().chartType(),r.reducedWidth=r.w-r.chart_margin_left-r.chart_margin_right,r.reducedHeight=r.chart_height-r.chart_margin_top-r.chart_margin_bottom,r.fill_data=[],"time"===r.axis_x_data_format){for(i=0;i<r.new_data_length;i++)r.new_data[i].data.forEach(function(t){t.x=r.k.dateConversion(t.x)});r.data.forEach(function(t){t.x=r.k.dateConversion(t.x)})}r.renderPanelOfLines()}else{r.k.backgroundColor(r)["export"](r,"#"+r.container_id+"-1","lineChart").emptyDiv(r.selector).subtitle(),r.w=r.chart_width,r.reducedWidth=r.w-r.chart_margin_left-r.chart_margin_right,r.reducedHeight=r.chart_height-r.chart_margin_top-r.chart_margin_bottom;var n=r.selector.substr(1,r.selector.length);if(d3.selectAll("#tooltip-svg-container-1-pyk-tooltip"+n).remove(),r.k.liveData(r).makeMainDiv(r.selector,1).tooltip(!0,r.selector,1,r.flag),r.optionalFeature().chartType(),"time"===r.axis_x_data_format){for(i=0;i<r.new_data_length;i++)r.new_data[i].data.forEach(function(t){t.x=r.k.dateConversion(t.x)});r.data.forEach(function(t){t.x=r.k.dateConversion(t.x)})}try{if("multilineChart"===r.type&&"line"===a)throw"Invalid data in the JSON"}catch(o){return void console.error("%c[Error - Pykih Charts] ","color: red;font-weight:bold;font-size:14px"," at "+r.selector+'."'+o+'"  Visit www.pykcharts.com/errors#error_6')}r.renderLineChart()}r.k.createFooter(r.new_width).lastUpdatedAt().credits().dataSource(),PykCharts["boolean"](r.annotation_enable)&&r.annotation()}else if("infographics"===r.mode)if(PykCharts["boolean"](r.panels_enable)){if(r.k.backgroundColor(r)["export"](r,"#"+r.container_id+"-","lineChart",r.panels_enable,r.new_data,r.new_width).emptyDiv(r.selector),d3.select(r.selector).append("div").attr("id","panels_of_line_main_div"),r.optionalFeature().chartType(),r.w=r.chart_width,r.chart_height=r.chart_height,"time"===r.axis_x_data_format){for(i=0;i<r.new_data_length;i++)r.new_data[i].data.forEach(function(t){t.x=r.k.dateConversion(t.x)});r.data.forEach(function(t){t.x=r.k.dateConversion(t.x)})}r.reducedWidth=r.w-r.chart_margin_left-r.chart_margin_right,r.reducedHeight=r.chart_height-r.chart_margin_top-r.chart_margin_bottom,r.fill_data=[],r.renderPanelOfLines()}else{if(r.k.backgroundColor(r)["export"](r,"#"+r.container_id+"-0","lineChart").emptyDiv(r.selector),r.w=r.chart_width,r.reducedWidth=r.w-r.chart_margin_left-r.chart_margin_right,r.reducedHeight=r.chart_height-r.chart_margin_top-r.chart_margin_bottom,r.k.makeMainDiv(r.selector,1),r.optionalFeature().chartType(),"time"===r.axis_x_data_format){for(i=0;i<r.new_data_length;i++)r.new_data[i].data.forEach(function(t){t.x=r.k.dateConversion(t.x)});r.data.forEach(function(t){t.x=r.k.dateConversion(t.x)})}try{if("multilineChart"===r.type&&"line"===a)throw"Invalid data in the JSON"}catch(o){return void console.error("%c[Error - Pykih Charts] ","color: red;font-weight:bold;font-size:14px"," at "+r.selector+'."'+o+'"  Visit www.pykcharts.com/errors#error_6')}r.renderLineChart()}if(PykCharts["boolean"](r.panels_enable)){var l=r.k.resize(null,r.new_width);r.k.__proto__._ready(l),window.addEventListener("resize",function(t){return r.calculatePanelInRow(),r.k.resize(null,r.new_width)})}else{var l=r.k.resize(r.svgContainer);r.k.__proto__._ready(l),window.addEventListener("resize",function(t){return r.k.resize(r.svgContainer)})}},r.refresh=function(e){r.executeRefresh=function(t){r.data=r.k.__proto__._groupBy("line",t),r.data_length=r.data.length;var e=r.k.checkChangeInData(r.data,r.compare_data);r.compare_data=e[0];var a=e[1];if(r.dataTransformation(),(a||PykCharts["boolean"](r.zoom_enable)&&r.count>1&&r.count<=r.zoom_level||r.transition_duration)&&(r.k.lastUpdatedAt("liveData"),r.mouseEvent.tooltipHide(null,r.panels_enable,r.type),r.mouseEvent.crossHairHide(r.type),r.mouseEvent.axisHighlightHide(r.selector+" .x.axis"),r.mouseEvent.axisHighlightHide(r.selector+" .y.axis")),r.optionalFeature().hightLightOnload(),"time"===r.axis_x_data_format){for(var n=0;n<r.new_data_length;n++)r.new_data[n].data.forEach(function(t){t.x=r.k.dateConversion(t.x)});r.data.forEach(function(t){t.x=r.k.dateConversion(t.x)})}if(PykCharts["boolean"](r.panels_enable)){for(var n=0;n<r.previous_length;n++){var o=document.querySelector(r.selector+" #panels_of_line_main_div #chart-container-"+n);o.parentNode.removeChild(o)}r.renderPanelOfLines()}"multilineChart"!==r.type||PykCharts["boolean"](r.panels_enable)||(document.querySelector(r.selector+" #chart-container-1").innerHTML=null,r.renderLineChart()),"lineChart"===r.type&&(r.optionalFeature().createChart("liveData").ticks(),r.k.xAxis(r.svgContainer,r.xGroup,r.xScale,r.extra_left_margin,r.xdomain,r.x_tick_values).yAxis(r.svgContainer,r.yGroup,r.yScale,r.ydomain,r.y_tick_values).yGrid(r.svgContainer,r.group,r.yScale).xGrid(r.svgContainer,r.group,r.xScale),PykCharts["boolean"](r.annotation_enable)&&r.annotation())},PykCharts["boolean"](r.interactive_enable)?(r.k.dataFromPykQuery(e),r.k.dataSourceFormatIdentification(r.data,r,"executeRefresh")):r.k.dataSourceFormatIdentification(t.data,r,"executeRefresh")},r.optionalFeature=function(){var t=r.selector.substring(1,r.selector.length),e={chartType:function(){for(var t=0;t<r.data_length;t++)for(var e=t+1;e<r.data_length;e++)if(r.data[t].x===r.data[e].x){r.type="multilineChart";break}return r.type=r.type||"lineChart",this},hightLightOnload:function(){if("multilineChart"===r.type&&r.new_data_length>0&&r.highlight)for(var t=0;t<r.uniq_group_arr.length;t++)r.highlight.toLowerCase()===r.uniq_group_arr[t].toLowerCase()?r.new_data[t].highlight=!0:r.new_data[t].highlight=!1;return this},svgContainer:function(e){var a=document.getElementById(t);return"multilineChart"!==r.type||a.classList.contains("PykCharts-line-chart")?"lineChart"!==r.type||a.classList.contains("PykCharts-line-chart")||(a.className+=" PykCharts-twoD PykCharts-line-chart"):a.className+=" PykCharts-twoD PykCharts-line-chart PykCharts-multi-series2D",r.svgContainer=d3.select(r.selector+" #chart-container-"+e).append("svg:svg").attr({id:r.container_id+"-"+e,width:r.w,height:r.chart_height,"class":"svgcontainer",preserveAspectRatio:"xMinYMin",viewBox:"0 0 "+r.w+" "+r.chart_height}),PykCharts["boolean"](r.pointer_overflow_enable)&&!PykCharts["boolean"](r.panels_enable)&&r.svgContainer.style("overflow","visible"),this},createGroups:function(t){return r.group=r.svgContainer.append("g").attr({id:r.type+"-svg",transform:"translate("+r.chart_margin_left+","+r.chart_margin_top+")"}),PykCharts["boolean"](r.chart_grid_y_enable)&&r.group.append("g").attr({id:"ygrid","class":"y grid-line"}),PykCharts["boolean"](r.chart_grid_x_enable)&&r.group.append("g").attr({id:"xgrid","class":"x grid-line"}),r.clip=r.svgContainer.append("svg:clipPath").attr("id","clip"+t+r.selector).append("svg:rect").attr({width:r.reducedWidth,height:r.reducedHeight}),r.chartBody=r.svgContainer.append("g").attr({id:"clipPath","clip-path":"url(#clip"+t+r.selector+")",transform:"translate("+r.chart_margin_left+","+r.chart_margin_top+")"}),this},axisContainer:function(){return(PykCharts["boolean"](r.axis_x_enable)||r.axis_x_title)&&(r.xGroup=r.group.append("g").attr({id:"xaxis","class":"x axis"})),(PykCharts["boolean"](r.axis_y_enable)||r.axis_y_title)&&(r.yGroup=r.group.append("g").attr({id:"yaxis","class":"y axis"})),this},createChart:function(t,e){function a(t){r.dataLineGroup[t].transition().duration(r.transitions.duration()).attrTween("d",function(e){var a=d3.scale.quantile().domain([0,1]).range(d3.range(1,y.length+1));return function(e){return r.chart_path(r.new_data[t].data.slice(0,a(e)))}})}function o(t){r.dataLineGroup[t].transition().duration(r.transitions.duration()).attrTween("d",function(e){var a=d3.scale.quantile().domain([0,1]).range(d3.range(1,y.length+1));return function(e){return r.chart_path(r.new_data[t].data.slice(0,a(e)))}})}function i(t){r.dataLineGroup[0].transition().duration(r.transitions.duration()).attrTween("d",function(t){var e=d3.scale.quantile().domain([0,1]).range(d3.range(1,y.length+1));return function(t){return r.chart_path(y.slice(0,e(t)))}})}r.previous_length=r.new_data.length,r.x_tick_values=r.k.processXAxisTickValues(),r.y_tick_values=r.k.processYAxisTickValues();var l,s,_,c,d,u,h,p,g,m=[];if("number"===r.axis_y_data_format?(max=d3.max(r.new_data,function(t){return d3.max(t.data,function(t){return t.y})}),min=d3.min(r.new_data,function(t){return d3.min(t.data,function(t){return t.y})}),d=[min,max],s=r.k.__proto__._domainBandwidth(d,2),p=d3.min(r.y_tick_values),g=d3.max(r.y_tick_values),s[0]>p&&(s[0]=p),s[1]<g&&(s[1]=g),_=[r.reducedHeight,0],r.yScale=r.k.scaleIdentification("linear",s,_)):"string"===r.axis_y_data_format?(r.new_data[0].data.forEach(function(t){s.push(t.y)}),_=[0,r.reducedHeight],r.yScale=r.k.scaleIdentification("ordinal",s,_,0)):"time"===r.axis_y_data_format&&(s=d3.extent(r.data,function(t){return new Date(t.x)}),p=d3.min(r.y_tick_values,function(t){return new Date(t)}),g=d3.max(r.y_tick_values,function(t){return new Date(t)}),new Date(s[0])>new Date(p)&&(s[0]=p),new Date(s[1])<new Date(g)&&(s[1]=max__tick_value),_=[r.reducedHeight,0],r.yScale=r.k.scaleIdentification("time",s,_)),r.xdomain=[],"number"===r.axis_x_data_format?(max=d3.max(r.new_data,function(t){return d3.max(t.data,function(t){return+t.x})}),min=d3.min(r.new_data,function(t){return d3.min(t.data,function(t){return+t.x})}),l=[min,max],m=r.k.__proto__._domainBandwidth(l,2),u=d3.min(r.x_tick_values),h=d3.max(r.x_tick_values),m[0]>u&&(m[0]=u),m[1]<h&&(m[1]=h),c=[0,r.reducedWidth],r.xScale=r.k.scaleIdentification("linear",m,c),r.extra_left_margin=0,r.new_data[0].data.forEach(function(t){r.xdomain.push(+t.x)})):"string"===r.axis_x_data_format?(r.new_data[0].data.forEach(function(t){m.push(t.x)}),c=[0,r.reducedWidth],r.xScale=r.k.scaleIdentification("ordinal",m,c,0),r.extra_left_margin=r.xScale.rangeBand()/2,r.xdomain=r.xScale.domain()):"time"===r.axis_x_data_format&&(max=d3.max(r.new_data,function(t){return d3.max(t.data,function(t){return t.x})}),min=d3.min(r.new_data,function(t){return d3.min(t.data,function(t){return t.x})}),m=[min,max],c=[0,r.reducedWidth],u=d3.min(r.x_tick_values,function(t){return t=r.k.dateConversion(t)}),h=d3.max(r.x_tick_values,function(t){return t=r.k.dateConversion(t)}),m[0]>u&&(m[0]=u),m[1]<h&&(m[1]=h),r.xScale=r.k.scaleIdentification("time",m,c),r.extra_left_margin=0,r.new_data[0].data.forEach(function(t){r.xdomain.push(t.x)})),r.count=1,r.zoom_event=d3.behavior.zoom(),"string"!==r.axis_y_data_format&&"string"!==r.axis_x_data_format?r.zoom_event.x(r.xScale).y(r.yScale).scale(r.count).on("zoom",r.zoomed):r.zoom_event.y(r.yScale).scale(r.count).on("zoom",r.zoomed),PykCharts["boolean"](r.zoom_enable)&&"default"===r.mode){PykCharts["boolean"](r.panels_enable)?(n=r.new_data_length,j=0):(n=2,j=1);for(var f=j;f<n;f++)d3.selectAll(r.selector+" #"+r.container_id+"-"+f).call(r.zoom_event),d3.selectAll(r.selector+" #"+r.container_id+"-"+f).on("wheel.zoom",null).on("mousewheel.zoom",null)}r.chart_path=d3.svg.line().x(function(t){return r.xScale(t.x)}).y(function(t){return r.yScale(t.y)}).interpolate(r.interpolate);var x="lineChart"===r.type?"lineChart":"yes"===r.panels_enable?"panels_of_line":"multi_series_line";if(r.chartPathClass="lineChart"===r.type?"line":"multi-line","liveData"===t&&"lineChart"===r.type){for(var f=0;f<r.new_data_length;f++){var y=r.new_data[f].data,v=r.type+"-svg-"+f;r.svgContainer.select(r.selector+" #"+v).datum(r.new_data[f].data).attr("transform","translate("+r.extra_left_margin+",0)").style("stroke",function(){return r.new_data[f].highlight&&"multilineChart"===r.type&&!r.clicked?r.highlightLine(this,null):r.clicked?r.highlightLine(r.selected,null,r.previous_color):d3.select(this).classed({"multi-line-selected":!1,"multi-line":!0,"multi-line-hover":!1}),r.fillColor.colorPieMS(r.new_data[f],r.type)}).attr("data-id",function(t,e){return r.new_data[e]}),a(f),d3.selectAll(r.selector+" text#"+(r.type+"-svg-"+f)).style("fill",function(){return r.fillColor.colorPieMS(r.new_data[f],r.type)})}"default"===r.mode&&r.svgContainer.on("mouseout",function(t){r.mouseEvent.tooltipHide(),r.mouseEvent.crossHairHide(r.type),r.mouseEvent.axisHighlightHide(r.selector+" .x.axis"),r.mouseEvent.axisHighlightHide(r.selector+" .y.axis")}).on("mousemove",function(){r.mouseEvent.crossHairPosition(r.new_data,r.xScale,r.yScale,r.dataLineGroup,r.extra_left_margin,r.xdomain,x,r.tooltipMode,null,r.container_id)})}else{if(r.clk=!0,PykCharts["boolean"](r.panels_enable))y=r.new_data[e].data,v=r.type+r.svgContainer.attr("id"),r.dataLineGroup[0]=r.chartBody.append("path"),r.dataLineGroup[0].datum(r.new_data1.data).attr({"class":"lines-hover "+r.chartPathClass,id:v,transform:"translate("+r.extra_left_margin+",0)","stroke-opacity":function(){return"saturation"===r.color_mode?(e+1)/r.new_data.length:1},"path-stroke-opacity":function(){return d3.select(this).attr("stroke-opacity")},"data-id":function(t,e){return r.new_data[e]}}).style("stroke",function(){return r.new_data[e].highlight&&r.highlightLine(this,null),r.fillColor.colorPieMS(r.new_data[e],r.type)}).on({click:function(t){"default"===r.mode&&(r.clicked=!0,r.highlightLine(PykCharts.getEvent().target,r.clicked,r.previous_color))},mouseover:function(t){this===r.selected||"saturation"!==r.color_mode&&!r.hover||"default"!==r.mode||(r.previous_color=d3.select(this).attr("stroke-opacity"),r.click_color=d3.select(this).style("stroke"),d3.select(this).classed({"multi-line-hover":!0,"multi-line":!1}).style("stroke","orange"))},mouseout:function(t,a){this===r.selected||"saturation"!==r.color_mode&&!r.hover||"default"!==r.mode||d3.select(this).classed({"multi-line-hover":!1,"multi-line":!0}).style("stroke",function(){return r.new_data[e].highlight&&r.highlightLine(this,null,r.previous_color),r.click_color}).attr("stroke-opacity",function(){return"saturation"===r.color_mode?r.previous_color:1})}}),i(e);else for(var f,f=0;f<r.new_data_length;f++){var v=r.type+"-svg-"+f;r.dataLineGroup[f]=r.chartBody.append("path");var y=r.new_data[f].data;r.dataLineGroup[f].datum(r.new_data[f].data).attr({"class":"lines-hover "+r.chartPathClass,id:v,transform:"translate("+r.extra_left_margin+",0)","stroke-opacity":function(){return"saturation"===r.color_mode?(f+1)/r.new_data.length:1},"path-stroke-opacity":function(){return d3.select(this).attr("stroke-opacity")}}).style("stroke",function(){return r.new_data[f].highlight&&r.highlightLine(this,null),r.fillColor.colorPieMS(r.new_data[f],r.type)}),o(f)}"lineChart"===r.type&&"default"===r.mode?r.svgContainer.on("mouseout",function(t){r.mouseEvent.tooltipHide(),r.mouseEvent.crossHairHide(r.type),r.mouseEvent.axisHighlightHide(r.selector+" .x.axis"),r.mouseEvent.axisHighlightHide(r.selector+" .y.axis")}).on("mousemove",function(){r.mouseEvent.crossHairPosition(r.new_data,r.xScale,r.yScale,r.dataLineGroup,r.extra_left_margin,r.xdomain,x,r.tooltipMode,null,r.container_id)}):"multilineChart"===r.type&&"default"===r.mode&&r.svgContainer.on("mouseout",function(t){r.mouseEvent.tooltipHide(null,r.panels_enable,r.type),r.mouseEvent.crossHairHide(r.type),r.mouseEvent.axisHighlightHide(r.selector+" .x.axis"),r.mouseEvent.axisHighlightHide(r.selector+" .y.axis")}).on("mousemove",function(){var t=[];t[0]=d3.select(r.selector+" #"+this.id+" .lines-hover"),r.mouseEvent.crossHairPosition(r.new_data,r.xScale,r.yScale,t,r.extra_left_margin,r.xdomain,x,r.tooltipMode,r.panels_enable,r.container_id,r.no_of_containers_in_row)})}return this},ticks:function(t){function e(){r.ticks.text(function(t,e){return t.name}).text(function(t,e){return r.ticks_text_width[e]=this.getBBox().width,t.name}).attr({dx:5,dy:5}).style({"font-size":r.pointer_size+"px","font-weight":function(t){return t.highlight?"bold":r.pointer_weight},"font-family":r.pointer_family,visibility:"visible",fill:function(t,e){return r.fillColor.colorPieMS(r.new_data[e],r.type)},"pointer-events":"none"})}if(PykCharts["boolean"](r.pointer_size))if(PykCharts["boolean"](r.panels_enable)){var a=r.type+r.svgContainer.attr("id");"bottom"!==r.axis_x_position||"left"!==r.axis_y_position&&"right"!==r.axis_y_position?"top"!==r.axis_x_position||"left"!==r.axis_y_position&&"right"!==r.axis_y_position||(r.ticks[0]=r.svgContainer.append("text").attr({id:a,x:r.w-r.chart_margin_left,y:r.chart_height-r.chart_margin_bottom,dy:10,"text-anchor":"end"}).style({"font-size":r.pointer_size+"px","font-weight":r.pointer_weight,"font-family":r.pointer_family,fill:function(){return r.fillColor.colorPieMS(r.new_data1,r.type)}}).html(r.new_data1.name)):r.ticks[0]=r.svgContainer.append("text").attr({id:a,x:r.chart_margin_left,y:r.chart_margin_top,dy:-5}).style({"font-size":r.pointer_size+"px","font-weight":r.pointer_weight,"font-family":r.pointer_family,fill:function(){return r.fillColor.colorPieMS(r.new_data1,r.type)}}).html(r.new_data1.name)}else r.ticks_text_width=[],tickPosition=function(t,e){var a,n;return"left"===r.axis_y_position?(a=r.xScale(r.new_data[e].data[r.new_data[e].data.length-1].x)+r.extra_left_margin+r.chart_margin_left,n=r.yScale(r.new_data[e].data[r.new_data[e].data.length-1].y)+r.chart_margin_top):"right"===r.axis_y_position&&(a=r.xScale(r.new_data[e].data[0].x)+r.extra_left_margin+r.chart_margin_left-10,n=r.yScale(r.new_data[e].data[0].y)+r.chart_margin_top),text_x=a,text_y=n,text_rotate=0,"translate("+text_x+","+text_y+") rotate("+text_rotate+")"},orient=function(){return"left"===r.axis_y_position?"start":"right"===r.axis_y_position?"end":void 0},r.ticks=r.svgContainer.selectAll(".legend-heading").data(r.new_data),r.ticks.enter().append("text"),r.ticks.attr({id:function(t,e){return r.type+"-svg-"+e},"class":"legend-heading",transform:tickPosition,"text-anchor":orient}),r.ticks.text(function(t,e){return""}),setTimeout(e,r.transitions.duration()),r.ticks.exit().remove();return this}};return e},r.zoomed=function(){if(PykCharts["boolean"](r.panels_enable))for(var t=0;t<r.new_data_length;t++){var e=r.type;currentContainer=d3.selectAll("#"+r.container_id+"-"+t),r.k.isOrdinal(currentContainer,".x.axis",r.xScale,r.xdomain,r.extra_left_margin),r.k.isOrdinal(currentContainer,".x.grid",r.xScale),r.k.isOrdinal(currentContainer,".y.axis",r.yScale,r.ydomain),r.k.isOrdinal(currentContainer,".y.grid",r.yScale),currentContainer.select("#"+e+r.container_id+"-"+t).attr({"class":"lines-hover "+r.chartPathClass,d:r.chart_path})}else{PykCharts["boolean"](r.pointer_overflow_enable)&&r.svgContainer.style("overflow","hidden"),r.k.isOrdinal(r.svgContainer,".x.axis",r.xScale,r.xdomain,r.extra_left_margin),r.k.isOrdinal(r.svgContainer,".x.grid",r.xScale),r.k.isOrdinal(r.svgContainer,".y.axis",r.yScale,r.ydomain),r.k.isOrdinal(r.svgContainer,".y.grid",r.yScale);for(var t=0;t<r.new_data_length;t++){var e=r.type+"-svg-"+t;r.svgContainer.select(r.selector+" #"+e).attr({"class":"lines-hover "+r.chartPathClass,d:r.chart_path})}}"dblclick"===PykCharts.getEvent().sourceEvent.type&&r.count++,r.mouseEvent.tooltipHide(),r.mouseEvent.crossHairHide(r.type),r.mouseEvent.axisHighlightHide(r.selector+" .x.axis"),r.mouseEvent.axisHighlightHide(r.selector+" .y.axis"),r.count===r.zoom_level+1&&r.zoomOut(),PykCharts["boolean"](r.annotation_enable)&&r.annotation(),r.optionalFeature().ticks()},r.zoomOut=function(){if(PykCharts["boolean"](r.pointer_overflow_enable)&&!PykCharts["boolean"](r.panels_enable)&&r.svgContainer.style("overflow","visible"),PykCharts["boolean"](r.panels_enable)){for(var t=0;t<r.previous_length;t++){var e=document.querySelector(r.selector+" #panels_of_line_main_div #chart-container-"+t);e.parentNode.removeChild(e)}r.renderPanelOfLines()}"lineChart"===r.type?r.optionalFeature().createChart("liveData"):"multilineChart"!==r.type||PykCharts["boolean"](r.panels_enable)||(document.querySelector(r.selector+" #chart-container-1").innerHTML=null,r.renderLineChart()),r.k.isOrdinal(r.svgContainer,".x.axis",r.xScale,r.xdomain,r.extra_left_margin),r.k.isOrdinal(r.svgContainer,".x.grid",r.xScale),r.k.isOrdinal(r.svgContainer,".y.axis",r.yScale,r.ydomain),r.k.isOrdinal(r.svgContainer,".y.grid",r.yScale)},r.onBrush=function(t,e){r.addEvents(t,e)},r.highlightLine=function(t,e,a){r.selected_line=t,r.selected_line_data=r.selected_line.__data__,r.selected_line_data_len=r.selected_line_data.length,r.deselected=r.selected,r.selected=t,"multilineChart"!==r.type||"saturation"!==r.color_mode&&!r.hover||d3.select(r.selected).style("stroke",function(t,e){return r.click_color}),e&&(d3.select(r.selected).classed("multi-line")?(d3.selectAll(r.selector+" path.multi-line").attr("stroke-opacity",.3),"color"===r.color_mode&&d3.selectAll(r.selector+" .legend-heading").style("opacity",.3),d3.select(r.selector+" text#"+r.selected.id).style("opacity",1).style("font-weight","bold"),d3.selectAll(".lines-hover").attr("stroke-opacity",.3).classed({"multi-line-selected":!1,"multi-line":!0
}),d3.select(r.selected).attr("stroke-opacity",1).classed({"multi-line-selected":!0,"multi-line":!1})):("color"===r.color_mode?d3.selectAll(r.selector+" path.multi-line").attr("stroke-opacity",a):d3.selectAll(r.selector+" path.multi-line").attr("stroke-opacity",function(){return d3.select(this).attr("path-stroke-opacity")}),d3.selectAll(r.selector+" .legend-heading").style("opacity",1),d3.select(r.selector+" text#"+r.selected.id).style({opacity:1,"font-weight":"normal"}),d3.select(r.selected).attr("stroke-opacity",a).classed({"multi-line-selected":!1,"multi-line":!0})))},r.annotation=function(){function t(t,e){function a(){o.attr("class","PykCharts-annotation-line").attr("d",function(t,e){var a=[{x:parseInt(r.xScale(t.x)-.5*n)+r.extra_left_margin+r.chart_margin_left,y:parseInt(r.yScale(t.y)-n+r.chart_margin_top)},{x:parseInt(r.xScale(t.x)+.5*n)+r.extra_left_margin+r.chart_margin_left,y:parseInt(r.yScale(t.y)-n+r.chart_margin_top)},{x:parseInt(r.xScale(t.x))+r.extra_left_margin+r.chart_margin_left,y:parseInt(r.yScale(t.y)+r.chart_margin_top)}];return r.line(a)}).attr("fill",r.annotation_background_color)}var o=d3.select(r.selector+" #"+r.container_id+"-"+e).selectAll(r.selector+" .PykCharts-annotation-line").data(t);o.enter().append("path"),o.attr("d",function(t,e){var a=[{x:parseInt(r.xScale(t.x))+r.extra_left_margin+r.chart_margin_left,y:parseInt(r.yScale(t.y)-n+r.chart_margin_top)},{x:parseInt(r.xScale(t.x))+r.extra_left_margin+r.chart_margin_left,y:parseInt(r.yScale(t.y)-n+r.chart_margin_top)}];return r.line(a)}),setTimeout(a,r.transitions.duration()),o.exit().remove()}if(r.line=d3.svg.line().interpolate("linear-closed").x(function(t,e){return t.x}).y(function(t,e){return t.y}),PykCharts["boolean"](r.panels_enable)){if(PykCharts["boolean"](r.panels_enable))for(var e=0;e<r.new_data_length;e++){var a=[],n=12;r.new_data[e].data.map(function(t){t.annotation&&a.push({annotation:t.annotation,x:t.x,y:t.y})}),t(a,e),r.k.annotation(r.selector+" #"+r.container_id+"-"+e,a,r.xScale,r.yScale)}}else{for(var n=12,a=[],e=0;e<r.new_data_length;e++)r.new_data[e].data.map(function(t){t.annotation&&a.push({annotation:t.annotation,x:t.x,y:t.y})});t(a,1),r.k.annotation(r.selector+" #svg-1",a,r.xScale,r.yScale)}},r.renderPanelOfLines=function(){for(var t=0;t<r.new_data_length;t++){var e=r.selector.substr(1,r.selector.length);d3.selectAll("#tooltip-svg-container-"+t+"-pyk-tooltip"+e).remove(),r.k.makeMainDiv(r.selector+" #panels_of_line_main_div",t).tooltip(!0,r.selector,t),r.new_data1=r.new_data[t],r.fill_data[0]=r.new_data1,r.optionalFeature().svgContainer(t).createGroups(t),r.k.crossHair(r.svgContainer,1,r.fill_data,r.fillColor,r.type),r.mouseEvent=new PykCharts.crossHairMovement(r),r.optionalFeature().createChart(null,t).ticks(t).axisContainer(),r.k.xAxis(r.svgContainer,r.xGroup,r.xScale,r.extra_left_margin,r.xdomain,r.x_tick_values).yAxis(r.svgContainer,r.yGroup,r.yScale,r.ydomain,r.y_tick_values).xAxisTitle(r.xGroup).yAxisTitle(r.yGroup),"default"===r.mode&&r.k.yGrid(r.svgContainer,r.group,r.yScale).xGrid(r.svgContainer,r.group,r.xScale)}r.k.exportSVG(r,r.container_id+"-","lineChart",r.panels_enable,r.new_data),r.k.emptyDiv(r.selector)},r.renderLineChart=function(){function t(){PykCharts["boolean"](r.pointer_size)&&(e=d3.max(r.ticks_text_width,function(t){return t})),r.k.exportSVG(r,"#"+r.container_id+"-1","lineChart",void 0,void 0,e)}r.optionalFeature().svgContainer(1).createGroups(1).hightLightOnload(),r.k.crossHair(r.svgContainer,r.new_data_length,r.new_data,r.fillColor,r.type),r.mouseEvent=new PykCharts.crossHairMovement(r),r.optionalFeature().createChart().ticks().axisContainer(),r.k.xAxis(r.svgContainer,r.xGroup,r.xScale,r.extra_left_margin,r.xdomain,r.x_tick_values).yAxis(r.svgContainer,r.yGroup,r.yScale,r.ydomain,r.y_tick_values).xAxisTitle(r.xGroup).yAxisTitle(r.yGroup),PykCharts["boolean"](r.interactive_enable)&&(r.brush=new PykCharts.Configuration.renderBrush(r,r.xScale,r.group,r.reducedHeight)),"default"===r.mode&&r.k.yGrid(r.svgContainer,r.group,r.yScale).xGrid(r.svgContainer,r.group,r.xScale);var e=0;setTimeout(t,r.transitions.duration())},r.dataTransformation(),r.render()},PykCharts.multiD.area=function(t){var e=this;e.interval="";var a=new PykCharts.Configuration.Theme({});this.execute=function(r){if(e=new PykCharts.validation.processInputs(e,t,"multiDimensionalCharts"),PykCharts.crossHair(e),PykCharts.annotation(e),PykCharts.scaleFunction(e),PykCharts.grid(e),e.k.storeInitialDivHeight(),!e.stop){"default"===e.mode&&e.k.loading();var n=a.multiDimensionalCharts;a.stylesheet,t.optional;e.crosshair_enable=t.crosshair_enable?t.crosshair_enable.toLowerCase():n.crosshair_enable,e.curvy_lines_enable=t.curvy_lines_enable?t.curvy_lines_enable.toLowerCase():n.curvy_lines_enable,e.panels_enable="no",e.interpolate=PykCharts["boolean"](e.curvy_lines_enable)?"cardinal":"linear",e.w=e.chart_width-e.chart_margin_left-e.chart_margin_right,e.h=e.chart_height-e.chart_margin_top-e.chart_margin_bottom,e.executeData=function(a){var r=e.k.validator().validatingJSON(a),n=e.selector.substring(1,e.selector.length);return e.stop||r===!1?void e.k.remove_loading_bar(n):(e.data=e.k.__proto__._groupBy("area",a),e.axis_y_data_format="number",e.axis_x_data_format=e.k.xAxisDataFormatIdentification(e.data),"time"===e.axis_x_data_format&&""===e.axis_x_time_value_datatype&&console.warn("%c[Warning - Pykih Charts] ","color: #F8C325;font-weight:bold;font-size:14px"," at "+e.selector+'.("You seem to have passed Date data so please pass the value for axis_x_time_value_datatype")  Visit www.pykcharts.com/errors#warning_15'),e.compare_data=e.data,e.data_length=e.data.length,e.k.remove_loading_bar(n),"string"===e.axis_x_data_format?e.data_sort_enable="no":(e.data_sort_enable="yes",e.data_sort_type="time"===e.axis_x_data_format?"date":"numerically",e.data_sort_order="ascending"),PykCharts.multiD.areaFunctions(t,e,"area"),e.dataTransformation(),void e.render())},PykCharts["boolean"](e.interactive_enable)?(e.k.dataFromPykQuery(r),e.k.dataSourceFormatIdentification(e.data,e,"executeData")):e.k.dataSourceFormatIdentification(t.data,e,"executeData")}}},PykCharts.multiD.stackedArea=function(t){var e=this;e.interval="";var a=new PykCharts.Configuration.Theme({});this.execute=function(r){if(e=new PykCharts.validation.processInputs(e,t,"multiDimensionalCharts"),PykCharts.crossHair(e),PykCharts.annotation(e),PykCharts.scaleFunction(e),PykCharts.grid(e),!e.stop){e.k.storeInitialDivHeight(),"default"===e.mode&&e.k.loading();var n=a.multiDimensionalCharts;a.stylesheet,t.optional;e.crosshair_enable=t.crosshair_enable?t.crosshair_enable.toLowerCase():n.crosshair_enable,e.curvy_lines_enable=t.curvy_lines_enable?t.curvy_lines_enable.toLowerCase():n.curvy_lines_enable,e.panels_enable="no",e.interpolate=PykCharts["boolean"](e.curvy_lines_enable)?"cardinal":"linear",e.w=e.chart_width-e.chart_margin_left-e.chart_margin_right,e.h=e.chart_height-e.chart_margin_top-e.chart_margin_bottom,e.executeData=function(a){var r=e.k.validator().validatingJSON(a),n=e.selector.substring(1,e.selector.length);return e.stop||r===!1?void e.k.remove_loading_bar(n):(e.data=e.k.__proto__._groupBy("area",a),e.axis_y_data_format="number",e.axis_x_data_format=e.k.xAxisDataFormatIdentification(e.data),"time"===e.axis_x_data_format&&""===e.axis_x_time_value_datatype&&console.warn("%c[Warning - Pykih Charts] ","color: #F8C325;font-weight:bold;font-size:14px"," at "+e.selector+'.("You seem to have passed Date data so please pass the value for axis_x_time_value_datatype")  Visit www.pykcharts.com/errors#warning_15'),e.compare_data=e.data,e.data_length=e.data.length,e.k.remove_loading_bar(n),"string"===e.axis_x_data_format?e.data_sort_enable="no":(e.data_sort_enable="yes",e.data_sort_type="time"===e.axis_x_data_format?"date":"numerically",e.data_sort_order="ascending"),PykCharts.multiD.areaFunctions(t,e,"stacked_area"),e.dataTransformation(),void e.render())},PykCharts["boolean"](e.interactive_enable)?(e.k.dataFromPykQuery(r),e.k.dataSourceFormatIdentification(e.data,e,"executeData")):e.k.dataSourceFormatIdentification(t.data,e,"executeData")}}},PykCharts.multiD.areaFunctions=function(t,e,a){var r=e;r.dataTransformation=function(){r.group_arr=[],r.new_data=[],r.ticks=[],r.x_arr=[];for(var t=0;t<r.data_length;t++)r.group_arr[t]=r.data[t].name;r.uniq_group_arr=r.k.__proto__._unique(r.group_arr),r.uniq_color_arr=[];for(var e=r.uniq_group_arr.length,a=0;a<r.data_length;a++)r.x_arr[a]=r.data[a].x;r.uniq_x_arr=r.k.__proto__._unique(r.x_arr);for(var a=0;e>a;a++)if(r.chart_color[a])r.uniq_color_arr[a]=r.chart_color[a];else{for(var n=0;n<r.data_length;n++)if(r.uniq_group_arr[a]===r.data[n].name&&r.data[n].color){r.uniq_color_arr[a]=r.data[n].color;break}PykCharts["boolean"](r.uniq_color_arr[a])||(r.uniq_color_arr[a]=r.default_color[0])}r.flag=0;for(var a=0;e>a;a++){r.new_data[a]={name:r.uniq_group_arr[a],data:[],color:r.uniq_color_arr[a]};for(var n=0;n<r.data_length;n++)r.uniq_group_arr[a]===r.data[n].name&&r.new_data[a].data.push({x:r.data[n].x,y:r.data[n].y,tooltip:r.data[n].tooltip,annotation:r.data[n].annotation||""})}r.new_data_length=r.new_data.length;for(var o=r.uniq_x_arr.length,i=0;i<r.new_data_length;i++){for(var l=r.k.__proto__._unique(r.x_arr),s=r.new_data[i].data.length,_=0;s>_;_++)for(var a=0;o>a;a++)if(r.new_data[i].data[_].x===l[a]){l[a]=void 0;break}for(var c=0;o>c;c++)if(void 0!=l[c]){var d={x:l[c],y:0,tooltip:0,annotation:""};r.new_data[i].data.splice(c,0,d)}}for(var a=0;a<r.new_data_length;a++)r.new_data[a].data=r.k.__proto__._sortData(r.new_data[a].data,"x","name",r)},r.render=function(){var e=r.selector.substring(1,r.selector.length);r.container_id=e+"_svg",r.dataLineGroup=[],r.dataLineGroupBorder=[],r.multid=new PykCharts.multiD.configuration(r),r.fillColor=new PykCharts.Configuration.fillChart(r,null,t),r.transitions=new PykCharts.Configuration.transition(r),r.border=new PykCharts.Configuration.border(r),r.xdomain=[],r.optional_feature().chartType();try{if("stackedAreaChart"===r.type&&"area"===a)throw"Invalid data in the JSON"}catch(n){return void console.error("%c[Error - Pykih Charts] ","color: red;font-weight:bold;font-size:14px"," at "+r.selector+'."'+n+'"  Visit www.pykcharts.com/errors#error_7')}if("time"===r.axis_x_data_format)for(var o=0;o<r.new_data_length;o++)r.new_data[o].data.forEach(function(t){t.x=r.k.dateConversion(t.x),r.xdomain.push(t.x)}),r.data.forEach(function(t){t.x=r.k.dateConversion(t.x)});if("default"===r.mode){var i=r.selector.substr(1,r.selector.length);d3.selectAll("#tooltip-svg-container-1-pyk-tooltip"+i).remove(),r.k.title().backgroundColor(r)["export"](r,"#"+r.container_id+"-1","areaChart").liveData(r).emptyDiv(r.selector).subtitle().makeMainDiv(r.selector,1).tooltip(!0,r.selector,1),r.renderChart(),r.k.xAxis(r.svgContainer,r.xGroup,r.xScale,r.extra_left_margin,r.xdomain,r.x_tick_values,r.legendsGroup_height).yAxis(r.svgContainer,r.yGroup,r.yScale,r.ydomain,r.y_tick_values,r.legendsGroup_width).yGrid(r.svgContainer,r.group,r.yScale,r.legendsGroup_width).xGrid(r.svgContainer,r.group,r.xScale,r.legendsGroup_height).xAxisTitle(r.xGroup,r.legendsGroup_height,r.legendsGroup_width).yAxisTitle(r.yGroup).createFooter().lastUpdatedAt().credits().dataSource(),PykCharts["boolean"](r.annotation_enable)&&r.annotation()}else"infographics"===r.mode&&(r.k.backgroundColor(r)["export"](r,"#"+r.container_id+"-1","areaChart").emptyDiv(r.selector).makeMainDiv(r.selector,1),r.optional_feature().svgContainer(1).legendsContainer().createGroups(1).createChart().axisContainer(),r.k.xAxis(r.svgContainer,r.xGroup,r.xScale,r.extra_left_margin,r.xdomain,r.x_tick_values,r.legendsGroup_height).yAxis(r.svgContainer,r.yGroup,r.yScale,r.ydomain,r.y_tick_values,r.legendsGroup_width).xAxisTitle(r.xGroup,r.legendsGroup_height,r.legendsGroup_width).yAxisTitle(r.yGroup));PykCharts["boolean"](r.interactive_enable)&&(r.brush=new PykCharts.Configuration.renderBrush(r,r.xScale,r.group,r.h)),r.k.exportSVG(r,"#"+r.container_id+"-1","areaChart"),r.mouseEvent=new PykCharts.crossHairMovement(r);var l=r.k.resize(r.svgContainer);r.k.__proto__._ready(l),window.addEventListener("resize",function(t){return r.k.resize(r.svgContainer)})},r.refresh=function(e){r.xdomain=[],r.executeRefresh=function(t){r.data=r.k.__proto__._groupBy("area",t),r.data_length=r.data.length,r.dataTransformation();var e=r.k.checkChangeInData(r.data,r.compare_data);r.compare_data=e[0];var a=e[1];if((a||PykCharts["boolean"](r.zoom_enable)&&r.count>1&&r.count<=r.zoom_level||r.transition_duration)&&(r.k.lastUpdatedAt("liveData"),r.mouseEvent.tooltipHide(),r.mouseEvent.crossHairHide(r.type),r.mouseEvent.axisHighlightHide(r.selector+" .x.axis"),r.mouseEvent.axisHighlightHide(r.selector+" .y.axis")),"time"===r.axis_x_data_format)for(var n=0;n<r.new_data_length;n++)r.new_data[n].data.forEach(function(t){t.x=r.k.dateConversion(t.x),r.xdomain.push(t.x)}),r.data.forEach(function(t){t.x=r.k.dateConversion(t.x)});"stackedAreaChart"===r.type?(document.querySelector(r.selector+" #chart-container-1").innerHTML=null,r.renderChart()):r.optional_feature().createChart("liveData"),r.k.xAxis(r.svgContainer,r.xGroup,r.xScale,r.extra_left_margin,r.xdomain,r.x_tick_values,r.legendsGroup_height).yAxis(r.svgContainer,r.yGroup,r.yScale,r.ydomain,r.y_tick_values,r.legendsGroup_width).yGrid(r.svgContainer,r.group,r.yScale,r.legendsGroup_width).xGrid(r.svgContainer,r.group,r.xScale,r.legendsGroup_height),PykCharts["boolean"](r.annotation_enable)&&r.annotation()},PykCharts["boolean"](r.interactive_enable)?(r.k.dataFromPykQuery(e),r.k.dataSourceFormatIdentification(r.data,r,"executeRefresh")):r.k.dataSourceFormatIdentification(t.data,r,"executeRefresh")},r.optional_feature=function(){var t=r.selector.substring(1,r.selector.length),e={chartType:function(){for(var t=1;t<r.data_length;t++)if(r.data[0].x===r.data[t].x){r.type="stackedAreaChart";break}return r.type=r.type||"areaChart",this},svgContainer:function(e){var a=document.getElementById(t);return a.classList.contains("PykCharts-line-chart")||(a.className+=" PykCharts-twoD PykCharts-line-chart PykCharts-multi-series2D"),r.svgContainer=d3.select(r.selector+" #chart-container-"+e).append("svg:svg").attr({id:r.container_id+"-"+e,width:r.chart_width,height:r.chart_height,"class":"svgcontainer",preserveAspectRatio:"xMinYMin",viewBox:"0 0 "+r.chart_width+" "+r.chart_height}),this},createGroups:function(t){return r.group=r.svgContainer.append("g").attr({id:r.type+"-group",transform:"translate("+r.chart_margin_left+","+(r.chart_margin_top+r.legendsGroup_height)+")"}),PykCharts["boolean"](r.chart_grid_y_enable)&&r.group.append("g").attr({id:"ygrid","class":"y grid-line"}),PykCharts["boolean"](r.chart_grid_x_enable)&&r.group.append("g").attr({id:"xgrid","class":"x grid-line"}),r.clip=r.svgContainer.append("svg:clipPath").attr("id","clip"+t+r.selector).append("svg:rect").attr({width:r.w-r.legendsGroup_width,height:r.h-r.legendsGroup_height}),r.chartBody=r.svgContainer.append("g").attr({id:"clipPath","clip-path":"url(#clip"+t+r.selector+" )",transform:"translate("+r.chart_margin_left+","+(r.chart_margin_top+r.legendsGroup_height)+")"}),r.stack_layout=d3.layout.stack().values(function(t){return t.data}),this},legendsContainer:function(t){return PykCharts["boolean"](r.legends_enable)&&"stackedAreaChart"===r.type&&"default"===r.mode?r.legendsGroup=r.svgContainer.append("g").attr("id","stackedArea-legends").style("visibility","visible").attr("transform","translate(0,10)"):(r.legendsGroup_height=0,r.legendsGroup_width=0),this},axisContainer:function(){return(PykCharts["boolean"](r.axis_x_enable)||r.axis_x_title)&&(r.xGroup=r.group.append("g").attr({id:"xaxis","class":"x axis"})),(PykCharts["boolean"](r.axis_y_enable)||r.axis_y_title)&&(r.yGroup=r.group.append("g").attr({id:"yaxis","class":"y axis"})),this},createChart:function(t){function e(t){r.dataLineGroup[t].transition().duration(r.transitions.duration()).attrTween("d",function(e){var a=d3.scale.quantile().domain([0,1]).range(d3.range(1,x.length+1));return function(e){return r.chart_path(r.new_data[t].data.slice(0,a(e)))}})}function n(t){r.dataLineGroupBorder[t].transition().duration(r.transitions.duration()).attrTween("d",function(e){var a=d3.scale.quantile().domain([0,1]).range(d3.range(1,r.layers[t].data.length+1));return function(e){return r.chart_path_border(r.layers[t].data.slice(0,a(e)))}})}function o(t){r.dataLineGroup[t].transition().duration(r.transitions.duration()).attrTween("d",function(e){var a=d3.scale.quantile().domain([0,1]).range(d3.range(1,x.length+1));return function(e){return r.chart_path(r.new_data[t].data.slice(0,a(e)))}})}function i(t){r.dataLineGroupBorder[t].transition().duration(r.transitions.duration()).attrTween("d",function(e){var a=d3.scale.quantile().domain([0,1]).range(d3.range(1,r.layers[t].data.length+1));return function(e){return r.chart_path_border(r.layers[t].data.slice(0,a(e)))}})}r.legend_text=[],r.layers=r.stack_layout(r.new_data);var l,s,_,c,d,u,h,p,g,m=[];if(r.count=1,r.x_tick_values=r.k.processXAxisTickValues(),r.y_tick_values=r.k.processYAxisTickValues(),"number"===r.axis_y_data_format?(max=d3.max(r.layers,function(t){return d3.max(t.data,function(t){return t.y0+t.y})}),min=0,d=[min,max],s=r.k.__proto__._domainBandwidth(d,1),_=[r.h-r.legendsGroup_height,0],p=d3.min(r.y_tick_values),g=d3.max(r.y_tick_values),s[0]>p&&(s[0]=p),s[1]<g&&(s[1]=g),r.yScale=r.k.scaleIdentification("linear",s,_)):"string"===r.axis_y_data_format?(r.new_data[0].data.forEach(function(t){s.push(t.y)}),_=[0,r.h],r.yScale=r.k.scaleIdentification("ordinal",s,_,0)):"time"===r.axis_y_data_format&&(r.layers.data.forEach(function(t){t.y0=new Date(t.y0),t.y=new Date(t.y)}),max=d3.max(r.layers,function(t){return d3.max(t.data,function(t){return t.y0+t.y})}),min=0,s=[min,max],_=[r.h,0],p=d3.min(r.y_tick_values,function(t){return new Date(t)}),g=d3.max(r.y_tick_values,function(t){return new Date(t)}),new Date(s[0])>new Date(p)&&(s[0]=p),new Date(s[1])<new Date(g)&&(s[1]=g),r.yScale=r.k.scaleIdentification("time",s,_)),"number"===r.axis_x_data_format?(max=d3.max(r.new_data,function(t){return d3.max(t.data,function(t){return+t.x})}),min=d3.min(r.new_data,function(t){return d3.min(t.data,function(t){return+t.x})}),l=[min,max],m=r.k.__proto__._domainBandwidth(l,2),c=[0,r.w-r.legendsGroup_width],u=d3.min(r.x_tick_values),h=d3.max(r.x_tick_values),m[0]>u&&(m[0]=u),m[1]<h&&(m[1]=h),r.xScale=r.k.scaleIdentification("linear",m,c),r.extra_left_margin=0,r.new_data[0].data.forEach(function(t){r.xdomain.push(+t.x)})):"string"===r.axis_x_data_format?(r.new_data[0].data.forEach(function(t){m.push(t.x)}),c=[0,r.w-r.legendsGroup_width],r.xScale=r.k.scaleIdentification("ordinal",m,c,0),r.extra_left_margin=r.xScale.rangeBand()/2,r.xdomain=r.xScale.domain()):"time"===r.axis_x_data_format&&(max=d3.max(r.new_data,function(t){return d3.max(t.data,function(t){return t.x})}),min=d3.min(r.new_data,function(t){return d3.min(t.data,function(t){return t.x})}),m=[min,max],c=[0,r.w-r.legendsGroup_width],u=d3.min(r.x_tick_values,function(t){return r.k.dateConversion(t)}),h=d3.max(r.x_tick_values,function(t){return r.k.dateConversion(t)}),new Date(m[0])>new Date(u)&&(m[0]=u),new Date(m[1])<new Date(h)&&(m[1]=h),r.xScale=r.k.scaleIdentification("time",m,c),r.extra_left_margin=0,r.new_data[0].data.forEach(function(t){r.xdomain.push(t.x)})),r.ydomain=r.yScale.domain(),r.zoom_event=d3.behavior.zoom(),"string"!==r.axis_y_data_format&&"string"!==r.axis_x_data_format?r.zoom_event.x(r.xScale).y(r.yScale).scale(r.count).on("zoom",r.zoomed):r.zoom_event.y(r.yScale).scale(r.count).on("zoom",r.zoomed),PykCharts["boolean"](r.zoom_enable)&&"default"===r.mode&&(r.svgContainer.call(r.zoom_event),r.svgContainer.on({"wheel.zoom":null,"mousewheel.zoom":null})),r.chart_path=d3.svg.area().x(function(t){return r.xScale(t.x)}).y0(function(t){return r.yScale(t.y0)}).y1(function(t){return r.yScale(t.y0+t.y)}).interpolate(r.interpolate),r.chart_path_border=d3.svg.line().x(function(t){return r.xScale(t.x)}).y(function(t){return r.yScale(t.y0+t.y)}).interpolate(r.interpolate),r.chartPathClass="areaChart"===r.type?"area":"stacked-area","liveData"===t){for(var f=0;f<r.new_data_length;f++){var x=r.new_data[f].data;a=r.chartPathClass+f,r.svgContainer.select("#"+a).datum(r.layers[f].data).attr("transform","translate("+r.extra_left_margin+",0)").style({stroke:r.border.color(),"stroke-width":r.border.width(),"stroke-dasharray":r.border.style()}),e(f),r.svgContainer.select("#border-stacked-area"+f).datum(r.layers[f].data).attr("transform","translate("+r.extra_left_margin+",0)"),n(f)}"areaChart"===r.type&&r.svgContainer.on("mouseout",function(t){r.mouseEvent.tooltipHide(),r.mouseEvent.crossHairHide(r.type),r.mouseEvent.axisHighlightHide(r.selector+" .x.axis"),r.mouseEvent.axisHighlightHide(r.selector+" .y.axis")}).on("mousemove",function(){r.mouseEvent.crossHairPosition(r.new_data,r.xScale,r.yScale,r.dataLineGroup,r.extra_left_margin,r.xdomain,r.type,r.tooltip_mode)})}else{for(var f=0;f<r.new_data_length;f++){var x=r.new_data[f].data;a=r.chartPathClass+f,r.dataLineGroup[f]=r.chartBody.append("path"),r.dataLineGroup[f].datum(r.layers[f].data).attr({"class":r.chartPathClass,id:a,"fill-opacity":function(){return"stackedAreaChart"===r.type&&"saturation"===r.color_mode?(f+1)/r.new_data.length:void 0},"data-fill-opacity":function(){return d3.select(this).attr("fill-opacity")},transform:"translate("+r.extra_left_margin+",0)","data-id":function(t,e){return r.new_data[e]}}).style("fill",function(t){return r.fillColor.colorPieMS(r.new_data[f],r.type)}),o(f),r.dataLineGroupBorder[f]=r.chartBody.append("path"),r.dataLineGroupBorder[f].datum(r.layers[f].data).attr({"class":"area-border",id:"border-stacked-area"+f,transform:"translate("+r.extra_left_margin+",0)"}).style({stroke:r.border.color(),"stroke-width":r.border.width(),"stroke-dasharray":r.border.style(),"pointer-events":"none"}),i(f)}r.svgContainer.on("mouseout",function(t){r.mouseEvent.tooltipHide(),r.mouseEvent.crossHairHide(r.type),r.mouseEvent.axisHighlightHide(r.selector+" .x.axis"),r.mouseEvent.axisHighlightHide(r.selector+" .y.axis")}).on("mousemove",function(){if("areaChart"===r.type)r.mouseEvent.crossHairPosition(r.new_data,r.xScale,r.yScale,r.dataLineGroup,r.extra_left_margin,r.xdomain,r.type,r.tooltip_mode);else if("stackedAreaChart"===r.type){var t=[];t[0]=d3.select(r.selector+" #"+this.id+" .stacked-area"),r.mouseEvent.crossHairPosition(r.new_data,r.xScale,r.yScale,t,r.extra_left_margin,r.xdomain,r.type,r.tooltipMode,r.color_from_data,"no")}})}return d3.selectAll(r.selector+" ."+r.chartPathClass).on({mouseover:function(){"default"===r.mode&&r.mouseEvent.highlight(r.selector+" ."+r.chartPathClass,this)},mouseout:function(){"default"===r.mode&&r.mouseEvent.highlightHide(r.selector+" ."+r.chartPathClass)}}),this},legends:function(){return PykCharts["boolean"](r.legends_enable)&&"stackedAreaChart"===r.type&&"default"===r.mode&&r.multid.legendsPosition(r,"stackedArea",r.new_data),this}};return e},r.zoomed=function(){for(r.k.isOrdinal(r.svgContainer,".x.axis",r.xScale,r.xdomain,r.extra_left_margin),r.k.isOrdinal(r.svgContainer,".x.grid",r.xScale),r.k.isOrdinal(r.svgContainer,".y.axis",r.yScale,r.ydomain),r.k.isOrdinal(r.svgContainer,".y.grid",r.yScale),i=0;i<r.new_data_length;i++)a=r.chartPathClass+i,r.svgContainer.select(r.selector+" #"+a).attr({"class":r.chartPathClass,d:r.chart_path}),r.svgContainer.select(r.selector+" #border-stacked-area"+i).attr({"class":"area-border",d:r.chart_path_border});"dblclick"===PykCharts.getEvent().sourceEvent.type&&r.count++,r.mouseEvent.tooltipHide(),r.mouseEvent.crossHairHide(r.type),r.mouseEvent.axisHighlightHide(r.selector+" .x.axis"),r.mouseEvent.axisHighlightHide(r.selector+" .y.axis"),r.count===r.zoom_level+1&&r.zoomOut(),PykCharts["boolean"](r.annotation_enable)&&r.annotation()},r.zoomOut=function(){r.optional_feature().createChart("liveData"),r.k.isOrdinal(r.svgContainer,".x.axis",r.xScale,r.xdomain,r.extra_left_margin),r.k.isOrdinal(r.svgContainer,".x.grid",r.xScale),r.k.isOrdinal(r.svgContainer,".y.axis",r.yScale,r.ydomain),r.k.isOrdinal(r.svgContainer,".y.grid",r.yScale)},r.onBrush=function(t,e){r.addEvents(t,e)},r.annotation=function(){function t(){n.attr("class","PykCharts-annotation-line").attr("d",function(t,a){var n=[{x:parseInt(r.xScale(t.x)-.5*e)+r.extra_left_margin+r.chart_margin_left,y:parseInt(r.yScale(t.y)-e+r.chart_margin_top+r.legendsGroup_height)},{x:parseInt(r.xScale(t.x)+.5*e)+r.extra_left_margin+r.chart_margin_left,y:parseInt(r.yScale(t.y)-e+r.chart_margin_top+r.legendsGroup_height)},{x:parseInt(r.xScale(t.x))+r.extra_left_margin+r.chart_margin_left,y:parseInt(r.yScale(t.y)+r.chart_margin_top+r.legendsGroup_height)}];return r.line(n)}).attr("fill",r.annotation_background_color)}r.line=d3.svg.line().interpolate("linear-closed").x(function(t,e){return t.x}).y(function(t,e){return t.y});var e=12,a=[];if("areaChart"===r.type)r.new_data[0].data.map(function(t){t.annotation&&a.push({annotation:t.annotation,x:t.x,y:t.y})});else if("stackedAreaChart"===r.type&&"default"===r.mode)for(i=0;i<r.new_data_length;i++)r.new_data[i].data.map(function(t){t.annotation&&a.push({annotation:t.annotation,x:t.x,y:t.y+t.y0})});var n=r.svgContainer.selectAll(" .PykCharts-annotation-line").data(a);n.enter().append("path"),n.attr("d",function(t,a){var n=[{x:parseInt(r.xScale(t.x))+r.extra_left_margin+r.chart_margin_left,y:parseInt(r.yScale(t.y)-e+r.chart_margin_top+r.legendsGroup_height)},{x:parseInt(r.xScale(t.x))+r.extra_left_margin+r.chart_margin_left,y:parseInt(r.yScale(t.y)-e+r.chart_margin_top+r.legendsGroup_height)}];return r.line(n)}),setTimeout(t,r.transitions.duration()),n.exit().remove(),r.k.annotation(r.selector+" #"+r.container_id+"-1",a,r.xScale,r.yScale)},r.renderChart=function(){r.optional_feature().svgContainer(1).legendsContainer().legends().createGroups(1).createChart().axisContainer(),r.k.crossHair(r.svgContainer,r.new_data_length,r.new_data,r.fillColor,r.type)}},PykCharts.multiD.bar=function(t){var e=this;e.interval="";var a=new PykCharts.Configuration.Theme({}),r=a.multiDimensionalCharts;this.execute=function(a){e=new PykCharts.validation.processInputs(e,t,"multiDimensionalCharts"),PykCharts.scaleFunction(e),e.data_sort_enable=t.data_sort_enable?t.data_sort_enable.toLowerCase():r.data_sort_enable,e.data_sort_type=PykCharts["boolean"](e.data_sort_enable)&&t.data_sort_type?t.data_sort_type.toLowerCase():r.data_sort_type,e.data_sort_order=PykCharts["boolean"](e.data_sort_enable)&&t.data_sort_order?t.data_sort_order.toLowerCase():r.data_sort_order;try{if("ascending"!==e.data_sort_order&&"descending"!==e.data_sort_order)throw e.data_sort_order=r.data_sort_order,"data_sort_order"}catch(n){e.k.warningHandling(n,"9")}e.stop||(e.k.storeInitialDivHeight(),e.panels_enable="no","default"===e.mode&&e.k.loading(),e.multiD=new PykCharts.multiD.configuration(e),e.executeData=function(t){var a=e.k.validator().validatingJSON(t),r=e.selector.substring(1,e.selector.length);return e.stop||a===!1?void e.k.remove_loading_bar(r):(e.data=e.k.__proto__._groupBy("bar",t),e.compare_data=e.k.__proto__._groupBy("bar",t),e.axis_x_data_format="number",e.axis_y_data_format=e.k.yAxisDataFormatIdentification(e.data),"time"===e.axis_y_data_format&&(e.axis_y_data_format="string"),e.k.remove_loading_bar(r),void e.render())},PykCharts["boolean"](e.interactive_enable)?(e.k.dataFromPykQuery(a),e.k.dataSourceFormatIdentification(e.data,e,"executeData")):e.k.dataSourceFormatIdentification(t.data,e,"executeData"))},this.transformData=function(){var a=[],r=[];if(e.optionalFeatures().sort(),void 0!=t.chart_color&&0!=t.chart_color.length)e.chart_color[0]=t.chart_color[0];else for(var n=0,o=e.data.length;o>n;n++)if(void 0!=e.data[n].color&&""!=e.data[n].color){e.chart_color[0]=e.data[n].color,(void 0==t.axis_y_pointer_color||""==t.axis_y_pointer_color)&&(e.axis_y_pointer_color=e.chart_color[0]);break}e.data.forEach(function(t){t.x="number"===e.axis_x_data_format?parseFloat(t.x):t.x,t.name=t.y,t.color=e.chart_color[0]});for(var i=0,o=e.data.length;o>i;i++)a[i]=e.data[i].group;r=e.k.__proto__._unique(a),e.no_of_groups=r.length},this.render=function(){var a=e.selector.substring(1,e.selector.length),r=a+"_svg";e.border=new PykCharts.Configuration.border(e),e.transitions=new PykCharts.Configuration.transition(e),e.mouseEvent1=new PykCharts.Configuration.mouseEvent(t),e.fillColor=new PykCharts.Configuration.fillChart(e,null,t),e.transformData();try{if(e.no_of_groups>1)throw"Invalid data in the JSON"}catch(n){return void console.error("%c[Error - Pykih Charts] ","color: red;font-weight:bold;font-size:14px"," at "+e.selector+'. "'+n+'"  Visit www.pykcharts.com/errors#error_9')}e.map_group_data=e.multiD.mapGroup(e.data),"default"===e.mode?(e.k.title().backgroundColor(e)["export"](e,"#"+r,"barChart").emptyDiv(e.selector).subtitle().makeMainDiv(e.selector,1),e.optionalFeatures().svgContainer(r,1).createGroups(),e.k.liveData(e).tooltip().createFooter().lastUpdatedAt().credits().dataSource(),e.mouseEvent=new PykCharts.Configuration.mouseEvent(e),e.optionalFeatures().createColumn().axisContainer().ticks(),e.k.xAxis(e.svgContainer,e.xgroup,e.xScale,e.extra_left_margin,e.x_domain,e.x_tick_values).xAxisTitle(e.xgroup).yAxisTitle(e.ygroup),"string"!==e.axis_y_data_format?(e.k.yAxis(e.svgContainer,e.ygroup,e.yScale,e.y_domain,e.y_tick_values,null,"bar",null,e),e.optionalFeatures().newYAxis()):e.k.yAxis(e.svgContainer,e.ygroup,e.yScale,e.y_domain,e.y_tick_values,null,null,null,e)):"infographics"===e.mode&&(e.k.backgroundColor(e)["export"](e,"#"+r,"barChart").emptyDiv(e.selector).makeMainDiv(e.selector,1),e.optionalFeatures().svgContainer(r,1).createGroups(),e.k.liveData(e).tooltip(),e.mouseEvent=new PykCharts.Configuration.mouseEvent(e),e.optionalFeatures().createColumn().axisContainer().ticks(),e.k.xAxis(e.svgContainer,e.xgroup,e.xScale,e.extra_left_margin,e.x_domain,e.x_tick_values).xAxisTitle(e.xgroup).yAxisTitle(e.ygroup),"string"!==e.axis_y_data_format?(e.k.yAxis(e.svgContainer,e.ygroup,e.yScale,e.y_domain,e.y_tick_values,null,"bar",null,e),e.optionalFeatures().newYAxis()):e.k.yAxis(e.svgContainer,e.ygroup,e.yScale,e.y_domain,e.y_tick_values,null,null,null,e)),e.k.exportSVG(e,"#"+r,"barChart");var o=e.k.resize(e.svgContainer);e.k.__proto__._ready(o),window.addEventListener("resize",function(t){return e.k.resize(e.svgContainer,"")})},this.refresh=function(a){e.executeRefresh=function(t){e.data=e.k.__proto__._groupBy("bar",t),e.refresh_data=e.k.__proto__._groupBy("bar",t);var a=e.k.checkChangeInData(e.refresh_data,e.compare_data);e.compare_data=a[0];var r=a[1];e.transformData(),"time"===e.axis_x_data_format&&e.data.forEach(function(t){t.x=e.k.dateConversion(t.x)}),e.map_group_data=e.multiD.mapGroup(e.data),r&&e.k.lastUpdatedAt("liveData"),e.optionalFeatures().createColumn().ticks(),e.k.xAxis(e.svgContainer,e.xgroup,e.xScale,e.extra_left_margin,e.x_domain,e.x_tick_values),"string"!==e.axis_y_data_format?(e.k.yAxis(e.svgContainer,e.ygroup,e.yScale,e.y_domain,e.y_tick_values,null,"bar"),e.optionalFeatures().newYAxis()):e.k.yAxis(e.svgContainer,e.ygroup,e.yScale,e.y_domain,e.y_tick_values)},PykCharts["boolean"](e.interactive_enable)?(e.k.dataFromPykQuery(a),e.k.dataSourceFormatIdentification(e.data,e,"executeRefresh")):e.k.dataSourceFormatIdentification(t.data,e,"executeRefresh")},this.optionalFeatures=function(){var t=e.selector.substring(1,e.selector.length),a={svgContainer:function(a,r){return document.getElementById(t).className+=" PykCharts-twoD",e.svgContainer=d3.select(e.selector+" #chart-container-"+r).append("svg:svg").attr({width:e.chart_width,height:e.chart_height,id:a,"class":"svgcontainer",preserveAspectRatio:"xMinYMin",viewBox:"0 0 "+e.chart_width+" "+e.chart_height}),this},createGroups:function(t){return e.group=e.svgContainer.append("g").attr({id:"bar-group",transform:"translate("+e.chart_margin_left+","+e.chart_margin_top+")"}),PykCharts["boolean"](e.chart_grid_y_enable)&&e.group.append("g").attr({id:"ygrid","class":"y grid-line"}),this},newYAxis:function(){if(PykCharts["boolean"](e.axis_y_enable)){
"right"===e.axis_y_position&&gsvg.attr("transform","translate("+(e.chart_width-e.chart_margin_left-e.chart_margin_right)+",0)");var t=d3.svg.axis().scale(e.yScale).orient(e.axis_y_pointer_position).tickSize(0).outerTickSize(e.axis_y_outer_pointer_length);e.new_yAxisgroup.style("stroke",function(){return e.axis_y_line_color}).call(t),d3.selectAll(e.selector+" .y.new-axis text").style({display:function(){return"none"},stroke:"none"})}return this},axisContainer:function(){return(PykCharts["boolean"](e.axis_x_enable)||e.axis_x_title)&&(e.xgroup=e.group.append("g").attr({id:"xaxis","class":"x axis"}).style("stroke","none")),(PykCharts["boolean"](e.axis_y_enable)||e.axis_y_title)&&(e.ygroup=e.group.append("g").attr({id:"yaxis","class":"y axis"}),e.new_yAxisgroup=e.group.append("g").attr({id:"new-yaxis","class":"y new-axis"}).style("stroke","blue")),this},createColumn:function(){e.x_tick_values=e.k.processXAxisTickValues(),e.y_tick_values=e.k.processYAxisTickValues(),e.reducedWidth=e.chart_width-e.chart_margin_left-e.chart_margin_right,e.reducedHeight=e.chart_height-e.chart_margin_top-e.chart_margin_bottom;var t,a,r,n,o,i,l,s,_=(e.chart_height-e.chart_margin_top-e.chart_margin_bottom,[]),c=[];"number"===e.axis_y_data_format?(n=[0,d3.max(e.data,function(t){return t.y})],c=e.k._domainBandwidth(n,1),a=[e.chart_height-e.chart_margin_top-e.chart_margin_bottom,0],l=d3.min(e.y_tick_values),s=d3.max(e.y_tick_values),c[0]>l&&(c[0]=l),c[1]<s&&(c[1]=s),e.data.sort(function(t,e){return t.y-e.y}),e.yScale1=e.k.scaleIdentification("linear",c,a),y_data1=e.data.map(function(t){return t.y}),y_range1=[0,e.chart_height-e.chart_margin_top-e.chart_margin_bottom],e.yScale=e.k.scaleIdentification("ordinal",y_data1,y_range1,.3),e.extra_top_margin=e.yScale.rangeBand()/2):"string"===e.axis_y_data_format&&(c=e.data.map(function(t){return t.y}),a=[0,e.chart_height-e.chart_margin_top-e.chart_margin_bottom],e.yScale=e.k.scaleIdentification("ordinal",c,a,.3),e.extra_top_margin=e.yScale.rangeBand()/2),"number"===e.axis_x_data_format&&(t=[0,d3.max(e.data,function(t){return+t.x})],_=e.k._domainBandwidth(t,1),r=[0,e.reducedWidth],o=d3.min(e.x_tick_values),i=d3.max(e.x_tick_values),_[0]>o&&(_[0]=o),_[1]<i&&(_[1]=i),e.xScale=e.k.scaleIdentification("linear",_,r),e.extra_left_margin=0),e.x_domain=e.xScale.domain(),e.y_domain=e.yScale.domain(),e.bar=e.group.selectAll(".bar-rect").data(e.data),e.bar.enter().append("g").attr("class","bar-rect").append("svg:rect"),e.bar.attr("class","bar-rect").select("rect").attr({"class":"hbar",y:function(t){return e.yScale(t.y)},x:0,height:function(t){return e.yScale.rangeBand(t.y)},width:0,fill:function(t){return e.fillColor.colorPieMS(t)},stroke:e.border.color(),"stroke-width":e.border.width(),"stroke-dasharray":e.border.style(),"data-id":function(t,e){return t.name}}).on({mouseover:function(t){"default"===e.mode&&(PykCharts["boolean"](e.chart_onhover_highlight_enable)&&e.mouseEvent1.highlight(e.selector+" .hbar",this),PykCharts["boolean"](e.tooltip_enable)&&(e.mouseEvent.tooltipPosition(t),e.mouseEvent.tooltipTextShow(t.tooltip?t.tooltip:t.x)))},mouseout:function(t){"default"===e.mode&&(PykCharts["boolean"](e.chart_onhover_highlight_enable)&&e.mouseEvent1.highlightHide(e.selector+" .hbar"),PykCharts["boolean"](e.tooltip_enable)&&e.mouseEvent.tooltipHide(t),e.mouseEvent.axisHighlightHide(e.selector+" .y.axis"))},mousemove:function(t){"default"===e.mode&&(PykCharts["boolean"](e.tooltip_enable)&&e.mouseEvent.tooltipPosition(t),e.mouseEvent.axisHighlightShow([t.y],e.selector+" .y.axis",e.y_domain))},click:function(t,a){PykCharts["boolean"](e.click_enable)&&e.addEvents(t.name,d3.select(this).attr("data-id"))}}).transition().duration(e.transitions.duration()).attr("width",function(t){return e.xScale(t.x)}),e.bar.exit().remove();var d=d3.transform(d3.select(d3.selectAll(e.selector+" .bar-rect")[0][e.data.length-1]).attr("transform")),u=(d.translate[0],d.translate[1]);return a=[e.reducedHeight-u-e.yScale.rangeBand()/2,u+e.yScale.rangeBand()/2],e.yScale1=e.k.scaleIdentification("linear",c,a),this},ticks:function(){function t(){a.attr({x:function(t){return e.xScale(t.x)},y:function(t){return e.yScale(t.name)+e.yScale.rangeBand(t.y)/2},dx:4,dy:4}).text(function(t){return t.x})}if(e.pointer_size){var a=e.group.selectAll(".ticks_label").data(e.data);a.enter().append("text"),a.attr("class","ticks_label").attr("fill",e.pointer_color).style({"font-weight":e.pointer_weight,"font-size":e.pointer_size+"px","font-family":e.pointer_family}).text(""),setTimeout(t,e.transitions.duration())}return this},sort:function(){if("string"===e.axis_y_data_format){try{if("alphabetically"!==e.data_sort_type&&"numerically"!==e.data_sort_type)throw e.data_sort_type=r.data_sort_type,"data_sort_type"}catch(t){e.k.warningHandling(t,"8")}var a="";switch(e.data_sort_type){case"alphabetically":case"date":a="y";break;case"numerically":a="x"}e.data=e.k.__proto__._sortData(e.data,a,"group",e,"notApplicable")}}};return a}},PykCharts.multiD.groupedBar=function(t){var e=this;e.interval="";var a=new PykCharts.Configuration.Theme({}),r=a.multiDimensionalCharts;this.execute=function(a){e=new PykCharts.validation.processInputs(e,t,"multiDimensionalCharts"),PykCharts.scaleFunction(e),e.data_sort_enable=t.data_sort_enable?t.data_sort_enable.toLowerCase():r.data_sort_enable,e.data_sort_type=PykCharts["boolean"](e.data_sort_enable)&&t.data_sort_type?t.data_sort_type.toLowerCase():r.data_sort_type,e.data_sort_order=PykCharts["boolean"](e.data_sort_enable)&&t.data_sort_order?t.data_sort_order.toLowerCase():r.data_sort_order;try{if("ascending"!==e.data_sort_order&&"descending"!==e.data_sort_order)throw e.data_sort_order=r.data_sort_order,"data_sort_order"}catch(n){e.k.warningHandling(n,"9")}e.stop||(e.k.storeInitialDivHeight(),e.panels_enable="no","default"===e.mode&&e.k.loading(),e.multiD=new PykCharts.multiD.configuration(e),e.executeData=function(t){var a=e.k.validator().validatingJSON(t),r=e.selector.substring(1,e.selector.length);return e.stop||a===!1?void e.k.remove_loading_bar(r):(e.data=e.k.__proto__._groupBy("bar",t),e.compare_data=e.k.__proto__._groupBy("bar",t),e.axis_x_data_format="number",e.axis_y_data_format=e.k.yAxisDataFormatIdentification(e.data),"time"===e.axis_y_data_format&&(e.axis_y_data_format="string"),e.k.remove_loading_bar(r),void e.render())},PykCharts["boolean"](e.interactive_enable)?(e.k.dataFromPykQuery(a),e.k.dataSourceFormatIdentification(e.data,e,"executeData")):e.k.dataSourceFormatIdentification(t.data,e,"executeData"))},e.dataTransformation=function(){PykCharts["boolean"](e.data_sort_enable)&&(e.data=e.optionalFeatures().sort(e.data,"group")),e.group_arr=[],e.new_data=[],e.data_length=e.data.length;for(var t=0;t<e.data_length;t++)e.group_arr[t]=e.data[t].y;e.uniq_group_arr=e.k.__proto__._unique(e.group_arr);for(var a=e.uniq_group_arr.length,r=0;a>r;r++){e.new_data[r]={name:e.uniq_group_arr[r],data:[]};for(var n=0;n<e.data_length;n++)e.uniq_group_arr[r]===e.data[n].y&&e.new_data[r].data.push({x:e.data[n].x,name:e.data[n].group,tooltip:e.data[n].tooltip,color:e.data[n].color})}if(e.new_data_length=e.new_data.length,!PykCharts["boolean"](e.data_sort_enable))for(var o=0;o<e.new_data_length;o++)e.new_data[o].data=e.optionalFeatures().sort(e.new_data[o].data,"name")},e.refresh=function(a){e.executeRefresh=function(t){e.data=e.k.__proto__._groupBy("bar",t),e.refresh_data=e.k.__proto__._groupBy("bar",t),e.dataTransformation(),e.optionalFeatures().mapColors();var a=e.k.checkChangeInData(e.refresh_data,e.compare_data);e.compare_data=a[0];var r=a[1];r&&e.k.lastUpdatedAt("liveData"),e.optionalFeatures().createChart().legends().ticks().highlightRect(),e.k.xAxis(e.svgContainer,e.xGroup,e.xScale,e.extra_left_margin,e.xdomain,e.x_tick_values,e.legendsGroup_height),"string"!==e.axis_y_data_format?(e.k.yAxis(e.svgContainer,e.yGroup,e.yScale1,e.ydomain,e.y_tick_values,e.legendsGroup_width,"groupbar"),e.optionalFeatures().newYAxis()):e.k.yAxis(e.svgContainer,e.yGroup,e.yScale,e.ydomain,e.y_tick_values,e.legendsGroup_width)},PykCharts["boolean"](e.interactive_enable)?(e.k.dataFromPykQuery(a),e.k.dataSourceFormatIdentification(e.data,e,"executeRefresh")):e.k.dataSourceFormatIdentification(t.data,e,"executeRefresh")},e.render=function(){var e=this,a=e.selector.substring(1,e.selector.length),r=a+"_svg";e.dataTransformation(),e.optionalFeatures().mapColors(),e.border=new PykCharts.Configuration.border(e),e.transitions=new PykCharts.Configuration.transition(e),e.mouseEvent1=new PykCharts.Configuration.mouseEvent(e),e.fillColor=new PykCharts.Configuration.fillChart(e,null,t),"default"===e.mode?(e.k.title().backgroundColor(e)["export"](e,"#"+r,"groupbarChart").emptyDiv(e.selector).subtitle().makeMainDiv(e.selector,1),e.optionalFeatures().svgContainer(r,1).legendsContainer(1),e.k.liveData(e).tooltip().createFooter().lastUpdatedAt().credits().dataSource(),e.mouseEvent=new PykCharts.Configuration.mouseEvent(e),e.optionalFeatures().legends().createGroups(1).createChart().axisContainer().highlightRect().ticks(),e.k.xAxis(e.svgContainer,e.xGroup,e.xScale,e.extra_left_margin,e.xdomain,e.x_tick_values,e.legendsGroup_height).xAxisTitle(e.xGroup).yAxisTitle(e.yGroup),"string"!==e.axis_y_data_format?(e.k.yAxis(e.svgContainer,e.yGroup,e.yScale1,e.ydomain,e.y_tick_values,e.legendsGroup_width,"groupbar"),e.optionalFeatures().newYAxis()):e.k.yAxis(e.svgContainer,e.yGroup,e.yScale,e.ydomain,e.y_tick_values,e.legendsGroup_width)):"infographics"===e.mode&&(e.k.backgroundColor(e)["export"](e,"#"+r,"groupbarChart").emptyDiv(e.selector).makeMainDiv(e.selector,1),e.optionalFeatures().svgContainer(r,1).legendsContainer(1).createGroups(1).createChart().axisContainer().highlightRect(),e.k.tooltip(),e.mouseEvent=new PykCharts.Configuration.mouseEvent(e),e.k.xAxis(e.svgContainer,e.xGroup,e.xScale,e.extra_left_margin,e.xdomain,e.x_tick_values,e.legendsGroup_height).xAxisTitle(e.xGroup).yAxisTitle(e.yGroup),"string"!==e.axis_y_data_format?(e.k.yAxis(e.svgContainer,e.yGroup,e.yScale1,e.ydomain,e.y_tick_values,e.legendsGroup_width,"groupbar"),e.optionalFeatures().newYAxis()):e.k.yAxis(e.svgContainer,e.yGroup,e.yScale,e.ydomain,e.y_tick_values,e.legendsGroup_width)),e.k.exportSVG(e,"#"+r,"groupbarChart");var n=e.k.resize(e.svgContainer);e.k.__proto__._ready(n),window.addEventListener("resize",function(t){return e.k.resize(e.svgContainer)})},e.optionalFeatures=function(){var t=this,e=t.selector.substring(1,t.selector.length),a={svgContainer:function(a,r){return document.getElementById(e).className+=" PykCharts-twoD",t.svgContainer=d3.select(t.selector+" #chart-container-"+r).append("svg:svg").attr({width:t.chart_width,height:t.chart_height,id:a,"class":"svgcontainer",preserveAspectRatio:"xMinYMin",viewBox:"0 0 "+t.chart_width+" "+t.chart_height}),this},createGroups:function(e){return t.group=t.svgContainer.append("g").attr({id:"groupedBar-group",transform:"translate("+t.chart_margin_left+","+(t.chart_margin_top+t.legendsGroup_height)+")"}),this},legendsContainer:function(e){return PykCharts["boolean"](t.legends_enable)&&"default"===t.mode?t.legendsGroup=t.svgContainer.append("g").attr({id:"groupedBar-legends","class":"legends",transform:"translate(0,10)"}).style("visibility","hidden"):(t.legendsGroup_height=0,t.legendsGroup_width=0),this},axisContainer:function(){return(PykCharts["boolean"](t.axis_x_enable)||t.axis_x_title)&&(t.xGroup=t.group.append("g").attr({"class":"x axis",id:"xaxis"}).style("stroke","black")),(PykCharts["boolean"](t.axis_y_enable)||t.axis_y_title)&&(t.yGroup=t.group.append("g").attr({"class":"y axis",id:"yaxis"}).style("stroke","blue"),t.new_yAxisgroup=t.group.append("g").attr({"class":"y new-axis",id:"new-yaxis"}).style("stroke","blue")),this},createChart:function(){t.reduced_width=t.chart_width-t.chart_margin_left-t.chart_margin_right-t.legendsGroup_width,t.reduced_height=t.chart_height-t.chart_margin_top-t.chart_margin_bottom-t.legendsGroup_height,t.getuniqueGroups=t.data.map(function(t){return t.group}),t.getuniqueGroups=t.k.__proto__._unique(t.getuniqueGroups),t.getuniqueGroups.sort(function(t,e){return t>e?1:-1}),t.x_tick_values=t.k.processXAxisTickValues(),t.y_tick_values=t.k.processYAxisTickValues();var e,a,r,n,o,i,l,s,_,c=[];"number"===t.axis_y_data_format?(max=d3.max(t.new_data,function(t){return t.name}),min=d3.min(t.new_data,function(t){return t.name}),o=[min,max],a=o,s=d3.min(t.y_tick_values),_=d3.max(t.y_tick_values),a[0]>s&&(a[0]=s),a[1]<_&&(a[1]=_),t.new_data.sort(function(t,e){return t.name-e.name}),y_data1=t.new_data.map(function(t){return t.name}),y_range1=[t.reduced_height,0],t.yScale=t.k.scaleIdentification("ordinal",y_data1,y_range1,.3),t.extra_top_margin=t.yScale.rangeBand()/2,t.y1=d3.scale.ordinal().domain(t.getuniqueGroups).rangeRoundBands([t.yScale.rangeBand(),0]),t.extra_top_margin=0):"string"===t.axis_y_data_format&&(a=t.new_data.map(function(t){return t.name}),r=[0,t.reduced_height],t.yScale=t.k.scaleIdentification("ordinal",a,r,.3),t.extra_top_margin=t.yScale.rangeBand()/2,t.y1=d3.scale.ordinal().domain(t.getuniqueGroups).rangeRoundBands([0,t.yScale.rangeBand()])),"number"===t.axis_x_data_format&&(t.max_x_value=d3.max(t.new_data,function(t){return d3.max(t.data,function(t){return t.x})}),e=[0,t.max_x_value],c=t.k._domainBandwidth(e,1),n=[0,t.reduced_width],i=d3.min(t.x_tick_values),l=d3.max(t.x_tick_values),c[0]>i&&(c[0]=i),c[1]<l&&(c[1]=l),t.xScale=t.k.scaleIdentification("linear",c,n),t.extra_left_margin=0),t.xdomain=t.xScale.domain(),t.ydomain=t.yScale.domain(),t.highlight_x_positions=[];var d=t.group.selectAll(".groupedBar-rect").data(t.new_data);d.enter().append("g").attr("class","groupedBar-rect"),t.highlight_y_positions="",d.attr("transform",function(e){return t.optionalFeatures().checkIfHighLightDataExists(e.name),t.highlight_group_exits&&(t.flag=!0,t.highlight_y_positions=t.yScale(e.name)),"translate(0,"+t.yScale(e.name)+")"}).on({mouseout:function(e){"default"===t.mode&&(PykCharts["boolean"](t.chart_onhover_highlight_enable)&&t.mouseEvent.highlightGroupHide(t.selector+" .groupedBar-rect","rect"),t.mouseEvent.axisHighlightHide(t.selector+" .y.axis"))},mousemove:function(e){"default"===t.mode&&(PykCharts["boolean"](t.chart_onhover_highlight_enable)&&t.mouseEvent.highlightGroup(t.selector+" .groupedBar-rect",this,"rect"),t.mouseEvent.axisHighlightShow(e.name,t.selector+" .y.axis",t.ydomain,"bar"))}});var u=d.selectAll("rect").data(function(t){return t.data});u.enter().append("rect"),u.attr({height:0,y:function(e){return t.y1(e.name)},x:0,width:0,height:function(e){return.98*t.y1.rangeBand()},fill:function(e,a){return t.fillColor.colorGroup(e)},"fill-opacity":function(e,a){return"saturation"===t.color_mode?(a+1)/t.no_of_groups:1},stroke:t.border.color(),"stroke-width":t.border.width(),"stroke-dasharray":t.border.style(),"data-fill-opacity":function(){return d3.select(this).attr("fill-opacity")},"data-id":function(t,e){return t.name}}).on({mouseover:function(e){if("default"===t.mode&&PykCharts["boolean"](t.tooltip_enable)){var a=e.tooltip?e.tooltip:e.x;t.mouseEvent.tooltipPosition(e),t.mouseEvent.tooltipTextShow(a)}},mouseout:function(e){"default"===t.mode&&PykCharts["boolean"](t.tooltip_enable)&&t.mouseEvent.tooltipHide(e)},mousemove:function(e){"default"===t.mode&&PykCharts["boolean"](t.tooltip_enable)&&t.mouseEvent.tooltipPosition(e)},click:function(e,a){PykCharts["boolean"](t.click_enable)&&t.addEvents(e.name,d3.select(this).attr("data-id"))}}).transition().duration(t.transitions.duration()).attr("width",function(e){return t.xScale(e.x)}),u.exit().remove(),d.exit().remove();var h=d3.transform(d3.select(d3.selectAll(".groupedBar-rect")[0][t.new_data.length-1]).attr("transform")),p=(h.translate[0],h.translate[1]);return r=[t.reduced_height-p-2*t.y1.rangeBand(),p+2*t.y1.rangeBand()],t.yScale1=t.k.scaleIdentification("linear",a,r),this},ticks:function(){function e(){r.attr({x:function(e){return t.xScale(e.x)},y:function(e){return t.y1(e.name)+t.y1.rangeBand()/2},dx:4,dy:2}).transition().text(function(t){return t.x?t.x.toFixed():void 0}).attr({"pointer-events":"none"}).text(function(e){return e.x&&(t.txt_width=this.getBBox().width,t.txt_height=this.getBBox().height,e.x&&t.txt_width<t.xScale(e.x)&&t.txt_height<t.y1.rangeBand())?e.x:void 0})}if(t.pointer_size){var a=t.group.selectAll(".groupedBar-ticks").data(t.new_data);a.enter().append("g").attr("class","groupedBar-ticks"),a.attr("transform",function(e){return"translate(0,"+t.yScale(e.name)+")"});var r=a.selectAll(".ticks_label").data(function(t){return t.data});r.enter().append("text"),r.attr("class","ticks_label").style("font-weight",t.pointer_weight).style("font-size",t.pointer_size+"px").attr("fill",t.pointer_color).style("font-family",t.pointer_family).text(""),setTimeout(e,t.transitions.duration()),r.exit().remove(),a.exit().remove()}return this},mapColors:function(){t.no_of_groups=d3.max(t.new_data,function(t){return t.data.length});for(var e=0;e<t.new_data_length;e++)if(t.new_data[e].data.length===t.no_of_groups){t.group_data=t.new_data[e].data,t.group_data_length=t.group_data.length;break}for(var e=0;e<t.group_data_length;e++)"color"===t.color_mode&&t.chart_color[e]?t.group_data[e].color=t.chart_color[e]:t.group_data[e].color=t.default_color[0];t.new_data.forEach(function(e){e.data.forEach(function(e){for(var a=0;a<t.group_data_length;a++)if(t.group_data[a].name===e.name){e.color=t.group_data[a].color;break}})})},legends:function(){if(PykCharts["boolean"](t.legends_enable)){var e,a=t.group_data;e=a.map(function(t){return t.color}),a=a.map(function(t){return t.name}),a=t.k.__proto__._unique(a),t.multiD.legendsPosition(t,"groupBar",a,e)}return this},checkIfHighLightDataExists:function(e){return t.highlight&&("number"===t.axis_y_data_format?t.highlight_group_exits=t.highlight===e:"string"===t.axis_y_data_format&&(t.highlight_group_exits=t.highlight.toLowerCase()===e.toLowerCase())),this},highlightRect:function(){function e(){y=t.highlight_y_positions-5;var e=t.group.selectAll(".highlight-groupedBar-rect").data([t.highlight]);e.enter().append("rect"),e.attr("class","highlight-groupedBar-rect").attr({x:0,y:y,height:t.y1.rangeBand()*t.group_data_length+10,width:t.reduced_width+5,fill:"none",stroke:t.highlight_color,"stroke-width":"1.5px","stroke-dasharray":"5,5","stroke-opacity":1}),e.exit().remove(),PykCharts["boolean"](t.highlight_y_positions)?highlight_array=t.highlight:e.remove()}return t.flag&&setTimeout(e,t.transitions.duration()),this},newYAxis:function(){if(PykCharts["boolean"](t.axis_y_enable)){"right"===t.axis_y_position&&t.new_yAxisgroup.attr("transform","translate("+(t.chart_width-t.chart_margin_left-t.chart_margin_right-t.legendsGroup_width)+",0)");var e=d3.svg.axis().scale(t.yScale).orient(t.axis_y_pointer_position).tickSize(0).outerTickSize(t.axis_y_outer_pointer_length);t.new_yAxisgroup.style("stroke",function(){return t.axis_y_line_color}).call(e),d3.selectAll(t.selector+" .y.new-axis text").style({display:function(){return"none"},stroke:"none"})}return this},sort:function(e,a){if("string"===t.axis_y_data_format){try{if("alphabetically"!==t.data_sort_type)throw t.data_sort_type=r.data_sort_type,"data_sort_type"}catch(n){t.k.warningHandling(n,"8")}return e=t.k.__proto__._sortData(e,"y",a,t)}return e}};return a}},PykCharts.multiD.column=function(t){var e=this;e.interval="";new PykCharts.Configuration.Theme({});this.execute=function(a){e=new PykCharts.validation.processInputs(e,t,"multiDimensionalCharts"),PykCharts.scaleFunction(e),PykCharts.grid(e),e.stop||(e.panels_enable="no",e.k.storeInitialDivHeight(),"default"===e.mode&&e.k.loading(),e.multiD=new PykCharts.multiD.configuration(e),e.executeData=function(t){var a=e.k.validator().validatingJSON(t),r=e.selector.substring(1,e.selector.length);return e.stop||a===!1?void e.k.remove_loading_bar(r):(e.data=e.k.__proto__._groupBy("column",t),e.compare_data=e.k.__proto__._groupBy("column",t),e.axis_y_data_format="number",e.axis_x_data_format=e.k.xAxisDataFormatIdentification(e.data),"time"===e.axis_x_data_format&&""===e.axis_x_time_value_datatype&&console.warn("%c[Warning - Pykih Charts] ","color: #F8C325;font-weight:bold;font-size:14px"," at "+e.selector+'.("You seem to have passed Date data so please pass the value for axis_x_time_value_datatype")  Visit www.pykcharts.com/errors#warning_15'),e.k.remove_loading_bar(r),void e.render())},PykCharts["boolean"](e.interactive_enable)?(e.k.dataFromPykQuery(a),e.k.dataSourceFormatIdentification(e.data,e,"executeData")):e.k.dataSourceFormatIdentification(t.data,e,"executeData"))},this.transformData=function(){var a=[],r=[];if(0!=t.chart_color&&void 0!=t.chart_color)e.chart_color[0]=t.chart_color[0];else for(var n=0,o=e.data.length;o>n;n++)if(""!=e.data[n].color&&void 0!=e.data[n].color){e.chart_color[0]=e.data[n].color,(void 0==t.axis_x_pointer_color||""==t.axis_x_pointer_color)&&(e.axis_x_pointer_color=e.chart_color[0]);break}e.data.forEach(function(t){t.name=t.x,t.color=e.chart_color[0]});for(var i=0,o=e.data.length;o>i;i++)a[i]=e.data[i].group;r=e.k.__proto__._unique(a),e.no_of_groups=r.length},this.render=function(){var a=e.selector.substring(1,e.selector.length),r=a+"_svg";e.border=new PykCharts.Configuration.border(e),e.transitions=new PykCharts.Configuration.transition(e),e.mouseEvent1=new PykCharts.Configuration.mouseEvent(t),e.fillColor=new PykCharts.Configuration.fillChart(e,null,t),e.transformData();try{if(e.no_of_groups>1)throw"Invalid data in the JSON"}catch(n){return void console.error("%c[Error - Pykih Charts] ","color: red;font-weight:bold;font-size:14px"," at "+e.selector+'. "'+n+'"  Visit www.pykcharts.com/errors#error_8')}"time"===e.axis_x_data_format&&e.data.forEach(function(t){t.x=e.k.dateConversion(t.x)}),"default"===e.mode?(e.k.title().backgroundColor(e)["export"](e,"#"+r,"columnChart").emptyDiv(e.selector).subtitle().makeMainDiv(e.selector,1),e.optionalFeatures().svgContainer(r,1).createGroups(),e.k.liveData(e).tooltip().createFooter().lastUpdatedAt().credits().dataSource(),e.mouseEvent=new PykCharts.Configuration.mouseEvent(e),e.optionalFeatures().createColumn().axisContainer(),e.k.yAxis(e.svgContainer,e.ygroup,e.yScale,e.y_domain,e.y_tick_values).yGrid(e.svgContainer,e.group,e.yScale).xAxisTitle(e.xgroup).yAxisTitle(e.ygroup),"string"!==e.axis_x_data_format?(console.log(e.xScale1.domain()),e.k.xAxis(e.svgContainer,e.xgroup,e.xScale1,e.extra_left_margin,e.x_domain,e.x_tick_values,null,"bar",e),e.optionalFeatures().newXAxis()):e.k.xAxis(e.svgContainer,e.xgroup,e.xScale,e.extra_left_margin,e.x_domain,e.x_tick_values,null,null,e)):"infographics"===e.mode&&(e.k.backgroundColor(e)["export"](e,"#"+r,"columnChart").emptyDiv(e.selector).makeMainDiv(e.selector,1),e.optionalFeatures().svgContainer(r,1).createGroups(),e.k.liveData(e).tooltip(),e.mouseEvent=new PykCharts.Configuration.mouseEvent(e),e.optionalFeatures().createColumn().axisContainer(),e.k.yAxis(e.svgContainer,e.ygroup,e.yScale,e.y_domain,e.y_tick_values).xAxisTitle(e.xgroup).yAxisTitle(e.ygroup),"string"!==e.axis_x_data_format?(e.k.xAxis(e.svgContainer,e.xgroup,e.xScale1,e.extra_left_margin,e.x_domain,e.x_tick_values,null,"bar"),e.optionalFeatures().newXAxis()):e.k.xAxis(e.svgContainer,e.xgroup,e.xScale,e.extra_left_margin,e.x_domain,e.x_tick_values)),e.k.exportSVG(e,"#"+r,"columnChart");var o=e.k.resize(e.svgContainer);e.k.__proto__._ready(o),window.addEventListener("resize",function(t){return e.k.resize(e.svgContainer)})},this.refresh=function(a){e.executeRefresh=function(t){e.data=e.k.__proto__._groupBy("column",t),e.refresh_data=e.k.__proto__._groupBy("column",t);var a=e.k.checkChangeInData(e.refresh_data,e.compare_data);e.compare_data=a[0];var r=a[1];e.transformData(),"time"===e.axis_x_data_format&&e.data.forEach(function(t){t.x=e.k.dateConversion(t.x),t.color=e.chart_color[0]});try{if(e.no_of_groups>1)throw"Invalid data in the JSON"}catch(n){return void console.error("%c[Error - Pykih Charts] ","color: red;font-weight:bold;font-size:14px"," at "+e.selector+'. "'+n+'"  Visit www.pykcharts.com/errors#error_8')}r&&e.k.lastUpdatedAt("liveData"),e.optionalFeatures().createColumn(),e.k.yAxis(e.svgContainer,e.ygroup,e.yScale,e.y_domain,e.y_tick_values).yGrid(e.svgContainer,e.group,e.yScale),"string"!==e.axis_x_data_format?(e.k.xAxis(e.svgContainer,e.xgroup,e.xScale,e.extra_left_margin,e.x_domain,e.x_tick_values,null,"bar"),e.optionalFeatures().newXAxis()):e.k.xAxis(e.svgContainer,e.xgroup,e.xScale,e.extra_left_margin,e.x_domain,e.x_tick_values)},PykCharts["boolean"](e.interactive_enable)?(e.k.dataFromPykQuery(a),e.k.dataSourceFormatIdentification(e.data,e,"executeRefresh")):e.k.dataSourceFormatIdentification(t.data,e,"executeRefresh")},this.optionalFeatures=function(){var t=e.selector.substring(1,e.selector.length),a={svgContainer:function(a,r){return document.getElementById(t).className+=" PykCharts-twoD",e.svgContainer=d3.select(e.selector+" #chart-container-"+r).append("svg:svg").attr({width:e.chart_width,height:e.chart_height,id:a,"class":"svgcontainer",preserveAspectRatio:"xMinYMin",viewBox:"0 0 "+e.chart_width+" "+e.chart_height}),this},createGroups:function(t){return e.group=e.svgContainer.append("g").attr({id:"column-group",transform:"translate("+e.chart_margin_left+","+e.chart_margin_top+")"}),PykCharts["boolean"](e.chart_grid_y_enable)&&e.group.append("g").attr({id:"ygrid","class":"y grid-line"}),this},axisContainer:function(){return(PykCharts["boolean"](e.axis_x_enable)||e.axis_x_title)&&(e.xgroup=e.group.append("g").attr({id:"xaxis","class":"x axis"}).style("stroke","none")),(PykCharts["boolean"](e.axis_y_enable)||e.axis_y_title)&&(e.ygroup=e.group.append("g").attr({id:"yaxis","class":"y axis"}),e.new_xAxisgroup=e.group.append("g").attr({"class":"x new-axis",id:"new-xaxis"}).style("stroke","blue")),this},createColumn:function(){e.x_tick_values=e.k.processXAxisTickValues(),e.y_tick_values=e.k.processYAxisTickValues(),e.reducedWidth=e.chart_width-e.chart_margin_left-e.chart_margin_right;var t,a,r,n,o,i,l,s,_=e.chart_height-e.chart_margin_top-e.chart_margin_bottom,c=[],d=[];"number"===e.axis_y_data_format?(n=[0,d3.max(e.data,function(t){return t.y})],d=e.k._domainBandwidth(n,1),a=[e.chart_height-e.chart_margin_top-e.chart_margin_bottom,0],l=d3.min(e.y_tick_values),s=d3.max(e.y_tick_values),d[0]>l&&(d[0]=l),d[1]<s&&(d[1]=s),e.yScale=e.k.scaleIdentification("linear",d,a),e.extra_top_margin=0):"string"===e.axis_y_data_format?(d=e.data.map(function(t){return t.y}),a=[0,e.chart_height-e.chart_margin_top-e.chart_margin_bottom],e.yScale=e.k.scaleIdentification("ordinal",d,a,.3),e.extra_top_margin=e.yScale.rangeBand()/2):"time"===e.axis_y_data_format&&(d=d3.extent(e.data,function(t){return parseDate(t.y)}),l=d3.min(e.y_tick_values,function(t){return new Date(t)}),s=d3.max(e.y_tick_values,function(t){return new Date(t)}),new Date(d[0])>new Date(l)&&(d[0]=l),new Date(d[1])<new Date(s)&&(d[1]=max__tick_value),a=[e.chart_height-e.chart_margin_top-e.chart_margin_bottom,0],e.yScale=e.k.scaleIdentification("time",d,a),e.extra_top_margin=0),"number"===e.axis_x_data_format?(t=[d3.min(e.data,function(t){return+t.x}),d3.max(e.data,function(t){return+t.x})],console.log(t),c=e.k._domainBandwidth(t),r=[0,e.reducedWidth],o=d3.min(e.x_tick_values),i=d3.max(e.x_tick_values),c[0]>o&&(c[0]=o),c[1]<i&&(c[1]=i),e.data.sort(function(t,e){return t.x-e.x}),console.log(c),e.xScale1=e.k.scaleIdentification("linear",c,r),x_data1=e.data.map(function(t){return t.x}),x_range1=[0,e.reducedWidth],e.xScale=e.k.scaleIdentification("ordinal",x_data1,x_range1,.3),e.extra_left_margin=e.xScale.rangeBand()/2):"string"===e.axis_x_data_format?(c=e.data.map(function(t){return t.x}),r=[0,e.reducedWidth],e.xScale=e.k.scaleIdentification("ordinal",c,r,.3),e.extra_left_margin=e.xScale.rangeBand()/2):"time"===e.axis_x_data_format&&(max=d3.max(e.data,function(t){return t.x}),min=d3.min(e.data,function(t){return t.x}),t=[min.getTime(),max.getTime()],o=d3.min(e.x_tick_values,function(t){return e.k.dateConversion(t)}),i=d3.max(e.x_tick_values,function(t){return e.k.dateConversion(t)}),c[0]>o&&(c[0]=o),c[1]<i&&(c[1]=i),r=[0,e.reducedWidth],e.xScale=e.k.scaleIdentification("time",t,r),e.data.sort(function(t,e){return t.x<e.x?-1:t.x>e.x?1:void 0}),console.log(data),e.xScale1=e.k.scaleIdentification("linear",c,r),x_data1=e.data.map(function(t){return t.x}),x_range1=[0,e.reducedWidth],e.xScale=e.k.scaleIdentification("ordinal",x_data1,x_range1,.3),e.extra_left_margin=e.xScale.rangeBand()/2),e.x_domain=e.xScale.domain(),e.y_domain=e.yScale.domain(),e.bar=e.group.selectAll(".column-rect").data(e.data),e.bar.enter().append("g").attr("class","column-rect").append("svg:rect"),e.bar.attr("class","column-rect").select("rect").attr({"class":"vcolumn",x:function(t){return e.xScale(t.x)},y:_,height:0,width:function(t){return e.xScale.rangeBand(t.x)},fill:function(t){return e.fillColor.colorPieMS(t)},stroke:e.border.color(),"stroke-width":e.border.width(),"stroke-dasharray":e.border.style(),"data-id":function(t,e){return t.name}}).on({mouseover:function(t){"default"===e.mode&&(PykCharts["boolean"](e.chart_onhover_highlight_enable)&&e.mouseEvent1.highlight(e.selector+" .vcolumn",this),PykCharts["boolean"](e.tooltip_enable)&&(e.mouseEvent.tooltipPosition(t),e.mouseEvent.tooltipTextShow(t.tooltip?t.tooltip:t.y)))},mouseout:function(t){"default"===e.mode&&(PykCharts["boolean"](e.chart_onhover_highlight_enable)&&e.mouseEvent1.highlightHide(e.selector+" .vcolumn"),PykCharts["boolean"](e.tooltip_enable)&&e.mouseEvent.tooltipHide(t),e.mouseEvent.axisHighlightHide(e.selector+" .x.axis"))},mousemove:function(t){"default"===e.mode&&(PykCharts["boolean"](e.tooltip_enable)&&e.mouseEvent.tooltipPosition(t),e.mouseEvent.axisHighlightShow(t.x,e.selector+" .x.axis",e.x_domain))},click:function(t,a){PykCharts["boolean"](e.click_enable)&&e.addEvents(t.name,d3.select(this).attr("data-id"))}}).transition().duration(e.transitions.duration()).attr({y:function(t){return e.yScale(t.y)},height:function(t){return _-e.yScale(t.y)}}),e.bar.exit().remove();var u=d3.transform(d3.select(d3.selectAll(e.selector+" .column-rect")[0][e.data.length-1]).attr("transform")),h=u.translate[0];u.translate[1];return r=[h+e.xScale.rangeBand(),e.reducedWidth-h-e.xScale.rangeBand()],e.xScale1=e.k.scaleIdentification("linear",c,r),this},newXAxis:function(){if(PykCharts["boolean"](e.axis_x_enable)){"bottom"===e.axis_x_position&&e.new_xAxisgroup.attr("transform","translate(0,"+(e.chart_height-e.chart_margin_top-e.chart_margin_bottom)+")");var t=d3.svg.axis().scale(e.xScale).orient(e.axis_x_pointer_position).tickSize(0).ticks(e.axis_x_no_of_axis_value).outerTickSize(e.axis_x_outer_pointer_length);e.new_xAxisgroup.style("stroke",function(){return e.axis_x_line_color}).call(t),d3.selectAll(e.selector+" .x.new-axis text").style({display:function(){return"none"},stroke:"none"})}return this}};return a}},PykCharts.multiD.groupedColumn=function(t){var e=this;e.interval="";new PykCharts.Configuration.Theme({});this.execute=function(a){e=new PykCharts.validation.processInputs(e,t,"multiDimensionalCharts"),PykCharts.scaleFunction(e),PykCharts.grid(e),e.stop||(e.panels_enable="no",e.k.storeInitialDivHeight(),"default"===e.mode&&e.k.loading(),e.multiD=new PykCharts.multiD.configuration(e),e.executeData=function(t){var a=e.k.validator().validatingJSON(t),r=e.selector.substring(1,e.selector.length);return e.stop||a===!1?void e.k.remove_loading_bar(r):(e.data=e.k.__proto__._groupBy("column",t),e.compare_data=e.k.__proto__._groupBy("column",t),e.axis_y_data_format="number",e.axis_x_data_format=e.k.xAxisDataFormatIdentification(e.data),"time"===e.axis_x_data_format&&""===e.axis_x_time_value_datatype&&console.warn("%c[Warning - Pykih Charts] ","color: #F8C325;font-weight:bold;font-size:14px"," at "+e.selector+'.("You seem to have passed Date data so please pass the value for axis_x_time_value_datatype")  Visit www.pykcharts.com/errors#warning_15'),e.k.remove_loading_bar(r),void e.render())},PykCharts["boolean"](e.interactive_enable)?(e.k.dataFromPykQuery(a),e.k.dataSourceFormatIdentification(e.data,e,"executeData")):e.k.dataSourceFormatIdentification(t.data,e,"executeData"));
},e.dataTransformation=function(){e.group_arr=[],e.new_data=[],e.data_length=e.data.length;for(var t=0;t<e.data_length;t++)e.group_arr[t]=e.data[t].x;e.uniq_group_arr=e.k.__proto__._unique(e.group_arr);for(var a=e.uniq_group_arr.length,r=0;a>r;r++){e.new_data[r]={name:e.uniq_group_arr[r],data:[]};for(var n=0;n<e.data_length;n++)e.uniq_group_arr[r]===e.data[n].x&&e.new_data[r].data.push({y:e.data[n].y,name:e.data[n].group,tooltip:e.data[n].tooltip,color:e.data[n].color})}e.new_data_length=e.new_data.length},e.refresh=function(a){e.executeRefresh=function(t){e.data=e.k.__proto__._groupBy("column",t),e.refresh_data=e.k.__proto__._groupBy("column",t),e.map_group_data=e.multiD.mapGroup(e.data),e.dataTransformation(),e.optionalFeatures().mapColors(),"time"===e.axis_x_data_format&&(e.new_data.forEach(function(t){t.name=e.k.dateConversion(t.name)}),e.data.forEach(function(t){t.x=e.k.dateConversion(t.x)}));var a=e.k.checkChangeInData(e.refresh_data,e.compare_data);e.compare_data=a[0];var r=a[1];r&&e.k.lastUpdatedAt("liveData"),e.optionalFeatures().createChart().legends().highlightRect(),e.k.yAxis(e.svgContainer,e.yGroup,e.yScale,e.ydomain,e.y_tick_values,e.legendsGroup_width).yGrid(e.svgContainer,e.group,e.yScale,e.legendsGroup_width),"string"!==e.axis_y_data_format?(e.k.xAxis(e.svgContainer,e.xGroup,e.xScale,e.extra_left_margin,e.xdomain,e.x_tick_values,e.legendsGroup_height,"groupcolumn"),e.optionalFeatures().newXAxis()):e.k.xAxis(e.svgContainer,e.xGroup,e.xScale,e.extra_left_margin,e.xdomain,e.x_tick_values,e.legendsGroup_height)},PykCharts["boolean"](e.interactive_enable)?(e.k.dataFromPykQuery(a),e.k.dataSourceFormatIdentification(e.data,e,"executeRefresh")):e.k.dataSourceFormatIdentification(t.data,e,"executeRefresh")},e.render=function(){var e=this,a=e.selector.substring(1,e.selector.length),r=a+"_svg";e.map_group_data=e.multiD.mapGroup(e.data),e.dataTransformation(),e.optionalFeatures().mapColors(),"time"===e.axis_x_data_format&&(e.new_data.forEach(function(t){t.name=e.k.dateConversion(t.name)}),e.data.forEach(function(t){t.x=e.k.dateConversion(t.x)})),e.border=new PykCharts.Configuration.border(e),e.transitions=new PykCharts.Configuration.transition(e),e.mouseEvent1=new PykCharts.Configuration.mouseEvent(e),e.fillColor=new PykCharts.Configuration.fillChart(e,null,t),"default"===e.mode?(e.k.title().backgroundColor(e)["export"](e,"#"+r,"groupColumnChart").emptyDiv(e.selector).subtitle().makeMainDiv(e.selector,1),e.optionalFeatures().svgContainer(r,1).legendsContainer(1),e.k.liveData(e).tooltip().createFooter().lastUpdatedAt().credits().dataSource(),e.mouseEvent=new PykCharts.Configuration.mouseEvent(e),e.optionalFeatures().legends().createGroups(1).createChart().axisContainer().highlightRect(),e.k.yAxis(e.svgContainer,e.yGroup,e.yScale,e.ydomain,e.y_tick_values,e.legendsGroup_width).yGrid(e.svgContainer,e.group,e.yScale,e.legendsGroup_width).xAxisTitle(e.xGroup).yAxisTitle(e.yGroup),"string"!==e.axis_y_data_format?(e.k.xAxis(e.svgContainer,e.xGroup,e.xScale,e.extra_left_margin,e.xdomain,e.x_tick_values,e.legendsGroup_height,"groupcolumn"),e.optionalFeatures().newXAxis()):e.k.xAxis(e.svgContainer,e.xGroup,e.xScale,e.extra_left_margin,e.xdomain,e.x_tick_values,e.legendsGroup_height)):"infographics"===e.mode&&(e.k.backgroundColor(e)["export"](e,"#"+r,"groupColumnChart").emptyDiv(e.selector).makeMainDiv(e.selector,1),e.optionalFeatures().svgContainer(r,1).legendsContainer(1).createGroups(1).createChart().axisContainer().highlightRect(),e.k.tooltip(),e.mouseEvent=new PykCharts.Configuration.mouseEvent(e),e.k.yAxis(e.svgContainer,e.yGroup,e.yScale,e.ydomain,e.y_tick_values,e.legendsGroup_width).xAxisTitle(e.xGroup).yAxisTitle(e.yGroup),"string"!==e.axis_y_data_format?(e.k.xAxis(e.svgContainer,e.xGroup,e.xScale,e.extra_left_margin,e.xdomain,e.x_tick_values,e.legendsGroup_height,"groupcolumn"),e.optionalFeatures().newXAxis()):e.k.xAxis(e.svgContainer,e.xGroup,e.xScale,e.extra_left_margin,e.xdomain,e.x_tick_values,e.legendsGroup_height)),e.k.exportSVG(e,"#"+r,"groupColumnChart");var n=e.k.resize(e.svgContainer);e.k.__proto__._ready(n),window.addEventListener("resize",function(t){return e.k.resize(e.svgContainer)})},e.optionalFeatures=function(){var t=this,e=t.selector.substring(1,t.selector.length),a={svgContainer:function(a,r){return document.getElementById(e).className+=" PykCharts-twoD",t.svgContainer=d3.select(t.selector+" #chart-container-"+r).append("svg:svg").attr({width:t.chart_width,height:t.chart_height,id:a,"class":"svgcontainer",preserveAspectRatio:"xMinYMin",viewBox:"0 0 "+t.chart_width+" "+t.chart_height}),this},createGroups:function(e){return t.group=t.svgContainer.append("g").attr({id:"groupedColumn-group",transform:"translate("+t.chart_margin_left+","+(t.chart_margin_top+t.legendsGroup_height)+")"}),PykCharts["boolean"](t.chart_grid_y_enable)&&t.group.append("g").attr({id:"ygrid","class":"y grid-line"}),this},legendsContainer:function(e){return PykCharts["boolean"](t.legends_enable)&&"default"===t.mode?t.legendsGroup=t.svgContainer.append("g").attr({id:"groupedColumn-legends","class":"legends",transform:"translate(0,10)"}).style("visibility","hidden"):(t.legendsGroup_height=0,t.legendsGroup_width=0),this},axisContainer:function(){return(PykCharts["boolean"](t.axis_x_enable)||t.axis_x_title)&&(t.xGroup=t.group.append("g").attr({"class":"x axis",id:"xaxis"}).style("stroke","black"),t.new_xAxisgroup=t.group.append("g").attr({"class":"x new-axis",id:"new-xaxis"}).style("stroke","blue")),(PykCharts["boolean"](t.axis_y_enable)||t.axis_y_title)&&(t.yGroup=t.group.append("g").attr({"class":"y axis",id:"yaxis"}).style("stroke","blue")),this},createChart:function(){t.reduced_width=t.chart_width-t.chart_margin_left-t.chart_margin_right-t.legendsGroup_width,t.reduced_height=t.chart_height-t.chart_margin_top-t.chart_margin_bottom-t.legendsGroup_height,t.getuniqueGroups=t.data.map(function(t){return t.group}),t.getuniqueGroups=t.k.__proto__._unique(t.getuniqueGroups),t.x_tick_values=t.k.processXAxisTickValues(),t.y_tick_values=t.k.processYAxisTickValues();var e,a,r,n,o,i,l,s,_,c=[];"number"===t.axis_y_data_format&&(t.max_y_value=d3.max(t.new_data,function(t){return d3.max(t.data,function(t){return t.y})}),o=[0,t.max_y_value],a=t.k.__proto__._domainBandwidth(o,1),s=d3.min(t.y_tick_values),_=d3.max(t.y_tick_values),a[0]>s&&(a[0]=s),a[1]<_&&(a[1]=_),r=[t.reduced_height,0],t.yScale=t.k.scaleIdentification("linear",a,r)),"number"===t.axis_x_data_format?(max=d3.max(t.new_data,function(t){return t.name}),min=d3.min(t.new_data,function(t){return t.name}),e=[min,max],c=[min,max],i=d3.min(t.x_tick_values),l=d3.max(t.x_tick_values),c[0]>i&&(c[0]=i),c[1]<l&&(c[1]=l),t.new_data.sort(function(t,e){return t.name-e.name}),n=[0,t.reduced_width],t.xScale1=t.k.scaleIdentification("linear",c,n),x_data1=t.new_data.map(function(t){return t.name}),x_range1=[0,t.reduced_width],t.xScale=t.k.scaleIdentification("ordinal",x_data1,x_range1,.2),t.extra_left_margin=t.xScale.rangeBand()/2,t.xdomain=t.xScale.domain(),t.x1=d3.scale.ordinal().domain(t.getuniqueGroups).rangeRoundBands([0,t.xScale.rangeBand()])):"string"===t.axis_x_data_format?(c=t.new_data.map(function(t){return t.name}),n=[0,t.reduced_width],t.xScale=t.k.scaleIdentification("ordinal",c,n,.2),t.extra_left_margin=t.xScale.rangeBand()/2,t.xdomain=t.xScale.domain(),t.x1=d3.scale.ordinal().domain(t.getuniqueGroups).rangeRoundBands([0,t.xScale.rangeBand()])):"time"===t.axis_x_data_format&&(max=d3.max(t.new_data,function(t){return t.name}),min=d3.min(t.new_data,function(t){return t.name}),e=[min.getTime(),max.getTime()],c=[min,max],n=[0,t.reduced_width],i=d3.min(t.x_tick_values,function(e){return e=t.k.dateConversion(e)}),l=d3.max(t.x_tick_values,function(e){return e=t.k.dateConversion(e)}),c[0]>i&&(c[0]=i),c[1]<l&&(c[1]=l),t.xScale=t.k.scaleIdentification("time",c,n),t.new_data.sort(function(t,e){return new Date(t.name)<new Date(e.name)?-1:new Date(t.name)>new Date(e.name)?1:void 0}),x_data1=t.new_data.map(function(t){return t.name}),x_range1=[0,t.reduced_width],t.xScale1=t.k.scaleIdentification("ordinal",x_data1,x_range1,.2),x_data1=t.new_data.map(function(t){return t.name}),x_range1=[0,t.reduced_width],t.xScale=t.k.scaleIdentification("ordinal",x_data1,x_range1,.2),t.extra_left_margin=t.xScale.rangeBand()/2,t.xdomain=t.xScale.domain(),t.x1=d3.scale.ordinal().domain(t.getuniqueGroups).rangeRoundBands([0,t.xScale.rangeBand()])),t.xdomain=t.xScale.domain(),t.ydomain=t.yScale.domain(),t.highlight_y_positions=[];var d=t.group.selectAll(".groupedColumn-rect").data(t.new_data);d.enter().append("g").attr("class","groupedColumn-rect"),d.attr("transform",function(e){return t.optionalFeatures().checkIfHighLightDataExists(e.name),t.highlight_group_exits&&(t.flag=!0,t.highlight_x_positions=t.xScale(e.name)),"translate("+t.xScale(e.name)+",0)"}).on({mouseout:function(e){"default"===t.mode&&(PykCharts["boolean"](t.chart_onhover_highlight_enable)&&t.mouseEvent.highlightGroupHide(t.selector+" .groupedColumn-rect","rect"),t.mouseEvent.axisHighlightHide(t.selector+" .x.axis"))},mousemove:function(e){"default"===t.mode&&(PykCharts["boolean"](t.chart_onhover_highlight_enable)&&t.mouseEvent.highlightGroup(t.selector+" .groupedColumn-rect",this,"rect"),t.mouseEvent.axisHighlightShow(e.name,t.selector+" .x.axis",t.xdomain))}});var u=d.selectAll("rect").data(function(t){return t.data});u.enter().append("rect"),u.attr("height",0).attr({x:function(e){return t.x1(e.name)},y:t.reduced_height,width:function(e){return.98*t.x1.rangeBand()},fill:function(e,a){return t.fillColor.colorGroup(e)},"fill-opacity":function(e,a){return"saturation"===t.color_mode?(a+1)/t.no_of_groups:1},stroke:t.border.color(),"srtoke-width":t.border.width(),"stroke-dasharray":t.border.style(),"data-fill-opacity":function(){return d3.select(this).attr("fill-opacity")},"data-id":function(t,e){return t.name}}).on({mouseover:function(e){if("default"===t.mode&&PykCharts["boolean"](t.tooltip_enable)){var a=e.tooltip?e.tooltip:e.y;t.mouseEvent.tooltipPosition(e),t.mouseEvent.tooltipTextShow(a)}},mouseout:function(e){"default"===t.mode&&PykCharts["boolean"](t.tooltip_enable)&&t.mouseEvent.tooltipHide(e)},mousemove:function(e){"default"===t.mode&&PykCharts["boolean"](t.tooltip_enable)&&t.mouseEvent.tooltipPosition(e)},click:function(e,a){PykCharts["boolean"](t.click_enable)&&t.addEvents(e.name,d3.select(this).attr("data-id"))}}).transition().duration(t.transitions.duration()).attr({height:function(e){return t.reduced_height-t.yScale(e.y)},y:function(e){return t.flag&&t.highlight_y_positions.push(t.yScale(e.y)),t.yScale(e.y)}}),d.exit().remove(),u.exit().remove();var h=d3.transform(d3.select(d3.selectAll(".groupedColumn-rect")[0][t.new_data.length-1]).attr("transform")),p=h.translate[0];h.translate[1];return n=[t.reduced_height-p-2*t.x1.rangeBand(),p+2*t.x1.rangeBand()],t.xScale1=t.k.scaleIdentification("linear",c,n),this},mapColors:function(){t.no_of_groups=d3.max(t.new_data,function(t){return t.data.length});for(var e=0;e<t.new_data_length;e++)if(t.new_data[e].data.length===t.no_of_groups){t.group_data=t.new_data[e].data,t.group_data_length=t.group_data.length;break}t.new_data.forEach(function(e){e.data.forEach(function(e){for(var a=0;a<t.group_data_length;a++)if(t.group_data[a].name===e.name){e.color=t.group_data[a].color;break}})})},legends:function(){if(PykCharts["boolean"](t.legends_enable)){var e,a=t.group_data;e=a.map(function(t){return t.color}),a=a.map(function(t){return t.name}),a=t.k.__proto__._unique(a),t.multiD.legendsPosition(t,"groupColumn",a,e)}return this},checkIfHighLightDataExists:function(e){return t.highlight&&("number"===t.axis_x_data_format?t.highlight_group_exits=t.highlight===e:"string"===t.axis_x_data_format&&(t.highlight_group_exits=t.highlight.toLowerCase()===e.toLowerCase())),this},newXAxis:function(){if(PykCharts["boolean"](t.axis_x_enable)){"bottom"===t.axis_x_position&&t.new_xAxisgroup.attr("transform","translate(0,"+(t.chart_height-t.chart_margin_top-t.chart_margin_bottom-t.legendsGroup_height)+")");var e=d3.svg.axis().scale(t.xScale).orient(t.axis_x_pointer_position).tickSize(0).outerTickSize(t.axis_x_outer_pointer_length);t.new_xAxisgroup.style("stroke",function(){return t.axis_x_line_color}).call(e),d3.selectAll(t.selector+" .x.new-axis text").style({display:function(){return"none"},stroke:"none"})}return this},highlightRect:function(){function e(){x=t.highlight_x_positions-5;var e=t.group.selectAll(".highlight-groupedColumn-rect").data([t.highlight]);e.enter().append("rect"),e.attr({"class":"highlight-groupedColumn-rect",x:x,y:0,width:t.x1.rangeBand()*t.group_data.length+10,height:t.reduced_height+5,fill:"none",stroke:t.highlight_color,"stroke-width":"1.5px","stroke-dasharray":"5,5","stroke-opacity":1}),e.exit().remove(),PykCharts["boolean"](t.highlight_x_positions)?highlight_array=t.highlight:e.remove()}return t.flag&&setTimeout(e,t.transitions.duration()),this}};return a}},PykCharts.multiD.scatter=function(t){var e=this;e.interval="";var a=new PykCharts.Configuration.Theme({});this.execute=function(r){e=new PykCharts.validation.processInputs(e,t,"multiDimensionalCharts"),e.bubbleRadius=t.scatterplot_radius?t.scatterplot_radius:a.multiDimensionalCharts.scatterplot_radius,e.panels_enable="no",PykCharts.scaleFunction(e);try{if(!e.k.__proto__._isNumber(e.bubbleRadius))throw e.bubbleRadius=a.multiDimensionalCharts.scatterplot_radius,"bubbleRadius"}catch(n){e.k.warningHandling(n,"1")}if(!e.stop){e.k.storeInitialDivHeight(),"default"===e.mode&&e.k.loading();var o=a.multiDimensionalCharts;a.stylesheet;e.multiD=new PykCharts.multiD.configuration(e),e.scatterplot_pointer_enable=t.scatterplot_pointer_enable?t.scatterplot_pointer_enable.toLowerCase():o.scatterplot_pointer_enable,e.zoomed_out=!0,PykCharts["boolean"](e.panels_enable)?e.radius_range=[2*e.k.__proto__._radiusCalculation(1.1),2*e.k.__proto__._radiusCalculation(2.6)]:e.radius_range=[2*e.k.__proto__._radiusCalculation(4.5),2*e.k.__proto__._radiusCalculation(11)],e.executeData=function(a){var r=e.k.validator().validatingJSON(a),n=e.selector.substring(1,e.selector.length);if(e.stop||r===!1)return void e.k.remove_loading_bar(n);e.data=e.k.__proto__._groupBy("scatterplot",a),e.axis_y_data_format=e.k.yAxisDataFormatIdentification(e.data),e.axis_x_data_format=e.k.xAxisDataFormatIdentification(e.data),"time"===e.axis_x_data_format&&""===e.axis_x_time_value_datatype&&console.warn("%c[Warning - Pykih Charts] ","color: #F8C325;font-weight:bold;font-size:14px"," at "+e.selector+'.("You seem to have passed Date data so please pass the value for axis_x_time_value_datatype")  Visit www.pykcharts.com/errors#warning_15'),"time"===e.axis_y_data_format&&""===e.axis_y_time_value_datatype&&console.warn("%c[Warning - Pykih Charts] ","color: #F8C325;font-weight:bold;font-size:14px"," at "+e.selector+'.("You seem to have passed Date data so please pass the value for axis_x_time_value_datatype")  Visit www.pykcharts.com/errors#warning_15'),e.compare_data=e.k.__proto__._groupBy("scatterplot",a),e.k.remove_loading_bar(n);var o=new PykCharts.multiD.scatterplotFunctions(t,e,"scatterplot");o.render()},PykCharts["boolean"](e.interactive_enable)?(e.k.dataFromPykQuery(r),e.k.dataSourceFormatIdentification(e.data,e,"executeData")):e.k.dataSourceFormatIdentification(t.data,e,"executeData")}}},PykCharts.multiD.panelsOfScatter=function(t){var e=this;e.interval="";var a=new PykCharts.Configuration.Theme({});this.execute=function(r){e=new PykCharts.validation.processInputs(e,t,"multiDimensionalCharts"),PykCharts.scaleFunction(e),e.bubbleRadius=t.scatterplot_radius?t.scatterplot_radius:a.multiDimensionalCharts.scatterplot_radius,e.panels_enable="yes",e.legends_display="horizontal";try{if(!e.k.__proto__._isNumber(e.bubbleRadius))throw e.bubbleRadius=a.multiDimensionalCharts.scatterplot_radius,"bubbleRadius"}catch(n){e.k.warningHandling(n,"1")}if(!e.stop){e.k.storeInitialDivHeight(),"default"===e.mode&&e.k.loading();var o=a.multiDimensionalCharts;a.stylesheet;e.multiD=new PykCharts.multiD.configuration(e),e.scatterplot_pointer_enable=t.scatterplot_pointer_enable?t.scatterplot_pointer_enable.toLowerCase():o.scatterplot_pointer_enable,e.zoomed_out=!0,PykCharts["boolean"](e.panels_enable)?e.radius_range=[2*e.k.__proto__._radiusCalculation(3.5),2*e.k.__proto__._radiusCalculation(8)]:e.radius_range=[2*e.k.__proto__._radiusCalculation(4.5),2*e.k.__proto__._radiusCalculation(11)],e.executeData=function(a){var r=e.k.validator().validatingJSON(a),n=e.selector.substring(1,e.selector.length);if(e.stop||r===!1)return void e.k.remove_loading_bar(n);e.data=e.k.__proto__._groupBy("scatterplot",a),e.axis_y_data_format=e.k.yAxisDataFormatIdentification(e.data),e.axis_x_data_format=e.k.xAxisDataFormatIdentification(e.data),"time"===e.axis_x_data_format&&""===e.axis_x_time_value_datatype&&console.warn("%c[Warning - Pykih Charts] ","color: #F8C325;font-weight:bold;font-size:14px"," at "+e.selector+'.("You seem to have passed Date data so please pass the value for axis_x_time_value_datatype")  Visit www.pykcharts.com/errors#warning_15'),"time"===e.axis_y_data_format&&""===e.axis_y_time_value_datatype&&console.warn("%c[Warning - Pykih Charts] ","color: #F8C325;font-weight:bold;font-size:14px"," at "+e.selector+'.("You seem to have passed Date data so please pass the value for axis_x_time_value_datatype")  Visit www.pykcharts.com/errors#warning_15'),e.compare_data=e.k.__proto__._groupBy("scatterplot",a),e.k.remove_loading_bar(n);var o=new PykCharts.multiD.scatterplotFunctions(t,e,"scatterplot");o.render()},PykCharts["boolean"](e.interactive_enable)?(e.k.dataFromPykQuery(r),e.k.dataSourceFormatIdentification(e.data,e,"executeData")):e.k.dataSourceFormatIdentification(t.data,e,"executeData")}}},PykCharts.multiD.pulse=function(t){var e=this;e.interval="";var a=new PykCharts.Configuration.Theme({});this.execute=function(r){e=new PykCharts.validation.processInputs(e,t,"multiDimensionalCharts"),PykCharts.scaleFunction(e);var n=a.multiDimensionalCharts;a.stylesheet;e.multiD=new PykCharts.multiD.configuration(e),e.bubbleRadius=t.scatterplot_radius?t.scatterplot_radius:.6*n.scatterplot_radius,e.panels_enable="no";try{if(!e.k.__proto__._isNumber(e.bubbleRadius))throw e.bubbleRadius=.6*n.scatterplot_radius,"bubbleRadius"}catch(o){e.k.warningHandling(o,"1")}e.stop||(e.k.storeInitialDivHeight(),e.zoomed_out=!0,e.radius_range=[2*e.k.__proto__._radiusCalculation(1.1),2*e.k.__proto__._radiusCalculation(3.5)],"default"===e.mode&&e.k.loading(),e.executeData=function(a){var r=e.k.validator().validatingJSON(a),n=e.selector.substring(1,e.selector.length);if(e.stop||r===!1)return void e.k.remove_loading_bar(n);e.data=e.k.__proto__._groupBy("pulse",a),e.axis_y_data_format=e.k.yAxisDataFormatIdentification(e.data),e.axis_x_data_format=e.k.xAxisDataFormatIdentification(e.data),"date"===e.axis_x_data_format&&""===e.axis_x_time_value_datatype&&console.warn("%c[Warning - Pykih Charts] ","color: #F8C325;font-weight:bold;font-size:14px"," at "+e.selector+'.("You seem to pass Date data so please pass axis_x_time_value_datatype")  Visit www.pykcharts.com/errors#warning_15'),"date"===e.axis_y_data_format&&""===e.axis_y_time_value_datatype&&console.warn("%c[Warning - Pykih Charts] ","color: #F8C325;font-weight:bold;font-size:14px"," at "+e.selector+'.("You seem to pass Date data so please pass axis_y_time_value_datatype")  Visit www.pykcharts.com/errors#warning_15'),e.compare_data=e.k.__proto__._groupBy("pulse",a),e.k.remove_loading_bar(n);var o=new PykCharts.multiD.scatterplotFunctions(t,e,"pulse");o.render()},PykCharts["boolean"](e.interactive_enable)?(e.k.dataFromPykQuery(r),e.k.dataSourceFormatIdentification(e.data,e,"executeData")):e.k.dataSourceFormatIdentification(t.data,e,"executeData"))}},PykCharts.multiD.scatterplotFunctions=function(t,e,a){function r(){n.zoomed_out=!1;for(var t,e=PykCharts["boolean"](n.panels_enable)?n.no_of_groups:1,a=0;e>a;a++){var r=d3.select(n.selector+" #"+n.container_id+a);n.k.isOrdinal(r,".x.axis",n.x),n.k.isOrdinal(r,".y.axis",n.yScale),n.optionalFeatures().plotCircle().label().ticks(),d3.select(n.selector+" #"+n.container_id+a).selectAll(".scatterplot-dot").attr({r:function(e){return t=n.sizes(e.weight)*PykCharts.getEvent().scale},cx:function(t){return n.x(t.x)+n.extra_left_margin},cy:function(t){return n.yScale(t.y)+n.extra_top_margin}}),d3.select(n.selector+" #"+n.container_id+a).selectAll(".scatterplot-label").attr({x:function(t){return n.x(t.x)+n.extra_left_margin},y:function(t){return n.yScale(t.y)+n.extra_top_margin+5}}).style("font-size",n.label_size+"px"),d3.select(n.selector+" #"+n.container_id+a).selectAll(".tick_label").attr({x:function(t){return n.x(t.x)},y:function(e){return n.yScale(e.y)-t}})}if("dblclick"===PykCharts.getEvent().sourceEvent.type&&n.count++,n.count===n.zoom_level+1)for(var a=0;e>a;a++){if("yes"===n.panels_enable){n.new_data=[];for(var o=0;o<n.data_length;o++)n.data[o].group===n.uniq_group_arr[a]&&n.new_data.push(n.data[o])}else n.new_data=n.data;d3.select(n.selector+" #"+n.container_id+a).call(function(){return n.zoomOut(a)}),n.count=1}}var n=e;n.refresh=function(e){n.executeRefresh=function(t){n.data=n.k.__proto__._groupBy("scatterplot",t),n.refresh_data=n.k.__proto__._groupBy("scatterplot",t);var e=n.k.checkChangeInData(n.refresh_data,n.compare_data);n.compare_data=e[0];e[1];n.uniq_group_arr=n.k.__proto__._unique(n.data.map(function(t){return t.group})),e[1]&&n.k.lastUpdatedAt("liveData"),n.map_group_data=n.multiD.mapGroup(n.data),"time"===n.axis_x_data_format&&n.data.forEach(function(t){t.x=n.k.dateConversion(t.x)}),PykCharts["boolean"](n.panels_enable)?PykCharts["boolean"](n.panels_enable)&&"scatterplot"===a&&(document.querySelector(n.selector+" #panels_of_scatter_main_div").innerHTML=null,n.renderChart()):(n.new_data=n.data,n.optionalFeatures().createChart().legends().plotCircle().ticks(),"scatterplot"===a&&n.optionalFeatures().label(0).labelPosition()),n.k.xAxis(n.svgContainer,n.xGroup,n.x,n.extra_left_margin,n.xdomain,n.x_tick_values,n.legendsGroup_height).yAxis(n.svgContainer,n.yGroup,n.yScale,n.ydomain,n.y_tick_values,n.legendsGroup_width)},PykCharts["boolean"](n.interactive_enable)?(n.k.dataFromPykQuery(e),n.k.dataSourceFormatIdentification(n.data,n,"executeRefresh")):n.k.dataSourceFormatIdentification(t.data,n,"executeRefresh")},n.calculatePanelInRow=function(){var t,e=parseInt(n.k._getHighestParentsAttribute(n.selector,"width"));t=e?e:d3.select("body").style("width"),n.no_of_containers_in_row=Math.floor(parseInt(t)/n.chart_width),n.no_of_containers_in_row>n.uniq_group_arr.length&&(n.no_of_containers_in_row=n.uniq_group_arr.length),t<n.chart_width&&(n.no_of_containers_in_row=1)},this.render=function(){var t=n.selector.substring(1,n.selector.length);if(n.container_id=t+"_svg",n.map_group_data=n.multiD.mapGroup(n.data),n.fillChart=new PykCharts.Configuration.fillChart(n),n.transitions=new PykCharts.Configuration.transition(n),n.border=new PykCharts.Configuration.border(n),n.uniq_group_arr=n.k.__proto__._unique(n.data.map(function(t){return t.group})),n.no_of_groups=1,PykCharts["boolean"](n.panels_enable)&&n.calculatePanelInRow(),"time"===n.axis_x_data_format&&n.data.forEach(function(t){t.x=n.k.dateConversion(t.x)}),"default"===n.mode)PykCharts["boolean"](n.panels_enable)&&"scatterplot"===a?(n.w=n.chart_width,n.chart_height=n.chart_height,n.chart_margin_left=n.chart_margin_left,n.chart_margin_right=n.chart_margin_right,n.k.title(n.new_width).backgroundColor(n)["export"](n,n.container_id,a,n.panels_enable,n.uniq_group_arr,n.new_width).emptyDiv(n.selector).subtitle(n.new_width),d3.select(n.selector).append("div").attr("id","panels_of_scatter_main_div"),n.renderChart(),n.k.xAxis(n.svgContainer,n.xGroup,n.x,n.extra_left_margin,n.xdomain,n.x_tick_values,n.legendsGroup_height).yAxis(n.svgContainer,n.yGroup,n.yScale,n.ydomain,n.y_tick_values,n.legendsGroup_width).xAxisTitle(n.xGroup,n.legendsGroup_height,n.legendsGroup_width).yAxisTitle(n.yGroup)):(n.k.title().backgroundColor(n)["export"](n,"#"+n.container_id+"0",a).emptyDiv(n.selector).subtitle(),n.w=n.chart_width,n.chart_height=n.chart_height,n.new_data=n.data,n.k.makeMainDiv(n.selector,0),n.optionalFeatures().svgContainer(0).legendsContainer(0),n.k.liveData(n).tooltip(),n.mouseEvent=new PykCharts.Configuration.mouseEvent(n),n.sizes=new PykCharts.multiD.bubbleSizeCalculation(n,n.data,n.radius_range),n.optionalFeatures().legends().createGroups(0).createChart().ticks(),"scatterplot"===a&&n.optionalFeatures().label(0).labelPosition(),n.k.xAxis(n.svgContainer,n.xGroup,n.x,n.extra_left_margin,n.xdomain,n.x_tick_values,n.legendsGroup_height).yAxis(n.svgContainer,n.yGroup,n.yScale,n.ydomain,n.y_tick_values,n.legendsGroup_width).xAxisTitle(n.xGroup,n.legendsGroup_height,n.legendsGroup_width).yAxisTitle(n.yGroup),n.k.exportSVG(n,"#"+n.container_id+"0",a)),n.k.createFooter(n.new_width).lastUpdatedAt().credits().dataSource();else if("infographics"===n.mode)if(PykCharts["boolean"](n.panels_enable)&&"scatterplot"===a){n.k.backgroundColor(n)["export"](n,n.container_id,a,n.panels_enable,n.uniq_group_arr,n.new_width).emptyDiv(n.selector),n.no_of_groups=n.uniq_group_arr.length,n.data_length=n.data.length,n.w=n.chart_width,n.chart_height=n.chart_height,n.chart_margin_left=n.chart_margin_left,n.chart_margin_right=n.chart_margin_right;for(var e=0;e<n.no_of_groups;e++){n.new_data=[];for(var r=0;r<n.data_length;r++)n.data[r].group===n.uniq_group_arr[e]&&n.new_data.push(n.data[r]);n.k.makeMainDiv(n.selector,e),n.optionalFeatures().svgContainer(e).legendsContainer(e),n.k.tooltip(),n.mouseEvent=new PykCharts.Configuration.mouseEvent(n),n.sizes=new PykCharts.multiD.bubbleSizeCalculation(n,n.data,n.radius_range),n.optionalFeatures().legends(e).createGroups(e).createChart().label(e).ticks(),n.k.xAxis(n.svgContainer,n.xGroup,n.x,n.extra_left_margin,n.xdomain,n.x_tick_values,n.legendsGroup_height).yAxis(n.svgContainer,n.yGroup,n.yScale,n.ydomain,n.y_tick_values,n.legendsGroup_width).xAxisTitle(n.xGroup,n.legendsGroup_height,n.legendsGroup_width).yAxisTitle(n.yGroup)}n.optionalFeatures().labelPosition(),n.k.exportSVG(n,n.container_id,a,n.panels_enable,n.uniq_group_arr),n.k.emptyDiv(n.selector)}else n.k.backgroundColor(n)["export"](n,"#"+n.container_id+"0",a).emptyDiv(n.selector),n.w=n.chart_width,n.new_data=n.data,n.k.makeMainDiv(n.selector,0),n.optionalFeatures().svgContainer(0).legendsContainer(0),n.k.liveData(n).tooltip(),n.mouseEvent=new PykCharts.Configuration.mouseEvent(n),n.sizes=new PykCharts.multiD.bubbleSizeCalculation(n,n.data,n.radius_range),n.optionalFeatures().legends().createGroups(0).createChart().ticks(),"scatterplot"===a&&n.optionalFeatures().label(0).labelPosition(),n.k.xAxis(n.svgContainer,n.xGroup,n.x,n.extra_left_margin,n.xdomain,n.x_tick_values,n.legendsGroup_height).yAxis(n.svgContainer,n.yGroup,n.yScale,n.ydomain,n.y_tick_values,n.legendsGroup_width).xAxisTitle(n.xGroup,n.legendsGroup_height,n.legendsGroup_width).yAxisTitle(n.yGroup),n.k.exportSVG(n,"#"+n.container_id+"0",a);if(PykCharts["boolean"](n.panels_enable)){var o=n.k.resize(void 0,n.new_width);n.k.__proto__._ready(o),window.addEventListener("resize",function(t){return n.calculatePanelInRow(),n.k.resize(void 0,n.new_width)})}else{var o=n.k.resize(n.svgContainer);n.k.__proto__._ready(o),window.addEventListener("resize",function(t){return n.k.resize(n.svgContainer)})}},n.optionalFeatures=function(){var t=n.selector.substring(1,n.selector.length),e={svgContainer:function(e){document.querySelector(n.selector+" #chart-container-"+e).style.width=n.w;var a=document.getElementById(t);return a.classList.contains("PykCharts-weighted")||(a.className+=" PykCharts-weighted"),n.svgContainer=d3.select(n.selector+" #chart-container-"+e).append("svg").attr({width:n.w,height:n.chart_height,preserveAspectRatio:"xMinYMin",viewBox:"0 0 "+n.w+" "+n.chart_height,id:n.container_id+""+e,"class":"svgcontainer"}),this},createGroups:function(t){return n.group=n.svgContainer.append("g").attr({transform:"translate("+n.chart_margin_left+","+(n.chart_margin_top+n.legendsGroup_height)+")",id:"main"}),n.ticksElement=n.svgContainer.append("g").attr({transform:"translate("+n.chart_margin_left+","+(n.chart_margin_top+n.legendsGroup_height)+")",id:"main2"}),(PykCharts["boolean"](n.axis_x_enable)||n.axis_x_title)&&(n.xGroup=n.group.append("g").attr({"class":"x axis",id:"xaxis"}).style("stroke","black")),(PykCharts["boolean"](n.axis_y_enable)||n.axis_y_title)&&(n.yGroup=n.group.append("g").attr({"class":"y axis",id:"yaxis"}).style("stroke","blue")),n.clip=n.group.append("svg:clipPath").attr("id","clip"+t+n.selector).append("svg:rect").attr({width:n.w-n.chart_margin_left-n.chart_margin_right-n.legendsGroup_width,height:n.chart_height-n.chart_margin_top-n.chart_margin_bottom-n.legendsGroup_height}),n.chartBody=n.group.append("g").attr({id:"clip"+t,"clip-path":"url(#clip"+t+n.selector+")"}),this},legendsContainer:function(t){return PykCharts["boolean"](n.legends_enable)&&n.map_group_data[1]&&"default"===n.mode?n.legendsGroup=n.svgContainer.append("g").attr("id","scatterplot-legends").style("visibility","visible"):(n.legendsGroup_width=0,n.legendsGroup_height=0),this},createChart:function(t){if("scatterplot"==a){n.new_data.sort(function(t,e){return e.weight-t.weight}),n.weight=n.new_data.map(function(t){return t.weight});for(var e=n.weight.length,o=[],i=0;e>i;i++)0!==n.weight[i]&&o.push(n.weight[i]);n.weight=o,n.sorted_weight=n.weight.slice(0).reverse()}else{n.weight=n.new_data.map(function(t){return t.weight});for(var e=n.weight.length,o=[],i=0;e>i;i++)0!==n.weight[i]&&o.push(n.weight[i]);n.weight=o,n.sorted_weight=n.weight.slice(0)}if(n.sorted_weight.sort(function(t,e){return t-e}),n.x_tick_values=n.k.processXAxisTickValues(),n.y_tick_values=n.k.processYAxisTickValues(),n.group.append("text").attr({fill:"black","text-anchor":"end",x:n.w-70,y:n.chart_height+40}),n.zoomed_out===!0){var l,s,_,c,d,u,h,p,g=[],m=[];if("number"===n.axis_y_data_format?(c=d3.extent(n.data,function(t){return parseFloat(t.y)}),m=n.k.__proto__._domainBandwidth(c,2,"number"),s=[n.chart_height-n.chart_margin_top-n.chart_margin_bottom-n.legendsGroup_height,0],h=d3.min(n.y_tick_values),p=d3.max(n.y_tick_values),m[0]>h&&(m[0]=h),m[1]<p&&(m[1]=p),n.yScale=n.k.scaleIdentification("linear",m,s),n.extra_top_margin=0):"string"===n.axis_y_data_format?(n.data.forEach(function(t){m.push(t.y)}),s=[0,n.chart_height-n.chart_margin_top-n.chart_margin_bottom-n.legendsGroup_height],n.yScale=n.k.scaleIdentification("ordinal",m,s,0),n.extra_top_margin=n.yScale.rangeBand()/2):"time"===n.axis_y_data_format&&(m=d3.extent(n.data,function(t){return new Date(t.x)}),h=d3.min(n.y_tick_values,function(t){return new Date(t)}),p=d3.max(n.y_tick_values,function(t){return new Date(t)}),new Date(m[0])>new Date(h)&&(m[0]=h),new Date(m[1])<new Date(p)&&(m[1]=max__tick_value),s=[n.chart_height-n.chart_margin_top-n.chart_margin_bottom-n.legendsGroup_height,0],n.yScale=n.k.scaleIdentification("time",m,s),n.extra_top_margin=0),"number"===n.axis_x_data_format?(l=d3.extent(n.data,function(t){return parseFloat(t.x)}),g=n.k.__proto__._domainBandwidth(l,2),d=d3.min(n.x_tick_values),u=d3.max(n.x_tick_values),g[0]>d&&(g[0]=d),g[1]<u&&(g[1]=u),_=[0,n.w-n.chart_margin_left-n.chart_margin_right-n.legendsGroup_width],n.x=n.k.scaleIdentification("linear",g,_),n.extra_left_margin=0):"string"===n.axis_x_data_format?(n.data.forEach(function(t){g.push(t.x)}),_=[0,n.w-n.chart_margin_left-n.chart_margin_right-n.legendsGroup_width],n.x=n.k.scaleIdentification("ordinal",g,_,0),n.extra_left_margin=n.x.rangeBand()/2):"time"===n.axis_x_data_format&&(max=d3.max(n.data,function(t){return t.x}),min=d3.min(n.data,function(t){return t.x}),l=[min.getTime(),max.getTime()],g=n.k.__proto__._domainBandwidth(l,2,"time"),d=d3.min(n.x_tick_values,function(t){return n.k.dateConversion(t)}),u=d3.max(n.x_tick_values,function(t){return n.k.dateConversion(t)}),g[0]>d&&(g[0]=d),g[1]<u&&(g[1]=u),_=[0,n.w-n.chart_margin_left-n.chart_margin_right],n.x=n.k.scaleIdentification("time",g,_),n.extra_left_margin=0),n.xdomain=n.x.domain(),
n.ydomain=n.yScale.domain(),n.x1=1,n.y1=12,n.count=1,"pulse"!==a)var f=d3.behavior.zoom().scale(n.count).x(n.x).y(n.yScale).on("zoom",r);if(PykCharts["boolean"](n.zoom_enable)&&"string"!==n.axis_y_data_format&&"string"!==n.axis_x_data_format&&"default"===n.mode){var x;x=PykCharts["boolean"](n.panels_enable)?n.no_of_groups:1;for(var i=0;i<n.no_of_groups;i++)d3.select(n.selector+" #"+n.container_id+i).call(f),d3.select(n.selector+" #"+n.container_id+i).on({"wheel.zoom":null,"mousewheel.zoom":null})}n.optionalFeatures().plotCircle(t)}return this},legends:function(t){return PykCharts["boolean"](n.legends_enable)&&n.map_group_data[1]&&"default"===n.mode&&n.multiD.legendsPosition(n,"scatter",n.map_group_data[0],void 0,t),this},ticks:function(){function t(){e.text(function(t){return t.name})}if(PykCharts["boolean"](n.scatterplot_pointer_enable)){var e=n.ticksElement.selectAll(".ticks_label").data(n.new_data);e.enter().append("text"),e.attr({"class":"ticks_label",x:function(t){return n.x(t.x)},y:function(t){return n.yScale(t.y)},"pointer-events":"none",dx:-1,dy:function(t){return-n.sizes(t.weight)-4}}).style({"text-anchor":"middle","font-family":n.label_family,"font-size":n.label_size+"px"}).text(""),setTimeout(t,n.transitions.duration()),e.exit().remove()}return this},plotCircle:function(){return n.circlePlot=n.chartBody.selectAll(".scatterplot-dot").data(n.new_data),n.circlePlot.enter().append("circle").attr("class","scatterplot-dot"),n.circlePlot.attr({r:0,cx:function(t){return n.x(t.x)+n.extra_left_margin},cy:function(t){return n.yScale(t.y)+n.extra_top_margin},fill:function(t){return n.fillChart.colorPieW(t)},"fill-opacity":function(t){return"pulse"==a&&PykCharts["boolean"](n.variable_circle_size_enable)?1:n.multiD.opacity(t.weight,n.weight,n.data)},"data-fill-opacity":function(t){return d3.select(this).attr("fill-opacity")},"data-id":function(t){return t.x},stroke:n.border.color(),"stroke-width":n.border.width(),"stroke-dasharray":n.border.style(),"stroke-opacity":1}).on({mouseover:function(t,e){"default"===n.mode&&(PykCharts["boolean"](n.tooltip_enable)&&(tooltipText=t.tooltip?t.tooltip:"<table><thead><th colspan='2'><b>"+t.name+"</b></th></thead><tr><td>X</td><td><b>"+t.x+"</b></td></tr><tr><td>Y</td><td><b>"+t.y+"<b></td></tr><tr><td>Weight</td><td><b>"+t.weight+"</b></td></tr></table>",n.mouseEvent.tooltipPosition(t),n.mouseEvent.tooltipTextShow(tooltipText)),PykCharts["boolean"](n.chart_onhover_highlight_enable)&&(PykCharts["boolean"](n.panels_enable)?n.mouseEvent.highlight(n.selector+" #"+this.parentElement.parentElement.parentElement.parentElement.id+" .scatterplot-dot",this):n.mouseEvent.highlight(n.selector+" .scatterplot-dot",this)))},mouseout:function(t,e){"default"===n.mode&&(PykCharts["boolean"](n.tooltip_enable)&&n.mouseEvent.tooltipHide(t),PykCharts["boolean"](n.chart_onhover_highlight_enable)&&(PykCharts["boolean"](n.panels_enable)?n.mouseEvent.highlightHide(n.selector+" #"+this.parentElement.parentElement.parentElement.parentElement.id+" .scatterplot-dot"):n.mouseEvent.highlightHide(n.selector+" .scatterplot-dot")))},mousemove:function(t){"default"===n.mode&&PykCharts["boolean"](n.tooltip_enable)&&n.mouseEvent.tooltipPosition(t)},dblclick:function(){PykCharts.getEvent().stopPropagation()},mousedown:function(){PykCharts.getEvent().stopPropagation()},click:function(t,e){PykCharts["boolean"](n.click_enable)&&n.addEvents(t.x,d3.select(this).attr("data-id"))}}).transition().duration(n.transitions.duration()).attr("r",function(t){return n.sizes(t.weight)}),n.circlePlot.exit().remove(),this},label:function(t){if(PykCharts["boolean"](n.label_size)){var e=n.selector.substring(1,n.selector.length);n.circleLabel=n.chartBody.selectAll(".scatterplot-label").data(n.new_data),n.circleLabel.enter().append("text"),n.circleLabel.attr("class","scatterplot-label").attr("id",e+"-bubble-label-"+t).text(""),n.circleLabel.exit().remove()}return this},labelPosition:function(){function t(){for(var t=0;t<n.no_of_groups;t++)d3.selectAll(n.selector+"-bubble-label-"+t).attr({x:function(t){return n.x(t.x)+n.extra_left_margin},y:function(t){return n.yScale(t.y)+n.extra_top_margin+5},"text-anchor":"middle","pointer-events":"none",fill:n.label_color}).style({"font-weight":n.label_weight,"font-size":n.label_size+"px","font-family":n.label_family}).text(function(t){return t.weight}).text(function(t){return this.getBBox().width<2*n.sizes(t.weight)&&this.getBBox().height<2*n.sizes(t.weight)?t.weight:""})}return setTimeout(t,n.transitions.duration()),this}};return e},n.zoomOut=function(t){n.zoomed_out=!0,n.x1=1,n.y1=12,n.optionalFeatures().createChart(t).label().ticks();var e=d3.select(n.selector+" #"+n.container_id+t),a=e.select("#xaxis"),r=e.select("#yaxis");n.k.xAxis(e,a,n.x,n.extra_left_margin,n.xdomain,n.x_tick_values,n.legendsGroup_height).yAxis(e,r,n.yScale,n.ydomain,n.y_tick_values,n.legendsGroup_width),d3.select(n.selector+" #"+n.container_id+t).selectAll(".scatterplot-dot").attr({r:function(t){return n.sizes(t.weight)},cx:function(t){return n.x(t.x)+n.extra_left_margin},cy:function(t){return n.yScale(t.y)+n.extra_top_margin}}),d3.select(n.selector+" #"+n.container_id+t).selectAll(".scatterplot-label").style("font-size",n.label_size+"px").attr({x:function(t){return n.x(t.x)+n.extra_left_margin},y:function(t){return n.yScale(t.y)+n.extra_top_margin+5}})},n.renderChart=function(){n.no_of_groups=n.uniq_group_arr.length,n.data_length=n.data.length;for(var t=0;t<n.no_of_groups;t++){n.new_data=[];for(var e=0;e<n.data_length;e++)n.data[e].group===n.uniq_group_arr[t]&&n.new_data.push(n.data[e]);n.k.makeMainDiv(n.selector+" #panels_of_scatter_main_div",t),n.optionalFeatures().svgContainer(t).legendsContainer(t);var r=n.selector.substr(1,n.selector.length);d3.selectAll("#tooltip-svg-container-"+t+"-pyk-tooltip"+r).remove(),n.k.liveData(n).tooltip(!0,n.selector,t),n.mouseEvent=new PykCharts.Configuration.mouseEvent(n),n.sizes=new PykCharts.multiD.bubbleSizeCalculation(n,n.data,n.radius_range),n.optionalFeatures().legends(t).createGroups(t).createChart().label(t).ticks(),n.k.xAxis(n.svgContainer,n.xGroup,n.x,n.extra_left_margin,n.xdomain,n.x_tick_values,n.legendsGroup_height).yAxis(n.svgContainer,n.yGroup,n.yScale,n.ydomain,n.y_tick_values,n.legendsGroup_width).xAxisTitle(n.xGroup,n.legendsGroup_height,n.legendsGroup_width).yAxisTitle(n.yGroup)}n.optionalFeatures().labelPosition(),n.k.exportSVG(n,n.container_id,a,n.panels_enable,n.uniq_group_arr),n.k.emptyDiv(n.selector)}},PykCharts.multiD.spiderWeb=function(t){var e=this;e.interval="";var a=new PykCharts.Configuration.Theme({});this.execute=function(r){var n=a.multiDimensionalCharts;e=new PykCharts.validation.processInputs(e,t,"multiDimensionalCharts"),e.bubbleRadius=t.spiderweb_radius?t.spiderweb_radius:.6*n.scatterplot_radius,e.spiderweb_outer_radius_percent=t.spiderweb_outer_radius_percent?t.spiderweb_outer_radius_percent:n.spiderweb_outer_radius_percent,e.panels_enable="no",e.data_sort_enable="yes",e.data_sort_type="alphabetically",e.data_sort_order="ascending";try{if(!e.k.__proto__._isNumber(e.bubbleRadius))throw e.bubbleRadius=.6*n.scatterplot_radius,"spiderweb_radius"}catch(o){e.k.warningHandling(o,"1")}try{if(!e.k.__proto__._isNumber(e.spiderweb_outer_radius_percent))throw e.bubbleRadius=n.spiderweb_outer_radius_percent,"spiderweb_outer_radius_percent"}catch(o){e.k.warningHandling(o,"1")}e.stop||(e.k.storeInitialDivHeight(),"default"===e.mode&&e.k.loading(),e.spiderweb_outer_radius_percent>100&&(e.spiderweb_outer_radius_percent=100),e.multiD=new PykCharts.multiD.configuration(e),e.inner_radius=0,e.executeData=function(t){var a=e.k.validator().validatingJSON(t),r=e.selector.substring(1,e.selector.length);return e.stop||a===!1?void e.k.remove_loading_bar(r):(e.data=e.k.__proto__._groupBy("spiderweb",t),e.compare_data=e.k.__proto__._groupBy("spiderweb",t),e.k.remove_loading_bar(r),void e.render())},PykCharts["boolean"](e.interactive_enable)?(e.k.dataFromPykQuery(r),e.k.dataSourceFormatIdentification(e.data,e,"executeData")):e.k.dataSourceFormatIdentification(t.data,e,"executeData"))},e.dataTransformation=function(){e.group_arr=[],e.uniq_group_arr=[],e.x_arr=[],e.uniq_x_arr=[],e.data=e.k.__proto__._sortData(e.data,"x","group",e),e.data_length=e.data.length;for(var t=0;t<e.data_length;t++)e.group_arr[t]=e.data[t].group;e.uniq_group_arr=e.k.__proto__._unique(e.group_arr);for(var a=e.uniq_group_arr.length,r=0;r<e.data_length;r++)e.x_arr[r]=e.data[r].x;e.k.__proto__._unique(e.x_arr);e.new_data=[];for(var r=0;a>r;r++){e.new_data[r]={name:e.uniq_group_arr[r],data:[]};for(var n=0;n<e.data_length;n++)e.uniq_group_arr[r]===e.data[n].group&&e.new_data[r].data.push({x:e.data[n].x,y:e.data[n].y,weight:e.data[n].weight,color:e.data[n].color,tooltip:e.data[n].tooltip})}e.new_data_length=e.new_data.length},e.refresh=function(a){e.executeRefresh=function(t){e.data=e.k.__proto__._groupBy("spiderweb",t),e.refresh_data=e.k.__proto__._groupBy("spiderweb",t),e.map_group_data=e.multiD.mapGroup(e.data),e.dataTransformation();var a=e.k.checkChangeInData(e.refresh_data,e.compare_data);e.compare_data=a[0];var r=a[1];r&&e.k.lastUpdatedAt("liveData"),e.optionalFeatures().createChart().legends().xAxis().yAxis()},PykCharts["boolean"](e.interactive_enable)?(e.k.dataFromPykQuery(a),e.k.dataSourceFormatIdentification(e.data,e,"executeRefresh")):e.k.dataSourceFormatIdentification(t.data,e,"executeRefresh")},this.render=function(){e.fillChart=new PykCharts.Configuration.fillChart(e);var t=e.selector.substring(1,e.selector.length),a=t+"_svg";e.border=new PykCharts.Configuration.border(e),e.map_group_data=e.multiD.mapGroup(e.data),e.dataTransformation(),"default"===e.mode?(e.k.title().backgroundColor(e)["export"](e,"#"+a,"spiderweb").emptyDiv(e.selector).subtitle().makeMainDiv(e.selector,1),e.h=e.chart_height,e.optionalFeatures().svgContainer(a,1).legendsContainer(1),e.k.liveData(e).tooltip(),e.mouseEvent=new PykCharts.Configuration.mouseEvent(e),e.optionalFeatures().legends().createGroups(),e.spiderweb_outer_radius_percent=e.k.__proto__._radiusCalculation(e.spiderweb_outer_radius_percent,"spiderweb"),e.radius_range=[3*e.spiderweb_outer_radius_percent/100,.09*e.spiderweb_outer_radius_percent],e.sizes=new PykCharts.multiD.bubbleSizeCalculation(e,e.data,e.radius_range),e.optionalFeatures().createChart().xAxis().yAxis(),e.k.createFooter().lastUpdatedAt().credits().dataSource()):"infographics"===e.mode&&(e.k.backgroundColor(e)["export"](e,"#"+a,"spiderweb").emptyDiv(e.selector),e.k.makeMainDiv(e.selector,1),e.h=e.chart_height,e.optionalFeatures().svgContainer(a,1).legendsContainer().createGroups(),e.spiderweb_outer_radius_percent=e.k.__proto__._radiusCalculation(e.spiderweb_outer_radius_percent,"spiderweb"),e.radius_range=[3*e.spiderweb_outer_radius_percent/100,.09*e.spiderweb_outer_radius_percent],e.sizes=new PykCharts.multiD.bubbleSizeCalculation(e,e.data,e.radius_range),e.optionalFeatures().createChart().xAxis().yAxis(),e.k.tooltip(),e.mouseEvent=new PykCharts.Configuration.mouseEvent(e)),e.k.exportSVG(e,"#"+a,"spiderweb");var r=e.k.resize(e.svgContainer);e.k.__proto__._ready(r),window.addEventListener("resize",function(t){return e.k.resize(e.svgContainer)})},this.degrees=function(t){return t/Math.PI*180-90},this.optionalFeatures=function(){var t=this,e=t.selector.substring(1,t.selector.length),a={svgContainer:function(a,r){return document.getElementById(e).className+=" PykCharts-spider-web",t.svgContainer=d3.select(t.selector+" #chart-container-"+r).append("svg").attr({"class":"svgcontainer",id:a,width:t.chart_width,height:t.chart_height,preserveAspectRatio:"xMinYMin",viewBox:"0 0 "+t.chart_width+" "+t.chart_height}),this},createGroups:function(){return t.group=t.svgContainer.append("g").attr({id:"spider-group",transform:"translate("+(t.chart_width-t.legendsGroup_width)/2+","+(t.h+t.legendsGroup_height+20)/2+")"}),t.ticksElement=t.svgContainer.append("g").attr("transform","translate("+(t.chart_width-t.legendsGroup_width)/2+","+(t.h+t.legendsGroup_height+20)/2+")"),this},legendsContainer:function(e){return PykCharts["boolean"](t.legends_enable)&&t.map_group_data[1]&&"default"===t.mode?t.legendsGroup=t.svgContainer.append("g").attr({"class":"spiderweb-legends",id:"legends"}):(t.legendsGroup_width=0,t.legendsGroup_height=0),this},createChart:function(){var e,a,r,n=t.new_data[0].data,o=n.length;r=d3.max(t.new_data,function(t,e){return d3.max(t.data,function(t){return t.y})}),a=d3.min(t.new_data,function(t,e){return d3.min(t.data,function(t){return t.y})}),t.yScale=d3.scale.linear().domain([a,r]).range([t.inner_radius,t.spiderweb_outer_radius_percent]),t.y_domain=[],t.nodes=[];for(var i=[],e=0;e<t.new_data_length;e++){for(var l=[],s=0;s<t.new_data[e].data.length;s++)i.push(t.yScale(t.new_data[e].data[s].y)),l[s]=t.yScale(t.new_data[e].data[s].y);t.y_domain[e]=l}t.y=d3.scale.linear().domain(d3.extent(i,function(t){return parseFloat(t)})).range([.1,.9]);for(var e=0;e<t.new_data_length;e++){for(var _=[],s=0;o>s;s++)_[s]={x:s,y:t.y(t.y_domain[e][s]),tooltip:t.new_data[e].data[s].tooltip||t.new_data[e].data[s].weight};t.nodes[e]=_}t.radius=d3.scale.linear().range([t.inner_radius,t.spiderweb_outer_radius_percent]);for(var c=0;c<t.new_data_length;c++){var d=[];for(s=0;s<t.new_data[c].data.length;s++)d[s]=t.new_data[c].data[s].tooltip;t.angle=d3.scale.ordinal().domain(d3.range(t.new_data[c].data.length+1)).rangePoints([0,2*Math.PI]),t.yAxis=[];for(var e=0;e<t.new_data[c].data.length;e++)t.yAxis.push({x:e,y:.25},{x:e,y:.5},{x:e,y:.75},{x:e,y:1});var u,h=[];t.yAxis_length=t.yAxis.length;for(var e=0;e<t.yAxis_length;e++)u=e<t.yAxis_length-4?t.yAxis[e+4]:t.yAxis[e-t.yAxis_length+4],h.push({source:t.yAxis[e],target:u});for(var p,g=[],e=0;e<t.nodes[c].length;e++)e<t.nodes[c].length-1?(u=t.nodes[c][e+1],p=t.fillChart.colorPieW(t.new_data[c].data[e])):(u=t.nodes[c][0],p=t.fillChart.colorPieW(t.new_data[c].data[e])),g.push({source:t.nodes[c][e],target:u,color:p});var m=t.group.selectAll("#link"+c).data(g);m.enter().append("path").attr("class","link"),m.attr({"class":"link",stroke:function(t){return t.color},"stroke-opacity":1,id:"link"+c,d:d3.customHive.link().angle(function(e){return t.angle(e.x)}).radius(function(e){return t.radius(e.y)})}),m.exit().remove(),t.weight=t.new_data[c].data.map(function(t){return t.weight});for(var f=t.weight.length,x=[],e=0;f>e;e++)0!==t.weight[e]&&x.push(t.weight[e]);t.weight=x,t.sorted_weight=t.weight.slice(0),t.sorted_weight.sort(function(t,e){return t-e});var y=t.group.selectAll(".node"+c).data(t.nodes[c]);y.enter().append("circle").attr({"class":"dot node"+c,transform:function(e){return"rotate("+t.degrees(t.angle(e.x))+")"}}),y.attr({"class":"dot node"+c,cx:function(e){return t.radius(e.y)},r:function(e,a){return t.sizes(t.new_data[c].data[a].weight)},"fill-opacity":function(e,a){return t.multiD.opacity(t.new_data[c].data[a].weight,t.weight,t.data)},"data-fill-opacity":function(){return d3.select(this).attr("fill-opacity")},stroke:t.border.color(),"stroke-width":t.border.width(),"stroke-dasharray":t.border.style(),"data-id":function(e,a){return t.new_data[0].data[a].x}}).style("fill",function(e,a){return t.fillChart.colorPieW(t.new_data[c].data[a])}).on({mouseover:function(e,a){"default"===t.mode&&(t.mouseEvent.tooltipPosition(e),t.mouseEvent.tooltipTextShow(e.tooltip),PykCharts["boolean"](t.chart_onhover_highlight_enable)&&t.mouseEvent.highlight(t.selector+" .dot",this))},mouseout:function(e){"default"===t.mode&&(t.mouseEvent.tooltipHide(e),PykCharts["boolean"](t.chart_onhover_highlight_enable)&&t.mouseEvent.highlightHide(t.selector+" .dot"))},mousemove:function(e){"default"===t.mode&&t.mouseEvent.tooltipPosition(e)},click:function(e,a){PykCharts["boolean"](t.click_enable)&&t.addEvents(t.new_data[0].data[a].x,d3.select(this).attr("data-id"))}}),y.exit().remove()}return t.group.selectAll(".axis").data(d3.range(t.new_data[0].data.length)).enter().append("line").attr({"class":"axis",transform:function(e){return"rotate("+t.degrees(t.angle(e))+")"},x1:t.radius.range()[0],x2:t.radius.range()[1]}),t.group.selectAll(".grid").data(h).enter().append("path").attr({"class":"grid",d:d3.customHive.link().angle(function(e){return t.angle(e.x)}).radius(function(e){return t.radius(e.y)})}),this},legends:function(){return PykCharts["boolean"](t.legends_enable)&&t.map_group_data[1]&&"default"===t.mode&&t.multiD.legendsPosition(t,"spiderWeb",t.map_group_data[0]),this},xAxis:function(){t.length=t.new_data[0].data.length;var e=t.group.selectAll("text.x-axis-title").data(t.nodes[0]);return e.enter().append("text").attr("class","x-axis-title"),e.attr({transform:function(e,a){return"translate("+-t.spiderweb_outer_radius_percent+","+-t.spiderweb_outer_radius_percent+")"},x:function(e,a){return t.spiderweb_outer_radius_percent*(1-.2*Math.sin(2*a*Math.PI/t.length))+1.25*t.spiderweb_outer_radius_percent*Math.sin(2*a*Math.PI/t.length)},y:function(e,a){return t.spiderweb_outer_radius_percent*(1-.6*Math.cos(2*a*Math.PI/t.length))-.47*t.spiderweb_outer_radius_percent*Math.cos(2*a*Math.PI/t.length)}}).style({"text-anchor":"middle","font-size":t.axis_x_pointer_size+"px","font-family":t.axis_x_pointer_family,"font-weight":t.axis_x_pointer_weight,fill:t.axis_x_pointer_color}),e.text(function(e,a){return t.new_data[0].data[a].x}),e.exit().remove(),this},yAxis:function(){for(var e=t.yScale.domain(),a=e[1]/4,r=[],n=4,o=0;n>=0;n--,o++)r[o]=n*a;var i=t.ticksElement.selectAll("text.y-axis-ticks").data(r);return i.enter().append("text").attr("class","y-axis-ticks"),i.style("text-anchor","start").attr({transform:"translate(5,"+-t.spiderweb_outer_radius_percent+")",x:0,y:function(e,a){return a*(t.spiderweb_outer_radius_percent/4)},dy:-2}),i.text(function(t,e){return t}).style({"font-size":t.axis_y_pointer_size+"px","font-family":t.axis_y_pointer_family,"font-weight":t.axis_y_pointer_weight,fill:t.axis_y_pointer_color}),i.exit().remove(),this},sort:function(){if("string"===t.axis_y_data_format)try{if("alphabetically"!==t.data_sort_type)throw t.data_sort_type=multiDimensionalCharts.data_sort_type,"data_sort_type";t.data=t.k.__proto__._sortData(t.data,"y","group",t)}catch(e){t.k.warningHandling(e,"8")}return this}};return a}},PykCharts.multiD.waterfall=function(t){var e=this;e.interval="";var a=new PykCharts.Configuration.Theme({}),r=a.multiDimensionalCharts;this.execute=function(n){e=new PykCharts.validation.processInputs(e,t,"multiDimensionalCharts"),e.calculate_total=t.calculate_total?t.calculate_total:r.calculate_total,e.calculate_total_of=t.calculate_total_of?t.calculate_total_of:[],e.axis_y_background_color=t.axis_y_background_color?t.axis_y_background_color:a.multiDimensionalCharts.axis_y_background_color,PykCharts.scaleFunction(e),e.color_mode="color",e.grid_y_enable="no",e.grid_color="#fff",e.panels_enable="no",e.longest_tick_width=0,e.ticks_formatter=d3.format("s");try{if(0==e.chart_color.length)throw e.chart_color=["rgb(255, 60, 131)","rgb(0, 185, 250)","grey"],"chart_color";if(1==e.chart_color.length)throw e.chart_color.push("rgb(0, 185, 250)","grey"),"chart_color";if(2==e.chart_color.length)throw e.chart_color.push("grey"),"chart_color"}catch(o){console.warn("%c[Warning - Pykih Charts] ","color: #F8C325;font-weight:bold;font-size:14px"," at "+e.selector+".(\"You seem to have passed less than three colors for '"+o+"', in a waterfall chart.\")  Visit www.pykcharts.com/errors#warning_18")}e.stop||(e.k.storeInitialDivHeight(),"default"===e.mode&&e.k.loading(),e.multiD=new PykCharts.multiD.configuration(e),e.executeData=function(a){var r=e.k.validator().validatingJSON(a),n=e.selector.substring(1,e.selector.length);return e.stop||r===!1?void e.k.remove_loading_bar(n):(e.data=e.k.__proto__._groupBy("waterfall",a),e.compare_data=e.k.__proto__._groupBy("waterfall",a),e.axis_y_data_format=e.k.yAxisDataFormatIdentification(e.data),e.axis_x_data_format="number",e.k.remove_loading_bar(n),PykCharts.multiD.waterfallFunctions(t,e,"waterfall"),void e.render())},PykCharts["boolean"](e.interactive_enable)?(e.k.dataFromPykQuery(n),e.k.dataSourceFormatIdentification(e.data,e,"executeData")):e.k.dataSourceFormatIdentification(t.data,e,"executeData"))}},PykCharts.multiD.waterfallFunctions=function(t,e,a){var r=e;r.refresh=function(e){for(var a=document.querySelectorAll(".custom-axis"),n=0;n<a.length;n++)a[n].parentNode.removeChild(a[n]);r.executeRefresh=function(t){r.data=r.k.__proto__._groupBy("waterfall",t),r.refresh_data=r.k.__proto__._groupBy("waterfall",t);var e=r.k.checkChangeInData(r.refresh_data,r.compare_data);r.compare_data=e[0];var a=e[1];a&&r.k.lastUpdatedAt("liveData"),r.groupData(),r.sortData(),r.calculateRiverData(),r.optionalFeatures().createScales().ticks().createChart(),r.k.yAxis(r.svgContainer,r.yGroup,r.yScale,r.yDomain,r.y_tick_values,void 0,void 0,r.tick_format_function),r.xaxis()},PykCharts["boolean"](r.interactive_enable)?(r.k.dataFromPykQuery(e),r.k.dataSourceFormatIdentification(r.data,r,"executeRefresh")):r.k.dataSourceFormatIdentification(t.data,r,"executeRefresh")},r.render=function(){var t=this,e=t.selector.substring(1,t.selector.length);t.container_id=e+"_svg",t.groupData(),t.sortData(),t.calculateRiverData(),t.transitions=new PykCharts.Configuration.transition(t),t.mouseEvent1=new PykCharts.Configuration.mouseEvent(t),t.border=new PykCharts.Configuration.border(t),t.reducedWidth=t.chart_width-t.chart_margin_left-t.chart_margin_right,t.reducedHeight=t.chart_height-t.chart_margin_top-t.chart_margin_bottom,"default"===t.mode?(t.k.title().backgroundColor(t)["export"](t,"#"+t.container_id,"waterfallChart").subtitle().makeMainDiv(t.selector,1),t.optionalFeatures(e).svgContainer(1,t.container_id).createGroups(),t.k.liveData(t).tooltip().createFooter().lastUpdatedAt().credits().dataSource(),t.mouseEvent=new PykCharts.Configuration.mouseEvent(t),t.optionalFeatures(e).axisContainer().createScales().ticks().createChart()):"infographics"===t.mode&&(t.k.backgroundColor(t)["export"](t,"#"+t.container_id,"waterfallChart").emptyDiv().makeMainDiv(t.selector,1),t.optionalFeatures(e).svgContainer(1,t.container_id).createGroups().axisContainer().createScales().ticks().createChart(),t.k.tooltip(),t.mouseEvent=new PykCharts.Configuration.mouseEvent(t)),t.k.yAxis(t.svgContainer,t.yGroup,t.yScale,t.yDomain,t.y_tick_values,void 0,void 0,t.tick_format_function).yAxisTitle(t.yGroup,void 0),t.xaxis(),t.optionalFeatures().axis_background(t.container_id),t.k.exportSVG(t,"#"+t.container_id,"waterfallChart");var a=t.k.resize(t.svgContainer);t.k.__proto__._ready(a),window.addEventListener("resize",function(e){return t.k.resize(t.svgContainer)})},r.optionalFeatures=function(t){var e=this,a={svgContainer:function(a,r){return document.getElementById(t).className+=" PykCharts-twoD",e.svgContainer=d3.select(e.selector+" #chart-container-"+a).append("svg:svg").attr("width",e.chart_width).attr("height",e.chart_height).attr("id",r).attr("class","svgcontainer").attr("preserveAspectRatio","xMinYMin").attr("viewBox","0 0 "+e.chart_width+" "+e.chart_height),e.background_rect=e.svgContainer.selectAll(".background-rect").data(["rect"]),e.background_rect.enter().append("rect").attr("class","background-rect"),e.background_rect.attr("y",e.chart_margin_top).attr("width",e.longest_tick_width).attr("height",e.reducedHeight).attr("fill",e.axis_y_background_color),this},createGroups:function(){return e.group=e.svgContainer.append("g").attr("id","chartsvg").attr("transform","translate("+e.chart_margin_left+","+e.chart_margin_top+")"),this},createScales:function(){e.y_values=[],e.x_values=[];for(var t=e.river_data.length,a=[],r=0;t>r;r++)a.push(e.river_data[r].y),e.y_values.push(e.river_data[r].unique_name),e.x_values.push(e.river_data[r].end);return e.y_values.reverse(),a.reverse(),e.tick_format_function=function(t){var e=t.lastIndexOf("-");return-1!=e?t.substring(0,e):t},e.yScale=d3.scale.ordinal().domain(e.y_values).rangeRoundBands([e.reducedHeight,0],.1),e.yDomain=a,e.data_length=e.data.length,e.bars=e.group.selectAll(".bar").data(e.river_data),e.bars.attr("transform",function(t){return"translate(5, "+e.yScale(t.unique_name)+")"}),e.bars.enter().append("g").attr("class",function(t){return"bar "+t.group}).attr("transform",function(t){return"translate(5, "+e.yScale(t.unique_name)+")"}),this},axisContainer:function(){return(PykCharts["boolean"](e.axis_y_enable)||e.axis_y_title)&&(e.yGroup=e.group.append("g").attr("id","yaxis").attr("class","y axis")),this},createChart:function(){e.y_tick_values=e.k.processYAxisTickValues(),e.xScale=d3.scale.linear().domain([0,d3.max(e.x_values,function(t){return t})]).range([0,e.reducedWidth-e.longest_tick_width-15]);var t=e.bars.selectAll(".rect").data(function(t){return[t]});t.enter().append("rect").attr("class","rect").attr("stroke",e.border.color()).attr("stroke-width",e.border.width()).attr("stroke-dasharray",e.border.style()).attr("stroke-opacity",1);var a=0;return t.attr("x",function(t){return e.xScale(t.start)+e.longest_tick_width+15}).attr("height",e.yScale.rangeBand()).attr("width",0).attr("fill",function(t,e){return t.color}).attr("fill-opacity",1).attr("data-id",function(t,e){return t.unique_name}).on("mouseover",function(t){if("default"===e.mode){if(PykCharts["boolean"](e.tooltip_enable)){var a=t.tooltip?t.tooltip:"<table><thead><th colspan='2'><b>"+t.y+"</b></th></thead><tr><td>Start</td><td><b>"+e.ticks_formatter(t.start)+"</b></td></tr><tr><td>Weight</td><td><b>"+e.ticks_formatter(t.x)+"</b></td></tr></table>";e.mouseEvent.tooltipPosition(t),e.mouseEvent.tooltipTextShow(a)}e.mouseEvent.axisHighlightShow(t.unique_name,e.selector+" .y.axis",e.y_values,"waterfall"),PykCharts["boolean"](e.chart_onhover_highlight_enable)&&e.mouseEvent.highlight(e.selector+" .rect",this)}}).on("mouseout",function(t){"default"===e.mode&&(PykCharts["boolean"](e.tooltip_enable)&&e.mouseEvent.tooltipHide(t),e.mouseEvent.axisHighlightHide(e.selector+" .y.axis"),PykCharts["boolean"](e.chart_onhover_highlight_enable)&&e.mouseEvent.highlightHide(e.selector+" .rect"))}).on("mousemove",function(t){"default"===e.mode&&PykCharts["boolean"](e.tooltip_enable)&&e.mouseEvent.tooltipPosition(t)}).on("click",function(t,a){PykCharts["boolean"](e.click_enable)&&e.addEvents(t.unique_name,d3.select(this).attr("data-id"))}).transition().duration(e.transitions.duration()).delay(function(t){return a++,a/e.data_length*e.transitions.duration()}).attr("x",function(t){return e.xScale("negative"==t.group?t.end:t.start)+e.longest_tick_width+15}).attr("width",function(t){return Math.abs(e.xScale(t.x))}),t.exit().remove(),e.bars.exit().remove(),this},ticks:function(){if(e.pointer_size){var t=e.bars.selectAll(".ticks-text").data(function(t){return[t]});t.enter().append("text").attr("class","ticks-text").style("font-weight",e.pointer_weight).style("font-size",e.pointer_size+"px").style("font-family",e.pointer_family).text(""),t.text(function(t){return e.ticks_formatter(t.x)}).style("visibility","hidden").attr("y",function(t){return e.yScale.rangeBand()/2+this.getBBox().height/3}).attr("dx",".25em").attr("fill",function(t){return e.longest_tick_width=e.longest_tick_width<this.getBBox().width?this.getBBox().width:e.longest_tick_width,"negative"==t.group?e.chart_color[0]:"positive"==t.group?e.chart_color[1]:void 0}).style("visibility","visible"),t.exit().remove()}return this},axis_background:function(t){if(PykCharts["boolean"](e.axis_y_enable)&&e.axis_y_pointer_size){for(var a=document.querySelectorAll("#"+t+" #yaxis .tick text"),r=a.length,n=[],o=0;r>o;o++)n.push(a[o].getBBox().width);var i=d3.max(n,function(t){return t});e.background_rect.attr("x",e.chart_margin_left-i-10).attr("width",i+10),e.background_rect.exit().remove()}return this}};return a},r.groupData=function(){for(r.group_arr=[],r.new_data=[],r.ticks=[],r.x_arr=[],j=0;j<r.data.length;j++)r.group_arr[j]=r.data[j].group;r.uniq_group_arr=r.k.__proto__._unique(r.group_arr);for(var t=r.uniq_group_arr.length,e=0;e<r.data.length;e++)r.x_arr[e]=+r.data[e].x;r.k.__proto__._unique(r.x_arr);r.flag=0;for(var e=0;t>e;e++){r.new_data[e]={name:r.uniq_group_arr[e],data:[]};for(var a=0;a<r.data.length;a++)r.uniq_group_arr[e]===r.data[a].group&&r.new_data[e].data.push({x:+r.data[a].x,y:r.data[a].y,tooltip:r.data[a].tooltip,name:r.data[a].group,unique_name:r.data[a].group?r.data[a].y+"-"+r.data[a].group:r.data[a].y})}r.new_data_length=r.new_data.length},r.dataTransformation=function(t){for(var e=0,a=0,n=t.data,o="Total",i=(n.length,0);i<r.data.length;i++)a+=r.data[i].x,e>a&&(e=a);return t.name&&(o=o+" "+t.name),e=0>e?Math.abs(e):0,n=r.rivergroup(e,n,o,e,t.name)},r.check_total_is_present=function(t){for(var e=!1,a=0;a<r.calculate_total_of.length;a++)if(t===r.calculate_total_of[a]){e=!0;break}return e},r.rivergroup=function(t,e,a,n,o){for(var i=0;i<e.length;i++)e[i].start=n,n+=e[i].x,e[i].end=n,e[i].group=e[i].x>0?"positive":"negative",e[i].color=e[i].x>0?r.chart_color[1]:r.chart_color[0],e[i].name=e[i].name,r.river_data.push(e[i]);return total_start=t,total_end=e[e.length-1].end,total_weight=total_end-total_start,totol_group=total_weight<0?"negative":"positive",r.river_data.push({y:a,x:total_weight,end:total_end,start:total_start,group:totol_group,color:r.chart_color[2],name:e[e.length-1].name,unique_name:o?a+"-"+o:a}),e},r.calculateRiverData=function(){r.river_data=[];for(var t,e=0;e<r.new_data_length;e++)if(0===e)r.dataTransformation(r.new_data[e]);else{var a=r.river_data.length;t=r.river_data[a-1];var n=r.check_total_is_present(t.name);PykCharts["boolean"](r.calculate_total)?!n&&r.calculate_total_of.length&&r.river_data.pop():r.river_data.pop(),name="Total "+r.new_data[e].name,r.rivergroup(r.river_data[0].start,r.new_data[e].data,name,t.end,r.new_data[e].name)}n=r.check_total_is_present(r.river_data[r.river_data.length-1].name),PykCharts["boolean"](r.calculate_total)?!n&&r.calculate_total_of.length&&r.river_data.pop():r.river_data.pop()},r.xaxis=function(){function t(t,e,a,n){r.group.append("line").attr("x1",t).attr("y1",a).attr("x2",e).attr("y2",n).attr("class","custom-axis").attr("stroke",r.axis_x_line_color).attr("stroke-width",1).style("shape-rendering","crispEdges")}var e=r.xScale.domain(),a=r.xScale(e[0])+r.longest_tick_width+15,n=r.xScale(e[1])+r.longest_tick_width+15,o=5,i=r.xScale(r.new_data[0].data[0].start)+r.longest_tick_width+15;if(PykCharts["boolean"](r.axis_x_enable)){t(a+o,n+o+1,r.reducedHeight,r.reducedHeight),t(a+o,a+o,r.reducedHeight,r.reducedHeight+r.axis_x_outer_pointer_length),t(n+o,n+o,r.reducedHeight,r.reducedHeight+r.axis_x_pointer_length),t(i+o,i+o,r.reducedHeight,r.reducedHeight+r.axis_x_pointer_length);var l=r.group.selectAll(".custom-axis-text").data([0]);l.enter().append("text"),l.attr("class","custom-axis-text").attr("x",i+o).attr("y",r.reducedHeight+r.axis_x_pointer_length).attr("dy",12).attr("text-anchor","middle").attr("fill",r.axis_x_pointer_color).style("font-family",r.axis_x_pointer_family).style("font-size",r.axis_x_pointer_size).style("font-weight",r.axis_x_pointer_weight).text("0"),l.exit().remove()}},r.sortData=function(){if("number"===r.axis_y_data_format||"time"===r.axis_y_data_format)for(var t=0;t<r.new_data_length;t++)r.new_data[t].data=r.k.__proto__._sortData(r.new_data[t].data,void 0,"y",r)}},PykCharts.maps={},PykCharts.maps.processInputs=function(t,e){var a=new PykCharts.Configuration.Theme({}),r=a.stylesheet,n=(a.functionality,a.mapsTheme);e.optional;if(t.timeline_duration="timeline_duration"in e?e.timeline_duration:n.timeline_duration,t.margin_left=e.timeline_margin_left?e.timeline_margin_left:n.timeline_margin_left,t.margin_right=e.timeline_margin_right?e.timeline_margin_right:n.timeline_margin_right,t.margin_top=e.timeline_margin_top?e.timeline_margin_top:n.timeline_margin_top,t.margin_bottom=e.timeline_margin_bottom?e.timeline_margin_bottom:n.timeline_margin_bottom,t.tooltip_position_top=e.tooltip_position_top?e.tooltip_position_top:n.tooltip_position_top,t.tooltip_position_left=e.tooltip_position_left?e.tooltip_position_left:n.tooltip_position_left,t.tooltipTopCorrection=d3.select(t.selector).style("top"),t.tooltipLeftCorrection=d3.select(t.selector).style("left"),
t.chart_color=e.chart_color?e.chart_color:[],t.saturation_color=e.saturation_color?e.saturation_color:"",t.palette_color=e.palette_color?e.palette_color:n.palette_color,t.label_enable=e.label_enable?e.label_enable.toLowerCase():n.label_enable,t.chart_onhover_effect=e.chart_onhover_effect?e.chart_onhover_effect.toLowerCase():n.chart_onhover_effect,t.default_zoom_level=e.default_zoom_level?e.default_zoom_level:80,t.k=new PykCharts.Configuration(t),t.total_no_of_colors=e.total_no_of_colors&&t.k.__proto__._isNumber(parseInt(e.total_no_of_colors,10))?parseInt(e.total_no_of_colors,10):n.total_no_of_colors,t.k.validator().validatingSelector(t.selector.substring(1,t.selector.length)).isArray(t.chart_color,"chart_color").validatingDataType(t.margin_left,"timeline_margin_left",n.timeline_margin_left,"margin_left").validatingDataType(t.margin_right,"timeline_margin_right",n.timeline_margin_right,"margin_right").validatingDataType(t.margin_top,"timeline_margin_top",n.timeline_margin_top,"margin_top").validatingDataType(t.margin_bottom,"timeline_margin_bottom",n.timeline_margin_bottom,"margin_bottom").validatingDataType(t.tooltip_position_top,"tooltip_position_top",n.tooltip_position_top).validatingDataType(t.tooltip_position_left,"tooltip_position_left",n.tooltip_position_left).validatingColor(t.highlight_color,"highlight_color",r.highlight_color).validatingColor(t.saturation_color,"saturation_color",r.saturation_color),t.chart_color.constructor===Array&&t.chart_color[0]&&t.k.validator().validatingColor(t.chart_color[0],"chart_color",r.chart_color),"saturation"===t.color_mode)try{if(t.total_no_of_colors<3||t.total_no_of_colors>9)throw t.total_no_of_colors=n.total_no_of_colors,"total_no_of_colors"}catch(o){t.k.warningHandling(o,"10")}try{if("shadow"!==t.chart_onhover_effect.toLowerCase()&&"none"!==t.chart_onhover_effect.toLowerCase()&&"highlight_border"!==t.chart_onhover_effect.toLowerCase()&&"color_saturation"!==t.chart_onhover_effect.toLowerCase())throw t.chart_onhover_effect=n.chart_onhover_effect,"chart_onhover_effect"}catch(o){t.k.warningHandling(o,"12")}try{if(!t.k.__proto__._isNumber(t.default_zoom_level))throw t.default_zoom_level=80,"default_zoom_level"}catch(o){t.k.warningHandling(o,"1")}return t.timeline_duration=1e3*t.timeline_duration,t},PykCharts.maps.oneLayer=function(t){var e=this;e.interval="";var a=new PykCharts.Configuration.Theme({});this.execute=function(r){e=new PykCharts.validation.processInputs(e,t,"maps"),e=PykCharts.maps.processInputs(e,t),e.executeData=function(r){var n=e.k.validator().validatingJSON(r),o=e.selector.substring(1,e.selector.length);return e.stop||n===!1?void e.k.remove_loading_bar(o):(e.k.storeInitialDivHeight(),e.data=r,e.data_length=e.data.length,e.compare_data=r,e.k.totalColors(e.total_no_of_colors).colorType(e.color_mode).loading(e.loading).tooltip(),d3.json(PykCharts.assets+"ref/"+e.map_code+"-topo.json",function(r,n){if(r&&404===r.status)return e.k.errorHandling("map_code","3"),void e.k.remove_loading_bar(o);e.map_data=n;for(var i=e.map_data.objects.geometries.length,l=0;i>l;l++){var s=e.map_data.objects.geometries[l].properties.NAME_1.replace("'","&#39;");e.map_data.objects.geometries[l].properties.NAME_1=s}d3.json(PykCharts.assets+"ref/colorPalette.json",function(r){e.color_palette_data=r;var n=e.k.__proto__._where(e.color_palette_data,{name:e.palette_color});try{if(!n.length)throw e.palette_color=a.mapsTheme.palette_color,"palette_color"}catch(o){e.k.warningHandling(o,"11")}d3.select(e.selector).html(""),d3.select(e.selector).style("height","auto");var i=new PykCharts.maps.mapFunctions(t,e,"oneLayer");i.render()})}),e.extent_size=d3.extent(e.data,function(t){return parseInt(t.size,10)}),void(e.difference=e.extent_size[1]-e.extent_size[0]))},PykCharts["boolean"](e.interactive_enable)?(e.k.dataFromPykQuery(r),e.k.dataSourceFormatIdentification(e.data,e,"executeData")):e.k.dataSourceFormatIdentification(t.data,e,"executeData")}},PykCharts.maps.timelineMap=function(t){var e=this,a=new PykCharts.Configuration.Theme({});this.execute=function(r){e=new PykCharts.validation.processInputs(e,t,"maps"),e=PykCharts.maps.processInputs(e,t),PykCharts.scaleFunction(e),e.executeData=function(r){var n=e.k.validator().validatingJSON(r),o=e.selector.substring(1,e.selector.length);if(e.stop||n===!1)return void e.k.remove_loading_bar(o);e.k.storeInitialDivHeight(),e.timeline_data=r,e.compare_data=r;var i=d3.extent(r,function(t){return t.timestamp});r.length;e.data=e.k.__proto__._where(r,{timestamp:i[0]}),e.data_length=e.data.length,e.redeced_width=e.chart_width-2*e.margin_left-e.margin_left,e.k.totalColors(e.total_no_of_colors).colorType(e.color_mode).loading(e.loading).tooltip(e.tooltip_enable),d3.json(PykCharts.assets+"ref/"+e.map_code+"-topo.json",function(r){e.map_data=r;for(var n=e.map_data.objects.geometries.length,o=0;n>o;o++){var i=e.map_data.objects.geometries[o].properties.NAME_1.replace("'","&#39;");e.map_data.objects.geometries[o].properties.NAME_1=i}d3.json(PykCharts.assets+"ref/colorPalette.json",function(r){e.color_palette_data=r;var n=e.k.__proto__._where(e.color_palette_data,{name:e.palette_color});try{if(!n.length)throw e.palette_color=a.mapsTheme.palette_color,"palette_color"}catch(o){e.k.warningHandling(o,"11")}var i=d3.extent(e.timeline_data,function(t){return t.timestamp});e.data=e.k.__proto__._where(e.timeline_data,{timestamp:i[0]}),e.data_length=e.data.length,e.data.sort(function(t,e){return t.timestamp-e.timestamp}),d3.select(e.selector).html("");var l=new PykCharts.maps.mapFunctions(t,e,"timeline");l.render()})}),e.extent_size=d3.extent(e.data,function(t){return parseInt(t.size,10)}),e.difference=e.extent_size[1]-e.extent_size[0]},PykCharts["boolean"](e.interactive_enable)?(e.k.dataFromPykQuery(r),e.k.dataSourceFormatIdentification(e.data,e,"executeData")):e.k.dataSourceFormatIdentification(t.data,e,"executeData")}},PykCharts.maps.mapFunctions=function(t,e,a){var r=e,n=r.selector.substring(1,r.selector.length),o=n+"_svg";this.render=function(){r.border=new PykCharts.Configuration.border(r),r.mouseEvent=new PykCharts.Configuration.mouseEvent(r),r.k.title().backgroundColor(r),"oneLayer"===a&&r.k["export"](r,"#"+o,a).emptyDiv().subtitle().exportSVG(r,"#"+o,a),r.current_palette=r.k.__proto__._where(r.color_palette_data,{name:r.palette_color,number:r.total_no_of_colors})[0],"timeline"===a&&r.k.subtitle(),r.optionalFeatures().svgContainer(o).legendsContainer(r.legends_enable).legends(r.legends_enable).createMap().label(r.label_enable),r.redeced_height=r.chart_height-r.margin_top-r.margin_bottom,r.k.createFooter().lastUpdatedAt().credits().dataSource(),"timeline"===a&&(r.optionalFeatures().axisContainer(!0),r.renderDataForTimescale(),r.backgroundColor(),r.renderButtons(),r.renderTimeline());var t=r.k.resize(r.svgContainer);r.k.__proto__._ready(t),window.addEventListener("resize",function(t){return r.k.resize(r.svgContainer)})},r.refresh=function(e){r.executeRefresh=function(t){r.data=t,r.data_length=r.data.length,r.refresh_data=t;var e=r.k.checkChangeInData(r.refresh_data,r.compare_data);r.compare_data=e[0];var a=e[1];a&&r.k.lastUpdatedAt("liveData"),r.extent_size=d3.extent(r.data,function(t){return parseInt(t.size,10)}),r.difference=r.extent_size[1]-r.extent_size[0],r.optionalFeatures().legends(r.legends_enable).createMap()},"oneLayer"===a&&(PykCharts["boolean"](r.interactive_enable)?(r.k.dataFromPykQuery(e),r.k.dataSourceFormatIdentification(r.data,r,"executeRefresh")):r.k.dataSourceFormatIdentification(t.data,r,"executeRefresh"))},r.optionalFeatures=function(){var t=r.selector.substring(1,r.selector.length),e={legends:function(t){return PykCharts["boolean"](t)&&r.renderLegend(),this},legendsContainer:function(t){return PykCharts["boolean"](t)&&"saturation"===r.color_mode?r.legendsContainer=r.svgContainer.append("g").attr("id","legend-container"):(r.legendsGroup_height=0,r.legendsGroup_width=0),this},label:function(t){return PykCharts["boolean"](t)&&r.renderLabel(),this},svgContainer:function(e){document.getElementById(t).style.width="100%",r.svgContainer=d3.select(r.selector).append("svg").attr({width:r.chart_width,height:r.chart_height,id:e,"class":"PykCharts-map",preserveAspectRatio:"xMinYMin",viewBox:"0 0 "+r.chart_width+" "+r.chart_height}),r.map_cont=r.svgContainer.append("g").attr("id","map_group");var a=r.map_cont.append("defs"),n=a.append("filter").attr("id","dropshadow");n.append("feGaussianBlur").attr({"in":"SourceAlpha",stdDeviation:1,result:"blur"}),n.append("feOffset").attr({"in":"blur",dx:1,dy:1,result:"offsetBlur"});var o=n.append("feMerge");return o.append("feMergeNode").attr('in", "offsetBlur'),o.append("feMergeNode").attr("in","SourceGraphic"),this},createMap:function(){var e=r.chart_width-r.legendsGroup_width,a=r.chart_height-r.legendsGroup_height-r.margin_bottom-r.margin_top-10,n=150,o=[e/2,a/2];if(document.getElementById(t).style.backgroundColor=r.background_color,r.group=r.map_cont.selectAll(".map_group").data(topojson.feature(r.map_data,r.map_data.objects).features),r.group.enter().append("g").attr("class","map_group").append("path"),"world"===r.map_code||"world_with_antarctica"===r.map_code)var i=[0,0];else var i=d3.geo.centroid(topojson.feature(r.map_data,r.map_data.objects));var l=d3.geo.mercator().center(i).scale(n).translate(o);r.path=d3.geo.path().projection(l);var s=r.path.bounds(topojson.feature(r.map_data,r.map_data.objects)),_=n*e/(s[1][0]-s[0][0]),c=n*a/(s[1][1]-s[0][1]),n=c>_?_:c,o=[e-(s[0][0]+s[1][0])/2,a-(s[0][1]+s[1][1])/2];l=d3.geo.mercator().center(i).scale(r.default_zoom_level/100*n).translate(o),r.path=r.path.projection(l);var d=d3.select("#pyk-tooltip");return r.chart_data=r.group.select("path").attr({d:r.path,"class":"area",iso2:function(t){return t.properties.iso_a2},area_name:function(t){return t.properties.NAME_1},fill:r.renderColor,prev_fill:function(t){return d3.select(this).attr("fill")},"fill-opacity":r.renderOpacity,"data-fill-opacity":function(){return d3.select(this).attr("fill-opacity")},"data-id":function(t,e){return t.properties.iso_a2}}).style({stroke:r.border.color(),"stroke-width":r.border.width(),"stroke-dasharray":r.border.style()}).on({mouseover:function(t){var e=r.k.__proto__._where(r.data,{iso2:t.properties.iso_a2})[0];if(e){if(PykCharts["boolean"](r.tooltip_enable)){var a=r.k.__proto__._where(r.data,{iso2:t.properties.iso_a2})[0].tooltip?r.k.__proto__._where(r.data,{iso2:t.properties.iso_a2})[0].tooltip:"<table><thead><th colspan='2'><b>"+t.properties.NAME_1+"</b></th></thead><tr><td>Size</td><td><b>"+r.k.__proto__._where(r.data,{iso2:t.properties.iso_a2})[0].size+"</b></td></tr></table>";d.style("display","block"),d.html(a),"moving"===r.tooltip_mode?d.style("top",function(){return PykCharts.getEvent().pageY-20+"px"}).style("left",function(){return PykCharts.getEvent().pageX+20+"px"}):"fixed"===r.tooltip_mode&&d.style("top",r.tooltip_position_top+"px").style("left",r.tooltip_position_left+"px")}"color_saturation"===r.onhover1&&PykCharts["boolean"](r.chart_onhover_highlight_enable)?r.mouseEvent.highlight(r.selector+" .area",this):r.bodColor(t)}},mouseout:function(t){PykCharts["boolean"](r.tooltip_enable)&&d.style("display","none"),r.bodUncolor(t),r.mouseEvent.highlightHide(r.selector+" .area")},click:function(t){PykCharts["boolean"](r.click_enable)&&r.addEvents(t.properties.iso_a2,d3.select(this).attr("data-id"))}}),r.group.exit().remove(),this},enableClick:function(t){return PykCharts["boolean"](t)?(r.chart_data.on("click",r.clicked),r.onhover1=r.chart_onhover_effect):r.onhover1=r.chart_onhover_effect,this},axisContainer:function(t){return PykCharts["boolean"](t)&&(r.gxaxis=r.svgContainer.append("g").attr({id:"xaxis","class":"x axis",transform:"translate("+2*r.margin_left+","+r.redeced_height+")"})),this}};return e},r.renderColor=function(t,e){if(!PykCharts["boolean"](t))return!1;var a,n=r.k.__proto__._where(r.data,{iso2:t.properties.iso_a2});if(n.length>0){if("color"===r.color_mode)return r.chart_color[0]?r.chart_color[0]:n.length>0&&PykCharts["boolean"](n[0].color)?n[0].color:r.default_color[0];if("saturation"===r.color_mode){if(r.highlight===r.map_data.objects.geometries[e].properties.iso_a2)return r.highlight_color;if(""!==r.saturation_color)return r.saturation_color;if(""!==r.palette_color)for(a=n[0].size,e=0;e<r.current_palette.colors.length;e++)if(a>=r.extent_size[0]+e*(r.difference/r.current_palette.colors.length)&&a<=r.extent_size[0]+(e+1)*(r.difference/r.current_palette.colors.length))return 1===r.data.length?r.current_palette.colors[r.current_palette.colors.length-1]:r.current_palette.colors[e]}return r.default_color[0]}return r.default_color[0]},r.renderOpacity=function(t){return""!==r.saturation_color&&"saturation"===r.color_mode?(r.oneninth=+d3.format(".2f")(r.difference/r.total_no_of_colors),r.opacity=(r.extent_size[0]+r.k.__proto__._where(r.data,{iso2:t.properties.iso_a2})[0].size+r.oneninth)/r.difference,r.opacity):1},r.renderLegend=function(){var t;if("saturation"===r.color_mode){if("vertical"===r.legends_display){var e=0,a=0;""===r.palette_color?(r.legendsContainer.attr("height",290),r.legendsGroup_height=0):(r.legendsContainer.attr("height",30*r.current_palette.number+20),r.legendsGroup_height=0),text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y",rect_parameter1value=13,rect_parameter2value=13,s=function(t,e){return 38},_=function(t,e){return 20};var n=function(t){return a++,24*a+12},o=function(t){return e++,24*e+23}}else if("horizontal"===r.legends_display){var i=0,l=0;""===r.palette_color?(i=9,l=9):(i=r.current_palette.number,l=r.current_palette.number,r.legendsContainer.attr("height",30*r.current_palette.number+20),r.legendsGroup_height=30*r.current_palette.number+20),r.legendsContainer.attr("height",50),r.legendsGroup_height=50,final_rect_x=0,final_text_x=0,legend_text_widths=[],temp_text=temp_rect=0,text_parameter1="x",text_parameter2="y",rect_parameter1="width",rect_parameter2="height",rect_parameter3="x",rect_parameter4="y";var s=function(t,e){return legend_text_widths[e]=this.getBBox().width,legend_start_x=16,final_text_x=0===e?legend_start_x:legend_start_x+temp_text,temp_text=temp_text+legend_text_widths[e]+30,final_text_x};o=30,rect_parameter1value=13,rect_parameter2value=13;var _=function(t,e){return final_rect_x=0===e?0:temp_rect,temp_rect=temp_rect+legend_text_widths[e]+30,final_rect_x};n=18}if(""!==r.saturation_color){for(var t,c=[],l=1;l<=r.total_no_of_colors;l++)c.push(l);t=d3.format(".1f")(r.extent_size[1]/r.total_no_of_colors),r.leg=function(e,a){return"<"+d3.round(t*(a+1))};var d=r.legendsContainer.selectAll(".rect").data(c);r.legends_text=r.legendsContainer.selectAll(".text").data(c),r.legends_text.enter().append("text"),r.legends_text.attr("class","text").attr("pointer-events","none").text(r.leg).attr({fill:r.legends_text_color,"font-family":r.legends_text_family,"font-size":r.legends_text_size,"font-weight":r.legends_text_weight,x:s,y:o}),d.enter().append("rect"),d.attr("class","rect").attr({x:_,y:n,width:rect_parameter1value,height:rect_parameter2value,fill:r.saturation_color,"fill-opacity":function(t,e){return(e+1)/r.total_no_of_colors}});var u,h=r.legendsContainer.node().getBBox().width;"vertical"===r.legends_display?r.legendsGroup_width=h+20:r.legendsGroup_width=0,u="vertical"===r.legends_display?r.chart_width-r.legendsGroup_width:r.chart_width-h-20,h<r.chart_width&&r.legendsContainer.attr("transform","translate("+(u-20)+",10)"),r.legendsContainer.style("visibility","visible"),r.legends_text.exit().remove(),d.exit().remove()}else{r.leg=function(t,e){return"<"+d3.round(r.extent_size[0]+(e+1)*(r.difference/r.current_palette.number))};var d=r.legendsContainer.selectAll(".rect").data(r.current_palette.colors);r.legends_text=r.legendsContainer.selectAll(".text").data(r.current_palette.colors),r.legends_text.enter().append("text"),r.legends_text.attr("class","text").attr("pointer-events","none").text(r.leg).attr({fill:r.legends_text_color,"font-family":r.legends_text_family,"font-size":r.legends_text_size,"font-weight":r.legends_text_weight,x:s,y:o}),d.enter().append("rect"),d.attr({"class":"rect",width:rect_parameter1value,height:rect_parameter2value,fill:function(t){return t},x:_,y:n});var u,h=r.legendsContainer.node().getBBox().width;"vertical"===r.legends_display?r.legendsGroup_width=h+20:r.legendsGroup_width=0,u="vertical"===r.legends_display?r.chart_width-r.legendsGroup_width:r.chart_width-h-20,h<r.chart_width&&r.legendsContainer.attr("transform","translate("+u+",10)"),r.legendsContainer.style("visibility","visible"),r.legends_text.exit().remove(),d.exit().remove()}}else{var p=document.getElementById("legend-container");p&&p.parentNode.removeChild(p)}},r.renderLabel=function(){r.group.append("text").attr({x:function(t){return r.path.centroid(t)[0]},y:function(t){return r.path.centroid(t)[1]},"text-anchor":"middle","font-size":"10px",fill:r.label_color,"pointer-events":"none"}).text(function(t){return t.properties.NAME_1.replace("&#39;","'")})},r.bodColor=function(t){var e=r.k.__proto__._where(r.data,{iso2:t.properties.iso_a2});PykCharts["boolean"](r.chart_onhover_highlight_enable)?"highlight_border"===r.onhover1?d3.select("path[area_name='"+t.properties.NAME_1+"']").style({stroke:r.border.color(),"stroke-width":parseFloat(r.border.width())+1.5+"px","stroke-dasharray":r.border.style()}):"shadow"===r.onhover1&&d3.select("path[area_name='"+t.properties.NAME_1+"']").attr({filter:"url(#dropshadow)","fill-opacity":function(){return""===r.palette_color&&"saturation"===r.color_mode?(r.oneninth_dim=+d3.format(".2f")(r.difference/r.total_no_of_colors),r.opacity_dim=(r.extent_size[0]+e[0].size+r.oneninth_dim)/r.difference,r.opacity_dim/2):.5}}):r.bodUncolor(t)},r.bodUncolor=function(t){d3.select("path[area_name='"+t.properties.NAME_1+"']").style({stroke:r.border.color(),"stroke-width":r.border.width(),"stroke-dasharray":r.border.style()}).attr({filter:null,"fill-opacity":function(){return""!==r.saturation_color&&"saturation"===r.color_mode?(r.oneninth_high=+d3.format(".2f")(r.difference/r.total_no_of_colors),r.opacity_high=(r.extent_size[0]+r.k.__proto__._where(r.data,{iso2:t.properties.iso_a2})[0].size+r.oneninth_high)/r.difference,r.opacity_high):1}})},this.clicked=function(t){var e={};e.container=PykCharts.getEvent().target.ownerSVGElement.parentNode.id,e.area=t.properties,e.data=r.k.__proto__._where(r.data,{iso2:t.properties.iso_a2})[0];try{customFunction(e)}catch(a){}},r.backgroundColor=function(){function t(n){return a=n,e=d3.select(n).style("background-color"),"transparent"!==e&&"rgba(0, 0, 0, 0)"!==e?r.k.__proto__._colourBrightness(e,d3.selectAll(n)[0]):void 0!==d3.select(n)[0][0].parentNode.tagName&&"body"!==d3.select(n)[0][0].parentNode.tagName.toLowerCase()?t(d3.select(n)[0][0].parentNode):void r.k.__proto__._colourBrightness("rgb(255,255,255)",d3.select(n)[0])}var e,a;t(r.selector),d3.select(a)[0][0].classList.contains("light")||"/overview"===window.location.pathname?(r.play_image_url=PykCharts.assets+"img/play.png",r.pause_image_url=PykCharts.assets+"img/pause.png",r.marker_image_url=PykCharts.assets+"img/marker.png"):(r.play_image_url=PykCharts.assets+"img/play-light.png",r.pause_image_url=PykCharts.assets+"img/pause-light.png",r.marker_image_url=PykCharts.assets+"img/marker-light.png")},r.renderDataForTimescale=function(){r.unique=[],x_extent=d3.extent(r.timeline_data,function(t){return t.timestamp}),x_range=[0,r.redeced_width],r.xScale=r.k.scaleIdentification("linear",x_extent,x_range);for(var t=r.timeline_data.length,e=0;t>e;e++)-1===r.unique.indexOf(r.timeline_data[e].timestamp)&&r.unique.push(r.timeline_data[e].timestamp);r.unique.sort(function(t,e){return t-e}),r.k.xAxis(r.svgContainer,r.gxaxis,r.xScale),r.gxaxis&&r.gxaxis.attr("transform","translate("+2*r.margin_left+","+r.redeced_height+")")},r.renderTimeline=function(){var t=interval1=r.interval_index=1;r.play.on("click",function(){e()}),r.timeline_status="";var e=function(){if("playing"===r.timeline_status)r.play.attr("xlink:href",r.play_image_url),r.timeline_status="paused",r.interval_index=t,clearInterval(r.play_interval);else{r.timeline_status="playing",r.play.attr("xlink:href",r.pause_image_url),t=r.interval_index;var e=function(){t===r.unique.length&&(t=0),r.marker.attr("x",2*r.margin_left+r.xScale(r.unique[t])-7),r.data=r.k.__proto__._where(r.timeline_data,{timestamp:r.unique[t]}),r.data_length=r.data.length,r.data.sort(function(t,e){return t.timestamp-e.timestamp}),r.extent_size=d3.extent(r.data,function(t){return parseInt(t.size,10)}),r.difference=r.extent_size[1]-r.extent_size[0];for(var e=0;e<r.data_length;e++)d3.select(r.selector+" path[iso2='"+r.data[e].iso2+"']").attr({fill:r.renderColor,"fill-opacity":r.renderOpacity,"data-fill-opacity":function(){return d3.select(this).attr("fill-opacity")}});t++};r.play_interval=setInterval(function(){e(),1===t&&(r.play.attr("xlink:href",r.play_image_url),r.interval_index=1,r.timeline_status="",clearInterval(r.play_interval))},r.timeline_duration),e()}}},r.renderButtons=function(){function t(t){if(document.getElementsByTagName("body")[0].style.cursor="pointer","playing"!==r.timeline_status){for(var e,a,n,o,i=PykCharts.getEvent().sourceEvent.pageX-r.margin_left,l=[],s=r.xScale.range(),_=r.unique.length,c=(s[1]-s[0])/_,d=0,u=0;_>u;u++)d+=c,l[u]=parseInt(d);for(var h=0;_>h;h++)if(i>=l[h]&&i<=l[h+1]){if(e=l[h],a=l[h+1],n=i-e,o=a-i,n>=o&&_-2>=h){r.marker.attr("x",2*r.margin_left+r.xScale(r.unique[h])-7),r.data=r.k.__proto__._where(r.timeline_data,{timestamp:r.unique[h]}),r.data_length=r.data.length,r.data.sort(function(t,e){return t.timestamp-e.timestamp}),r.extent_size=d3.extent(r.data,function(t){return parseInt(t.size,10)}),r.difference=r.extent_size[1]-r.extent_size[0];for(var p=0;p<r.data_length;p++)d3.select(r.selector+" path[iso2='"+r.data[p].iso2+"']").attr({fill:r.renderColor,"fill-opacity":r.renderOpacity,"data-fill-opacity":function(){return d3.select(this).attr("fill-opacity")}});r.interval_index=h}}else if(i>l[h]&&h>_-2){r.marker.attr("x",2*r.margin_left+r.xScale(r.unique[h])-7),r.data=r.k.__proto__._where(r.timeline_data,{timestamp:r.unique[h]}),r.data_length=r.data.length,r.data.sort(function(t,e){return t.timestamp-e.timestamp}),r.extent_size=d3.extent(r.data,function(t){return parseInt(t.size,10)}),r.difference=r.extent_size[1]-r.extent_size[0];for(var p=0;p<r.data_length;p++)d3.select(r.selector+" path[iso2='"+r.data[p].iso2+"']").attr({fill:r.renderColor,"fill-opacity":r.renderOpacity,"data-fill-opacity":function(){return d3.select(this).attr("fill-opacity")}});r.interval_index=h}}}var e=d3.select(r.selector+" .axis").node().getBBox();drag=d3.behavior.drag().origin(Object).on("drag",t).on("dragend",function(){document.getElementsByTagName("body")[0].style.cursor="default"}),r.play=r.svgContainer.append("image").attr({"xlink:href":r.play_image_url,x:r.margin_left/2,y:r.redeced_height-r.margin_top-e.height/2,width:"24px",height:"21px"}).style("cursor","pointer"),r.marker=r.svgContainer.append("image").attr({"xlink:href":r.marker_image_url,x:2*r.margin_left+r.xScale(r.unique[0])-7,y:r.redeced_height,width:"14px",height:"12px"}).style("cursor","pointer").call(drag)}};var anonymousFunc=function(){[PykCharts.assets+"lib/d3.min.js",PykCharts.assets+"lib/topojson.min.js",PykCharts.assets+"lib/custom-hive.min.js",PykCharts.assets+"lib/colors.min.js",PykCharts.assets+"lib/paper-full.min.js"]};window.onload=anonymousFunc;